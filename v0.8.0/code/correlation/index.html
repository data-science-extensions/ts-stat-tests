
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A Python library for performing statistical tests on time series data.">
      
      
        <meta name="author" content="[Chris Mahoney](mailto:chris@mahoneyconsultingservices.com)">
      
      
      
        <link rel="prev" href="../">
      
      
        <link rel="next" href="../regularity/">
      
      
        
      
      
      <link rel="icon" href="../../assets/icons/1205526.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Correlation - Time Series Statistical Tests</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../assets/css/style.css">
    
      <link rel="stylesheet" href="../../assets/css/admonitions.css">
    
      <link rel="stylesheet" href="../../assets/css/code_chunks.css">
    
      <link rel="stylesheet" href="../../assets/css/shortcodes.css">
    
      <link rel="stylesheet" href="../../assets/css/progress_bar.css">
    
      <link rel="stylesheet" href="../../assets/css/columns.css">
    
      <link rel="stylesheet" href="https://site-assets.fontawesome.com/releases/v6.4.2/css/all.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#test-the-correlation-of-a-given-time-series-dataset" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
          <aside class="md-banner md-banner--warning">
            <div class="md-banner__inner md-grid md-typeset">
              
  You're not viewing the latest version.
  <a href="../../..">
    <strong>Click here to go to latest.</strong>
  </a>

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),base=new URL("../.."),outdated=__md_get("__outdated",sessionStorage,base);!0===outdated&&el&&(el.hidden=!1)</script>
          </aside>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Time Series Statistical Tests" class="md-header__button md-logo" aria-label="Time Series Statistical Tests" data-md-component="logo">
      
  <img src="../../assets/icons/1205526.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Time Series Statistical Tests
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Correlation
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/data-science-extensions/ts-stat-tests" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg>
  </div>
  <div class="md-source__repository">
    ts-stat-tests
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../usage/overview/" class="md-tabs__link">
          
  
  
    
  
  Usage

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  
    
  
  Code

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="https://data-science-extensions.com/" class="md-tabs__link">
        
  
  
    
  
  Data Science Extensions

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Time Series Statistical Tests" class="md-nav__button md-logo" aria-label="Time Series Statistical Tests" data-md-component="logo">
      
  <img src="../../assets/icons/1205526.svg" alt="logo">

    </a>
    Time Series Statistical Tests
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/data-science-extensions/ts-stat-tests" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg>
  </div>
  <div class="md-source__repository">
    ts-stat-tests
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Usage
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Usage
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/contributing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Contributing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/changelog/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Change Log
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Code
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Code
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" checked>
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Modules
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Modules
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Correlation
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Correlation
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      
        Introduction
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#correlation-tests" class="md-nav__link">
    <span class="md-ellipsis">
      
        Correlation Tests
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Correlation Tests">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ts_stat_tests.tests.correlation" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;correlation
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Â correlation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ts_stat_tests.tests.correlation.correlation" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;correlation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ts_stat_tests.tests.correlation.is_correlated" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;is_correlated
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#correlation-algorithms" class="md-nav__link">
    <span class="md-ellipsis">
      
        Correlation Algorithms
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Correlation Algorithms">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ts_stat_tests.algorithms.correlation" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;correlation
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Â correlation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ts_stat_tests.algorithms.correlation.acf" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;acf
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ts_stat_tests.algorithms.correlation.pacf" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;pacf
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ts_stat_tests.algorithms.correlation.ccf" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;ccf
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ts_stat_tests.algorithms.correlation.lb" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;lb
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ts_stat_tests.algorithms.correlation.lm" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;lm
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ts_stat_tests.algorithms.correlation.bglm" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;bglm
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../regularity/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Regularity
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../normality/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Normality
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../stationarity/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Stationarity
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../seasonality/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Seasonality
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../stability/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Stability
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../linearity/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Linearity
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../heteroscedasticity/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Heteroscedasticity
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Utilities
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Utilities
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Data
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../errors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Errors
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://data-science-extensions.com/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Data Science Extensions
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      
        Introduction
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#correlation-tests" class="md-nav__link">
    <span class="md-ellipsis">
      
        Correlation Tests
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Correlation Tests">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ts_stat_tests.tests.correlation" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;correlation
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Â correlation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ts_stat_tests.tests.correlation.correlation" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;correlation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ts_stat_tests.tests.correlation.is_correlated" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;is_correlated
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#correlation-algorithms" class="md-nav__link">
    <span class="md-ellipsis">
      
        Correlation Algorithms
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Correlation Algorithms">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ts_stat_tests.algorithms.correlation" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;correlation
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Â correlation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ts_stat_tests.algorithms.correlation.acf" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;acf
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ts_stat_tests.algorithms.correlation.pacf" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;pacf
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ts_stat_tests.algorithms.correlation.ccf" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;ccf
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ts_stat_tests.algorithms.correlation.lb" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;lb
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ts_stat_tests.algorithms.correlation.lm" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;lm
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ts_stat_tests.algorithms.correlation.bglm" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;bglm
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/data-science-extensions/ts-stat-tests/edit/main/docs/code/correlation.md" title="Edit this page" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/data-science-extensions/ts-stat-tests/raw/main/docs/code/correlation.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


<h1 id="test-the-correlation-of-a-given-time-series-dataset">Test the <code>correlation</code> of a given Time-Series Dataset<a class="headerlink" href="#test-the-correlation-of-a-given-time-series-dataset" title="Permanent link">ðŸ”—</a></h1>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">ðŸ”—</a></h2>
<div class="admonition abstract">
<p class="admonition-title">Summary</p>
<div class="admonition quote">
<p class="admonition-title">As stated by <a href="https://www.influxdata.com/blog/author/anais">Anais Dotis-Georgiou</a>:</p>
<p>The term autocorrelation refers to the degree of similarity between A) a given time series, and B) a lagged version of itself, over C) successive time intervals. In other words, autocorrelation is intended to measure the relationship between a variable's present value and any past values that you may have access to.</p>
<p>Therefore, a time series autocorrelation attempts to measure the current values of a variable against the historical data of that variable. It ultimately plots one series over the other, and determines the degree of similarity between the two.</p>
<p>For the sake of comparison, autocorrelation is essentially the exact same process that you would go through when calculating the correlation between two different sets of time series values on your own. The major difference here is that autocorrelation uses the same time series two times: once in its original values, and then again once a few different time periods have occurred.</p>
<p>Autocorrelation is also known as serial correlation, time series correlation and lagged correlation. Regardless of how it's being used, autocorrelation is an ideal method for uncovering trends and patterns in time series data that would have otherwise gone undiscovered.</p>
<hr />
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 15V9h8V4.16L19.84 12 12 19.84V15z"/></svg></span> For more info, see: <a href="https://www.influxdata.com/blog/autocorrelation-in-time-series-data/">InfluxData: Autocorrelation in Time Series Data</a>.</p>
</div>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>An important test to do on Time-Series data is to measure it's level of Auto-Correlation (McMurry &amp; Politis, 2010; Hyndman, nd.(b)). While 'correlation' refers to how two variables change based on the other's value, 'auto-correlation' is how a variable changes based on it's own value over time (the phrase "auto" refers to "self"). For the Auto-Correlation Function, it uses a '<code>lag</code>' function. For example, a lag value of <code>0</code> is 100% correlated, which is logical, because that is it's own value; whereas a lag value of <code>1</code> or greater, the level of auto-correlation decreases as it gets further away from <code>lag0</code>.</p>
<p>For well-structured time-series data sets, it would be expected to see a conical-shaped Auto-Correlation plot. If it were not a well-structured time-series data set, then this Auto-Correlation plot would look more like white noise, and there would not be any logical shape. The blue dotted lines are included as a reference point for determining if any of the observations are significantly different from zero.</p>
<p>Moreover, analysis of the data's Auto-Correlation (ACF) should be combined with analysis of its Partial Auto-Correlation (PACF). While the ACF is the "direct" relationship between an observation and it's relevant lag observation, the PACF removes the "indirect" relationship between these observations. Effectively, the Partial Auto-Correlation between <code>lag1</code> and <code>lag5</code> is the "actual" correlation between these two observations, after removing the influence that <code>lag2</code>, <code>lag3</code>, and <code>lag4</code> has on <code>lag5</code>.</p>
<p>What this means is that the Partial Auto-Correlation plot would have a very high value at <code>lag0</code>, which will drop very quickly at <code>lag1</code>, and should remain below the blue reference lines for the remainder of the Correlogram. The observations of <code>lag&gt;0</code> should resemble white noise data points. If it does not resemble white noise, and there is a distinct pattern occurring, then the data is not suitable for time-series forecasting.</p>
<table>
<thead>
<tr>
<th>library</th>
<th>category</th>
<th>algorithm</th>
<th>short</th>
<th>import script</th>
<th>url</th>
</tr>
</thead>
<tbody>
<tr>
<td>statsmodels</td>
<td>Correlation</td>
<td>Autocorrelation Function</td>
<td>ACF</td>
<td><code>from statsmodels.tsa.stattools import acf</code></td>
<td><a href="https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.acf.html">https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.acf.html</a></td>
</tr>
<tr>
<td></td>
<td>Correlation</td>
<td>Partial Autocorrelation Function</td>
<td>PACF</td>
<td><code>from statsmodels.tsa.stattools import pacf</code></td>
<td><a href="https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.pacf.html">https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.pacf.html</a></td>
</tr>
<tr>
<td></td>
<td>Correlation</td>
<td>Cross-Correlation Function</td>
<td>CCF</td>
<td><code>from statsmodels.tsa.stattools import ccf</code></td>
<td><a href="https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.ccf.html">https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.ccf.html</a></td>
</tr>
<tr>
<td></td>
<td>Correlation</td>
<td>Ljung-Box Test</td>
<td>LB</td>
<td><code>from statsmodels.stats.diagnostic import acorr_ljungbox</code></td>
<td><a href="https://www.statsmodels.org/stable/generated/statsmodels.stats.diagnostic.acorr_ljungbox.html">https://www.statsmodels.org/stable/generated/statsmodels.stats.diagnostic.acorr_ljungbox.html</a></td>
</tr>
<tr>
<td></td>
<td>Correlation</td>
<td>Lagrange Multiplier Test</td>
<td>LM</td>
<td><code>from statsmodels.stats.diagnostic import acorr_lm</code></td>
<td><a href="https://www.statsmodels.org/stable/generated/statsmodels.stats.diagnostic.acorr_lm.html">https://www.statsmodels.org/stable/generated/statsmodels.stats.diagnostic.acorr_lm.html</a></td>
</tr>
<tr>
<td></td>
<td>Correlation</td>
<td>Breusch-Godfrey LM Test</td>
<td>BGLM</td>
<td><code>from statsmodels.stats.diagnostic import acorr_breusch_godfrey</code></td>
<td><a href="https://www.statsmodels.org/stable/generated/statsmodels.stats.diagnostic.acorr_breusch_godfrey.html">https://www.statsmodels.org/stable/generated/statsmodels.stats.diagnostic.acorr_breusch_godfrey.html</a></td>
</tr>
</tbody>
</table>
<hr />
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 15V9h8V4.16L19.84 12 12 19.84V15z"/></svg></span> For more info, see: <a href="https://www.statsmodels.org/stable/stats.html#diagnostic-tests">Statsmodels Diagnostic</a>.</p>
</div>
<div class="admonition question">
<p class="admonition-title">Source Library</p>
<p>The <code>statsmodels</code> package was chosen because it provides mature, well-tested implementations of core time-series tools (such as ACF, PACF, and correlograms), integrates seamlessly with <code>numpy</code> and <code>pandas</code> data structures, and offers a comprehensive suite of statistical tests that align closely with the methods demonstrated in this project.</p>
</div>
<div class="admonition example">
<p class="admonition-title">Source Module</p>
<p>All of the source code can be found within these modules:</p>
<ul>
<li><a class="autorefs autorefs-internal" title="            ts_stat_tests.algorithms.correlation" href="#ts_stat_tests.algorithms.correlation"><code>ts_stat_tests.algorithms.correlation</code></a>.</li>
<li><a class="autorefs autorefs-internal" title="            ts_stat_tests.tests.correlation" href="#ts_stat_tests.tests.correlation"><code>ts_stat_tests.tests.correlation</code></a>.</li>
</ul>
</div>
</div>
<h2 id="correlation-tests">Correlation Tests<a class="headerlink" href="#correlation-tests" title="Permanent link">ðŸ”—</a></h2>


<div class="doc doc-object doc-module">



<h3 id="ts_stat_tests.tests.correlation" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">ts_stat_tests.tests.correlation</span>


<a href="#ts_stat_tests.tests.correlation" class="headerlink" title="Permanent link">ðŸ”—</a></h3>

    <div class="doc doc-contents first">

        <div class="admonition note">
<p class="admonition-title">Summary</p>
<p>This module contains tests for the correlation functions defined in the <code>ts_stat_tests.algorithms.correlation</code> module.</p>
</div>










  <div class="doc doc-children">



















































































<div class="doc doc-object doc-function">


<h4 id="ts_stat_tests.tests.correlation.correlation" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">correlation</span>


<a href="#ts_stat_tests.tests.correlation.correlation" class="headerlink" title="Permanent link">ðŸ”—</a></h4>
          <div class="doc-overloads">
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">correlation</span><span class="p">(</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
    <span class="n">algorithm</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;acf&quot;</span><span class="p">,</span> <span class="s2">&quot;auto&quot;</span><span class="p">,</span> <span class="s2">&quot;ac&quot;</span><span class="p">],</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span>
    <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span> <span class="o">...</span><span class="p">]</span>
<span class="p">]</span>
</code></pre></div><div class="doc-signature highlight"><pre><span></span><code><span class="nf">correlation</span><span class="p">(</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">ArrayLike1D</span><span class="p">,</span>
    <span class="n">algorithm</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;pacf&quot;</span><span class="p">,</span> <span class="s2">&quot;partial&quot;</span><span class="p">,</span> <span class="s2">&quot;pc&quot;</span><span class="p">],</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span>
    <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span> <span class="o">...</span><span class="p">]</span>
<span class="p">]</span>
</code></pre></div><div class="doc-signature highlight"><pre><span></span><code><span class="nf">correlation</span><span class="p">(</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
    <span class="n">algorithm</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span>
        <span class="s2">&quot;ccf&quot;</span><span class="p">,</span> <span class="s2">&quot;cross&quot;</span><span class="p">,</span> <span class="s2">&quot;cross-correlation&quot;</span><span class="p">,</span> <span class="s2">&quot;cc&quot;</span>
    <span class="p">],</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span>
    <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span> <span class="o">...</span><span class="p">]</span>
<span class="p">]</span>
</code></pre></div><div class="doc-signature highlight"><pre><span></span><code><span class="nf">correlation</span><span class="p">(</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
    <span class="n">algorithm</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span>
        <span class="s2">&quot;lb&quot;</span><span class="p">,</span>
        <span class="s2">&quot;alb&quot;</span><span class="p">,</span>
        <span class="s2">&quot;acorr_ljungbox&quot;</span><span class="p">,</span>
        <span class="s2">&quot;acor_lb&quot;</span><span class="p">,</span>
        <span class="s2">&quot;a_lb&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ljungbox&quot;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span>
</code></pre></div><div class="doc-signature highlight"><pre><span></span><code><span class="nf">correlation</span><span class="p">(</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
    <span class="n">algorithm</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;lm&quot;</span><span class="p">,</span> <span class="s2">&quot;alm&quot;</span><span class="p">,</span> <span class="s2">&quot;acorr_lm&quot;</span><span class="p">,</span> <span class="s2">&quot;a_lm&quot;</span><span class="p">],</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span>
    <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
    <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="n">ResultsStore</span><span class="p">],</span>
<span class="p">]</span>
</code></pre></div><div class="doc-signature highlight"><pre><span></span><code><span class="nf">correlation</span><span class="p">(</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">RegressionResults</span><span class="p">,</span> <span class="n">RegressionResultsWrapper</span><span class="p">],</span>
    <span class="n">algorithm</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;bglm&quot;</span><span class="p">,</span> <span class="s2">&quot;breusch_godfrey&quot;</span><span class="p">,</span> <span class="s2">&quot;bg&quot;</span><span class="p">],</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span>
    <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
    <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="n">ResultsStore</span><span class="p">],</span>
<span class="p">]</span>
</code></pre></div>          </div>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">correlation</span><span class="p">(</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span>
        <span class="n">ArrayLike</span><span class="p">,</span>
        <span class="n">ArrayLike1D</span><span class="p">,</span>
        <span class="n">RegressionResults</span><span class="p">,</span>
        <span class="n">RegressionResultsWrapper</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="n">algorithm</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;acf&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span>
    <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span>
    <span class="nb">tuple</span><span class="p">[</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span> <span class="o">...</span><span class="p">],</span>
    <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
    <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="n">ResultsStore</span><span class="p">],</span>
<span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <div class="admonition note">
<p class="admonition-title">Summary</p>
<p>A unified interface for various correlation tests.</p>
</div>
<details class="abstract" open="open">
<summary>Details</summary>
<p>This function acts as a dispatcher for several correlation measures and tests, allowing users to access them through a single, consistent API. Depending on the <code>algorithm</code> parameter, it routes the call to the appropriate implementation in <code>ts_stat_tests.algorithms.correlation</code>.</p>
<p>The supported algorithms include:</p>
<ul>
<li><strong>Autocorrelation Function (ACF)</strong>: Measures the correlation of a signal with a delayed copy of itself.</li>
<li><strong>Partial Autocorrelation Function (PACF)</strong>: Measures the correlation between a signal and its lagged values after removing the effects of intermediate lags.</li>
<li><strong>Cross-Correlation Function (CCF)</strong>: Measures the correlation between two signals at different lags.</li>
<li><strong>Ljung-Box Test</strong>: Tests for the presence of autocorrelation in the residuals of a model.</li>
<li><strong>Lagrange Multiplier (LM) Test</strong>: A generic test for autocorrelation, often used for ARCH effects.</li>
<li><strong>Breusch-Godfrey Test</strong>: A more general version of the LM test for serial correlation in residuals.</li>
</ul>
</details>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="numpy.typing.ArrayLike">ArrayLike</span>, <span title="statsmodels.tsa.stattools.ArrayLike1D">ArrayLike1D</span>, <span title="statsmodels.regression.linear_model.RegressionResults">RegressionResults</span>, <span title="statsmodels.regression.linear_model.RegressionResultsWrapper">RegressionResultsWrapper</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input time series data or regression results.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>algorithm</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The correlation algorithm to use. Options include:
- "acf", "auto", "ac": Autocorrelation Function
- "pacf", "partial", "pc": Partial Autocorrelation Function
- "ccf", "cross", "cross-correlation", "cc": Cross-Correlation Function
- "lb", "alb", "acorr_ljungbox", "acor_lb", "a_lb", "ljungbox": Ljung-Box Test
- "lm", "alm", "acorr_lm", "a_lm": Lagrange Multiplier Test
- "bglm", "breusch_godfrey", "bg": Breusch-Godfrey Test</p>
              </div>
            </td>
            <td>
                  <code>&#39;acf&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>kwargs</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="float">float</span>, <span title="int">int</span>, <span title="str">str</span>, <span title="bool">bool</span>, <span title="numpy.typing.ArrayLike">ArrayLike</span>, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional keyword arguments specific to the chosen algorithm.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If an unsupported algorithm is specified.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>], <span title="tuple">tuple</span>[<span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>], ...], <span title="pandas.DataFrame">DataFrame</span>, <span title="tuple">tuple</span>[<span title="float">float</span>, <span title="float">float</span>, <span title="float">float</span>, <span title="float">float</span>], <span title="tuple">tuple</span>[<span title="float">float</span>, <span title="float">float</span>, <span title="float">float</span>, <span title="float">float</span>, <span title="statsmodels.stats.diagnostic.ResultsStore">ResultsStore</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Returns the result of the specified correlation test.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <details class="example" open="open">
<summary>Examples</summary>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Setup</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ts_stat_tests.tests.correlation</span><span class="w"> </span><span class="kn">import</span> <span class="n">correlation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ts_stat_tests.utils.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">data_normal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">normal</span> <span class="o">=</span> <span class="n">data_normal</span>
</code></pre></div></td></tr></table></div>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 1: Autocorrelation (ACF)</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">correlation</span><span class="p">(</span><span class="n">normal</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;acf&quot;</span><span class="p">,</span> <span class="n">nlags</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Lag 1 ACF: </span><span class="si">{</span><span class="n">res</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">Lag 1 ACF: 0.0236</span>
</code></pre></div></td></tr></table></div>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 2: Ljung-Box test</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">correlation</span><span class="p">(</span><span class="n">normal</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;lb&quot;</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<span class="go">    lb_stat  lb_pvalue</span>
<span class="go">5  7.882362   0.162839</span>
</code></pre></div></td></tr></table></div>
</details>
<details class="tip">
<summary>See Also</summary>
<ul>
<li><a class="autorefs autorefs-internal" title="            acf" href="#ts_stat_tests.algorithms.correlation.acf"><code>ts_stat_tests.algorithms.correlation.acf</code></a>: Autocorrelation Function algorithm.</li>
<li><a class="autorefs autorefs-internal" title="            pacf" href="#ts_stat_tests.algorithms.correlation.pacf"><code>ts_stat_tests.algorithms.correlation.pacf</code></a>: Partial Autocorrelation Function algorithm.</li>
<li><a class="autorefs autorefs-internal" title="            ccf" href="#ts_stat_tests.algorithms.correlation.ccf"><code>ts_stat_tests.algorithms.correlation.ccf</code></a>: Cross-Correlation Function algorithm.</li>
<li><a class="autorefs autorefs-internal" title="            lb" href="#ts_stat_tests.algorithms.correlation.lb"><code>ts_stat_tests.algorithms.correlation.lb</code></a>: Ljung-Box Test algorithm.</li>
<li><a class="autorefs autorefs-internal" title="            lm" href="#ts_stat_tests.algorithms.correlation.lm"><code>ts_stat_tests.algorithms.correlation.lm</code></a>: Lagrange Multiplier Test algorithm.</li>
<li><a class="autorefs autorefs-internal" title="            bglm" href="#ts_stat_tests.algorithms.correlation.bglm"><code>ts_stat_tests.algorithms.correlation.bglm</code></a>: Breusch-Godfrey Test algorithm.</li>
</ul>
</details>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/ts_stat_tests/tests/correlation.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@typechecked</span>
<span class="k">def</span><span class="w"> </span><span class="nf">correlation</span><span class="p">(</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ArrayLike</span><span class="p">,</span> <span class="n">ArrayLike1D</span><span class="p">,</span> <span class="n">RegressionResults</span><span class="p">,</span> <span class="n">RegressionResultsWrapper</span><span class="p">],</span>
    <span class="n">algorithm</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;acf&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span>
    <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span>
    <span class="nb">tuple</span><span class="p">[</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span> <span class="o">...</span><span class="p">],</span>
    <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
    <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="n">ResultsStore</span><span class="p">],</span>
<span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    !!! note &quot;Summary&quot;</span>
<span class="sd">        A unified interface for various correlation tests.</span>

<span class="sd">    ???+ abstract &quot;Details&quot;</span>
<span class="sd">        This function acts as a dispatcher for several correlation measures and tests, allowing users to access them through a single, consistent API. Depending on the `algorithm` parameter, it routes the call to the appropriate implementation in `ts_stat_tests.algorithms.correlation`.</span>

<span class="sd">        The supported algorithms include:</span>

<span class="sd">        - **Autocorrelation Function (ACF)**: Measures the correlation of a signal with a delayed copy of itself.</span>
<span class="sd">        - **Partial Autocorrelation Function (PACF)**: Measures the correlation between a signal and its lagged values after removing the effects of intermediate lags.</span>
<span class="sd">        - **Cross-Correlation Function (CCF)**: Measures the correlation between two signals at different lags.</span>
<span class="sd">        - **Ljung-Box Test**: Tests for the presence of autocorrelation in the residuals of a model.</span>
<span class="sd">        - **Lagrange Multiplier (LM) Test**: A generic test for autocorrelation, often used for ARCH effects.</span>
<span class="sd">        - **Breusch-Godfrey Test**: A more general version of the LM test for serial correlation in residuals.</span>

<span class="sd">    Params:</span>
<span class="sd">        x (Union[ArrayLike, ArrayLike1D, RegressionResults, RegressionResultsWrapper]):</span>
<span class="sd">            The input time series data or regression results.</span>
<span class="sd">        algorithm (str):</span>
<span class="sd">            The correlation algorithm to use. Options include:</span>
<span class="sd">            - &quot;acf&quot;, &quot;auto&quot;, &quot;ac&quot;: Autocorrelation Function</span>
<span class="sd">            - &quot;pacf&quot;, &quot;partial&quot;, &quot;pc&quot;: Partial Autocorrelation Function</span>
<span class="sd">            - &quot;ccf&quot;, &quot;cross&quot;, &quot;cross-correlation&quot;, &quot;cc&quot;: Cross-Correlation Function</span>
<span class="sd">            - &quot;lb&quot;, &quot;alb&quot;, &quot;acorr_ljungbox&quot;, &quot;acor_lb&quot;, &quot;a_lb&quot;, &quot;ljungbox&quot;: Ljung-Box Test</span>
<span class="sd">            - &quot;lm&quot;, &quot;alm&quot;, &quot;acorr_lm&quot;, &quot;a_lm&quot;: Lagrange Multiplier Test</span>
<span class="sd">            - &quot;bglm&quot;, &quot;breusch_godfrey&quot;, &quot;bg&quot;: Breusch-Godfrey Test</span>
<span class="sd">        kwargs (Union[float, int, str, bool, ArrayLike, None]):</span>
<span class="sd">            Additional keyword arguments specific to the chosen algorithm.</span>

<span class="sd">    Raises:</span>
<span class="sd">        (ValueError):</span>
<span class="sd">            If an unsupported algorithm is specified.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (Union[NDArray[np.float64], tuple[NDArray[np.float64], ...], pd.DataFrame, tuple[float, float, float, float], tuple[float, float, float, float, ResultsStore]]):</span>
<span class="sd">            Returns the result of the specified correlation test.</span>

<span class="sd">    ???+ example &quot;Examples&quot;</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Setup&quot;}</span>
<span class="sd">        &gt;&gt;&gt; from ts_stat_tests.tests.correlation import correlation</span>
<span class="sd">        &gt;&gt;&gt; from ts_stat_tests.utils.data import data_normal</span>
<span class="sd">        &gt;&gt;&gt; normal = data_normal</span>

<span class="sd">        ```</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Example 1: Autocorrelation (ACF)&quot;}</span>
<span class="sd">        &gt;&gt;&gt; res = correlation(normal, algorithm=&quot;acf&quot;, nlags=10)</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;Lag 1 ACF: {res[1]:.4f}&quot;)</span>
<span class="sd">        Lag 1 ACF: 0.0236</span>

<span class="sd">        ```</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Example 2: Ljung-Box test&quot;}</span>
<span class="sd">        &gt;&gt;&gt; res = correlation(normal, algorithm=&quot;lb&quot;, lags=[5])</span>
<span class="sd">        &gt;&gt;&gt; print(res)</span>
<span class="sd">            lb_stat  lb_pvalue</span>
<span class="sd">        5  7.882362   0.162839</span>

<span class="sd">        ```</span>

<span class="sd">    ??? tip &quot;See Also&quot;</span>
<span class="sd">        - [`ts_stat_tests.algorithms.correlation.acf`][ts_stat_tests.algorithms.correlation.acf]: Autocorrelation Function algorithm.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.correlation.pacf`][ts_stat_tests.algorithms.correlation.pacf]: Partial Autocorrelation Function algorithm.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.correlation.ccf`][ts_stat_tests.algorithms.correlation.ccf]: Cross-Correlation Function algorithm.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.correlation.lb`][ts_stat_tests.algorithms.correlation.lb]: Ljung-Box Test algorithm.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.correlation.lm`][ts_stat_tests.algorithms.correlation.lm]: Lagrange Multiplier Test algorithm.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.correlation.bglm`][ts_stat_tests.algorithms.correlation.bglm]: Breusch-Godfrey Test algorithm.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">options</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;acf&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;acf&quot;</span><span class="p">,</span> <span class="s2">&quot;auto&quot;</span><span class="p">,</span> <span class="s2">&quot;ac&quot;</span><span class="p">),</span>
        <span class="s2">&quot;pacf&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;pacf&quot;</span><span class="p">,</span> <span class="s2">&quot;partial&quot;</span><span class="p">,</span> <span class="s2">&quot;pc&quot;</span><span class="p">),</span>
        <span class="s2">&quot;ccf&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;ccf&quot;</span><span class="p">,</span> <span class="s2">&quot;cross&quot;</span><span class="p">,</span> <span class="s2">&quot;cross-correlation&quot;</span><span class="p">,</span> <span class="s2">&quot;cc&quot;</span><span class="p">),</span>
        <span class="s2">&quot;lb&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;alb&quot;</span><span class="p">,</span> <span class="s2">&quot;acorr_ljungbox&quot;</span><span class="p">,</span> <span class="s2">&quot;acor_lb&quot;</span><span class="p">,</span> <span class="s2">&quot;a_lb&quot;</span><span class="p">,</span> <span class="s2">&quot;lb&quot;</span><span class="p">,</span> <span class="s2">&quot;ljungbox&quot;</span><span class="p">),</span>
        <span class="s2">&quot;lm&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;alm&quot;</span><span class="p">,</span> <span class="s2">&quot;acorr_lm&quot;</span><span class="p">,</span> <span class="s2">&quot;a_lm&quot;</span><span class="p">,</span> <span class="s2">&quot;lm&quot;</span><span class="p">),</span>
        <span class="s2">&quot;bglm&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;bglm&quot;</span><span class="p">,</span> <span class="s2">&quot;breusch_godfrey&quot;</span><span class="p">,</span> <span class="s2">&quot;bg&quot;</span><span class="p">),</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="n">algorithm</span> <span class="ow">in</span> <span class="n">options</span><span class="p">[</span><span class="s2">&quot;acf&quot;</span><span class="p">]:</span>
        <span class="k">return</span> <span class="n">_acf</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

    <span class="k">if</span> <span class="n">algorithm</span> <span class="ow">in</span> <span class="n">options</span><span class="p">[</span><span class="s2">&quot;pacf&quot;</span><span class="p">]:</span>
        <span class="k">return</span> <span class="n">_pacf</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

    <span class="k">if</span> <span class="n">algorithm</span> <span class="ow">in</span> <span class="n">options</span><span class="p">[</span><span class="s2">&quot;lb&quot;</span><span class="p">]:</span>
        <span class="k">return</span> <span class="n">_lb</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

    <span class="k">if</span> <span class="n">algorithm</span> <span class="ow">in</span> <span class="n">options</span><span class="p">[</span><span class="s2">&quot;lm&quot;</span><span class="p">]:</span>
        <span class="k">return</span> <span class="n">_lm</span><span class="p">(</span><span class="n">resid</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

    <span class="k">if</span> <span class="n">algorithm</span> <span class="ow">in</span> <span class="n">options</span><span class="p">[</span><span class="s2">&quot;ccf&quot;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="s2">&quot;y&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">or</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The &#39;ccf&#39; algorithm requires a &#39;y&#39; parameter.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">_ccf</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

    <span class="k">if</span> <span class="n">algorithm</span> <span class="ow">in</span> <span class="n">options</span><span class="p">[</span><span class="s2">&quot;bglm&quot;</span><span class="p">]:</span>
        <span class="k">return</span> <span class="n">_bglm</span><span class="p">(</span><span class="n">res</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
        <span class="n">generate_error_message</span><span class="p">(</span>
            <span class="n">parameter_name</span><span class="o">=</span><span class="s2">&quot;algorithm&quot;</span><span class="p">,</span>
            <span class="n">value_parsed</span><span class="o">=</span><span class="n">algorithm</span><span class="p">,</span>
            <span class="n">options</span><span class="o">=</span><span class="n">options</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="ts_stat_tests.tests.correlation.is_correlated" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">is_correlated</span>


<a href="#ts_stat_tests.tests.correlation.is_correlated" class="headerlink" title="Permanent link">ðŸ”—</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">is_correlated</span><span class="p">(</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span>
        <span class="n">ArrayLike</span><span class="p">,</span>
        <span class="n">ArrayLike1D</span><span class="p">,</span>
        <span class="n">RegressionResults</span><span class="p">,</span>
        <span class="n">RegressionResultsWrapper</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="n">algorithm</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;lb&quot;</span><span class="p">,</span>
    <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="kc">None</span><span class="p">]]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <div class="admonition note">
<p class="admonition-title">Summary</p>
<p>Test whether a given data set is <code>correlated</code> or not.</p>
</div>
<details class="abstract" open="open">
<summary>Details</summary>
<p>This function checks for autocorrelation in the given data using various tests. By default, it uses the Ljung-Box test.</p>
<ul>
<li><strong>Ljung-Box (<code>lb</code>)</strong>: Tests the null hypothesis that the data are independently distributed (i.e. no autocorrelation). If the p-value is less than <code>alpha</code>, the null hypothesis is rejected, and the series is considered <code>correlated</code>. If multiple lags are provided, it checks if any of the p-values are below <code>alpha</code>.</li>
<li><strong>LM Test (<code>lm</code>)</strong>: Tests for serial correlation. If the LMP-value is less than <code>alpha</code>, it is considered <code>correlated</code>.</li>
<li><strong>Breusch-Godfrey (<code>bglm</code>)</strong>: Tests for serial correlation in residuals. If the LMP-value is less than <code>alpha</code>, it is considered <code>correlated</code>.</li>
</ul>
</details>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="numpy.typing.ArrayLike">ArrayLike</span>, <span title="statsmodels.tsa.stattools.ArrayLike1D">ArrayLike1D</span>, <span title="statsmodels.regression.linear_model.RegressionResults">RegressionResults</span>, <span title="statsmodels.regression.linear_model.RegressionResultsWrapper">RegressionResultsWrapper</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input time series data or regression results.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>algorithm</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The correlation algorithm to use. Options include:
- <code>"lb"</code>, <code>"alb"</code>, <code>"acorr_ljungbox"</code>, <code>"acor_lb"</code>, <code>"a_lb"</code>, <code>"ljungbox"</code>: Ljung-Box Test (default)
- <code>"lm"</code>, <code>"alm"</code>, <code>"acorr_lm"</code>, <code>"a_lm"</code>: Lagrange Multiplier Test
- <code>"bglm"</code>, <code>"breusch_godfrey"</code>, <code>"bg"</code>: Breusch-Godfrey Test</p>
              </div>
            </td>
            <td>
                  <code>&#39;lb&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>alpha</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The significance level for the test. Default: <code>0.05</code>.</p>
              </div>
            </td>
            <td>
                  <code>0.05</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>kwargs</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="float">float</span>, <span title="int">int</span>, <span title="str">str</span>, <span title="bool">bool</span>, <span title="numpy.typing.ArrayLike">ArrayLike</span>, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional arguments to pass to the underlying algorithm.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If an unsupported algorithm is specified.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="float">float</span>, <span title="bool">bool</span>, None]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary containing:
- <code>"result"</code> (bool): <code>True</code> if the series is significantly correlated.
- <code>"statistic"</code> (float): The test statistic.
- <code>"pvalue"</code> (float): The p-value of the test.
- <code>"alpha"</code> (float): The significance level used.
- <code>"algorithm"</code> (str): The algorithm name used.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <details class="example" open="open">
<summary>Examples</summary>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Setup</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ts_stat_tests.tests.correlation</span><span class="w"> </span><span class="kn">import</span> <span class="n">is_correlated</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ts_stat_tests.utils.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">data_normal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">normal</span> <span class="o">=</span> <span class="n">data_normal</span>
</code></pre></div></td></tr></table></div>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 1: Ljung-Box test on random data</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">is_correlated</span><span class="p">(</span><span class="n">normal</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;lb&quot;</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="p">[</span><span class="s2">&quot;result&quot;</span><span class="p">]</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;p-value: </span><span class="si">{</span><span class="n">res</span><span class="p">[</span><span class="s1">&#39;pvalue&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">p-value: 0.1628</span>
</code></pre></div></td></tr></table></div>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 2: LM test</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">is_correlated</span><span class="p">(</span><span class="n">normal</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;lm&quot;</span><span class="p">,</span> <span class="n">nlags</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="p">[</span><span class="s2">&quot;result&quot;</span><span class="p">]</span>
<span class="go">False</span>
</code></pre></div></td></tr></table></div>
</details>
<details class="tip">
<summary>See Also</summary>
<ul>
<li><a class="autorefs autorefs-internal" title="            correlation" href="#ts_stat_tests.tests.correlation.correlation"><code>correlation()</code></a>: Dispatcher for correlation measures and tests.</li>
<li><a class="autorefs autorefs-internal" title="            lb" href="#ts_stat_tests.algorithms.correlation.lb"><code>ts_stat_tests.algorithms.correlation.lb</code></a>: Ljung-Box Test algorithm.</li>
<li><a class="autorefs autorefs-internal" title="            lm" href="#ts_stat_tests.algorithms.correlation.lm"><code>ts_stat_tests.algorithms.correlation.lm</code></a>: Lagrange Multiplier Test algorithm.</li>
<li><a class="autorefs autorefs-internal" title="            bglm" href="#ts_stat_tests.algorithms.correlation.bglm"><code>ts_stat_tests.algorithms.correlation.bglm</code></a>: Breusch-Godfrey Test algorithm.</li>
</ul>
</details>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/ts_stat_tests/tests/correlation.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@typechecked</span>
<span class="k">def</span><span class="w"> </span><span class="nf">is_correlated</span><span class="p">(</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ArrayLike</span><span class="p">,</span> <span class="n">ArrayLike1D</span><span class="p">,</span> <span class="n">RegressionResults</span><span class="p">,</span> <span class="n">RegressionResultsWrapper</span><span class="p">],</span>
    <span class="n">algorithm</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;lb&quot;</span><span class="p">,</span>
    <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="kc">None</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    !!! note &quot;Summary&quot;</span>
<span class="sd">        Test whether a given data set is `correlated` or not.</span>

<span class="sd">    ???+ abstract &quot;Details&quot;</span>
<span class="sd">        This function checks for autocorrelation in the given data using various tests. By default, it uses the Ljung-Box test.</span>

<span class="sd">        - **Ljung-Box (`lb`)**: Tests the null hypothesis that the data are independently distributed (i.e. no autocorrelation). If the p-value is less than `alpha`, the null hypothesis is rejected, and the series is considered `correlated`. If multiple lags are provided, it checks if any of the p-values are below `alpha`.</span>
<span class="sd">        - **LM Test (`lm`)**: Tests for serial correlation. If the LMP-value is less than `alpha`, it is considered `correlated`.</span>
<span class="sd">        - **Breusch-Godfrey (`bglm`)**: Tests for serial correlation in residuals. If the LMP-value is less than `alpha`, it is considered `correlated`.</span>

<span class="sd">    Params:</span>
<span class="sd">        x (Union[ArrayLike, ArrayLike1D, RegressionResults, RegressionResultsWrapper]):</span>
<span class="sd">            The input time series data or regression results.</span>
<span class="sd">        algorithm (str):</span>
<span class="sd">            The correlation algorithm to use. Options include:</span>
<span class="sd">            - `&quot;lb&quot;`, `&quot;alb&quot;`, `&quot;acorr_ljungbox&quot;`, `&quot;acor_lb&quot;`, `&quot;a_lb&quot;`, `&quot;ljungbox&quot;`: Ljung-Box Test (default)</span>
<span class="sd">            - `&quot;lm&quot;`, `&quot;alm&quot;`, `&quot;acorr_lm&quot;`, `&quot;a_lm&quot;`: Lagrange Multiplier Test</span>
<span class="sd">            - `&quot;bglm&quot;`, `&quot;breusch_godfrey&quot;`, `&quot;bg&quot;`: Breusch-Godfrey Test</span>
<span class="sd">        alpha (float, optional):</span>
<span class="sd">            The significance level for the test. Default: `0.05`.</span>
<span class="sd">        kwargs (Union[float, int, str, bool, ArrayLike, None]):</span>
<span class="sd">            Additional arguments to pass to the underlying algorithm.</span>

<span class="sd">    Raises:</span>
<span class="sd">        (ValueError):</span>
<span class="sd">            If an unsupported algorithm is specified.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (dict[str, Union[str, float, bool, None]]):</span>
<span class="sd">            A dictionary containing:</span>
<span class="sd">            - `&quot;result&quot;` (bool): `True` if the series is significantly correlated.</span>
<span class="sd">            - `&quot;statistic&quot;` (float): The test statistic.</span>
<span class="sd">            - `&quot;pvalue&quot;` (float): The p-value of the test.</span>
<span class="sd">            - `&quot;alpha&quot;` (float): The significance level used.</span>
<span class="sd">            - `&quot;algorithm&quot;` (str): The algorithm name used.</span>

<span class="sd">    ???+ example &quot;Examples&quot;</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Setup&quot;}</span>
<span class="sd">        &gt;&gt;&gt; from ts_stat_tests.tests.correlation import is_correlated</span>
<span class="sd">        &gt;&gt;&gt; from ts_stat_tests.utils.data import data_normal</span>
<span class="sd">        &gt;&gt;&gt; normal = data_normal</span>

<span class="sd">        ```</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Example 1: Ljung-Box test on random data&quot;}</span>
<span class="sd">        &gt;&gt;&gt; res = is_correlated(normal, algorithm=&quot;lb&quot;, lags=[5])</span>
<span class="sd">        &gt;&gt;&gt; res[&quot;result&quot;]</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;p-value: {res[&#39;pvalue&#39;]:.4f}&quot;)</span>
<span class="sd">        p-value: 0.1628</span>

<span class="sd">        ```</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Example 2: LM test&quot;}</span>
<span class="sd">        &gt;&gt;&gt; res = is_correlated(normal, algorithm=&quot;lm&quot;, nlags=5)</span>
<span class="sd">        &gt;&gt;&gt; res[&quot;result&quot;]</span>
<span class="sd">        False</span>

<span class="sd">        ```</span>

<span class="sd">    ??? tip &quot;See Also&quot;</span>
<span class="sd">        - [`correlation()`][ts_stat_tests.tests.correlation.correlation]: Dispatcher for correlation measures and tests.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.correlation.lb`][ts_stat_tests.algorithms.correlation.lb]: Ljung-Box Test algorithm.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.correlation.lm`][ts_stat_tests.algorithms.correlation.lm]: Lagrange Multiplier Test algorithm.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.correlation.bglm`][ts_stat_tests.algorithms.correlation.bglm]: Breusch-Godfrey Test algorithm.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">options</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;lb&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;alb&quot;</span><span class="p">,</span> <span class="s2">&quot;acorr_ljungbox&quot;</span><span class="p">,</span> <span class="s2">&quot;acor_lb&quot;</span><span class="p">,</span> <span class="s2">&quot;a_lb&quot;</span><span class="p">,</span> <span class="s2">&quot;lb&quot;</span><span class="p">,</span> <span class="s2">&quot;ljungbox&quot;</span><span class="p">),</span>
        <span class="s2">&quot;lm&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;alm&quot;</span><span class="p">,</span> <span class="s2">&quot;acorr_lm&quot;</span><span class="p">,</span> <span class="s2">&quot;a_lm&quot;</span><span class="p">,</span> <span class="s2">&quot;lm&quot;</span><span class="p">),</span>
        <span class="s2">&quot;bglm&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;bglm&quot;</span><span class="p">,</span> <span class="s2">&quot;breusch_godfrey&quot;</span><span class="p">,</span> <span class="s2">&quot;bg&quot;</span><span class="p">),</span>
    <span class="p">}</span>

    <span class="n">res</span> <span class="o">=</span> <span class="n">correlation</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="n">algorithm</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

    <span class="n">is_corr</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">stat</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">pval</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">algorithm</span> <span class="ow">in</span> <span class="n">options</span><span class="p">[</span><span class="s2">&quot;lb&quot;</span><span class="p">]:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">res</span>
        <span class="c1"># Check if any p-value is significant</span>
        <span class="n">pval</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;lb_pvalue&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
        <span class="c1"># Metric: if any lag shows correlation, the series is correlated</span>
        <span class="n">is_corr</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">pval</span> <span class="o">&lt;</span> <span class="n">alpha</span><span class="p">)</span>
        <span class="c1"># Return the statistic for the most significant lag</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;lb_pvalue&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()</span>
        <span class="n">stat</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="s2">&quot;lb_stat&quot;</span><span class="p">])</span>

    <span class="k">elif</span> <span class="n">algorithm</span> <span class="ow">in</span> <span class="n">options</span><span class="p">[</span><span class="s2">&quot;lm&quot;</span><span class="p">]</span> <span class="ow">or</span> <span class="n">algorithm</span> <span class="ow">in</span> <span class="n">options</span><span class="p">[</span><span class="s2">&quot;bglm&quot;</span><span class="p">]:</span>
        <span class="c1"># returns (lm, lmpval, fval, fpval)</span>
        <span class="n">res_tuple</span> <span class="o">=</span> <span class="n">res</span>
        <span class="n">stat</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">res_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">pval</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">res_tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">is_corr</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">pval</span> <span class="o">&lt;</span> <span class="n">alpha</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Algorithm &#39;</span><span class="si">{</span><span class="n">algorithm</span><span class="si">}</span><span class="s2">&#39; is not supported for &#39;is_correlated&#39;. &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;Supported algorithms for boolean check are: &#39;lb&#39;, &#39;lm&#39;, &#39;bglm&#39;.&quot;</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="n">is_corr</span><span class="p">,</span>
        <span class="s2">&quot;statistic&quot;</span><span class="p">:</span> <span class="n">stat</span><span class="p">,</span>
        <span class="s2">&quot;pvalue&quot;</span><span class="p">:</span> <span class="n">pval</span><span class="p">,</span>
        <span class="s2">&quot;alpha&quot;</span><span class="p">:</span> <span class="n">alpha</span><span class="p">,</span>
        <span class="s2">&quot;algorithm&quot;</span><span class="p">:</span> <span class="n">algorithm</span><span class="p">,</span>
    <span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div><h2 id="correlation-algorithms">Correlation Algorithms<a class="headerlink" href="#correlation-algorithms" title="Permanent link">ðŸ”—</a></h2>


<div class="doc doc-object doc-module">



<h3 id="ts_stat_tests.algorithms.correlation" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">ts_stat_tests.algorithms.correlation</span>


<a href="#ts_stat_tests.algorithms.correlation" class="headerlink" title="Permanent link">ðŸ”—</a></h3>

    <div class="doc doc-contents first">

        <div class="admonition note">
<p class="admonition-title">Summary</p>
<p>The correlation algorithms module provides functions to compute correlation measures for time series data, including the autocorrelation function (ACF), partial autocorrelation function (PACF), and cross-correlation function (CCF). These measures help identify relationships and dependencies between time series variables, which are essential for time series analysis and forecasting.</p>
<p>This module leverages the <code>statsmodels</code> library to implement these correlation measures, ensuring robust and efficient computations. The functions are designed to handle various input scenarios and provide options for customization, such as specifying the number of lags, confidence intervals, and handling missing data.</p>
<p>By using these correlation algorithms, users can gain insights into the temporal dependencies within their time series data, aiding in model selection and improving forecasting accuracy.</p>
</div>










  <div class="doc doc-children">































































































<div class="doc doc-object doc-function">


<h4 id="ts_stat_tests.algorithms.correlation.acf" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">acf</span>


<a href="#ts_stat_tests.algorithms.correlation.acf" class="headerlink" title="Permanent link">ðŸ”—</a></h4>
          <div class="doc-overloads">
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">acf</span><span class="p">(</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
    <span class="n">adjusted</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">nlags</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">fft</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">bartlett_confint</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">missing</span><span class="p">:</span> <span class="n">VALID_ACF_MISSING_OPTIONS</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">qstat</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">alpha</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]</span>
</code></pre></div><div class="doc-signature highlight"><pre><span></span><code><span class="nf">acf</span><span class="p">(</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
    <span class="n">adjusted</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">nlags</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">fft</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">bartlett_confint</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">missing</span><span class="p">:</span> <span class="n">VALID_ACF_MISSING_OPTIONS</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">qstat</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]]</span>
</code></pre></div><div class="doc-signature highlight"><pre><span></span><code><span class="nf">acf</span><span class="p">(</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
    <span class="n">adjusted</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">nlags</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">fft</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">bartlett_confint</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">missing</span><span class="p">:</span> <span class="n">VALID_ACF_MISSING_OPTIONS</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">qstat</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="kc">True</span><span class="p">],</span>
    <span class="n">alpha</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span>
    <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span>
    <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span>
    <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span>
<span class="p">]</span>
</code></pre></div><div class="doc-signature highlight"><pre><span></span><code><span class="nf">acf</span><span class="p">(</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
    <span class="n">adjusted</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">nlags</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">fft</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">bartlett_confint</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">missing</span><span class="p">:</span> <span class="n">VALID_ACF_MISSING_OPTIONS</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">qstat</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="kc">True</span><span class="p">],</span>
    <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span>
    <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span>
    <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span>
    <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span>
    <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span>
<span class="p">]</span>
</code></pre></div>          </div>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">acf</span><span class="p">(</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
    <span class="n">adjusted</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">nlags</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">fft</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">bartlett_confint</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">missing</span><span class="p">:</span> <span class="n">VALID_ACF_MISSING_OPTIONS</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">qstat</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">alpha</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span>
    <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span>
    <span class="nb">tuple</span><span class="p">[</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]],</span>
    <span class="nb">tuple</span><span class="p">[</span>
        <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span>
        <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span>
        <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span>
    <span class="p">],</span>
    <span class="nb">tuple</span><span class="p">[</span>
        <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span>
        <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span>
        <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span>
        <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span>
    <span class="p">],</span>
<span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <div class="admonition note">
<p class="admonition-title">Summary</p>
<p>The autocorrelation function (ACF) is a statistical tool used to study the correlation between a time series and its lagged values. In time series forecasting, the ACF is used to identify patterns and relationships between values in a time series at different lags, which can then be used to make predictions about future values.</p>
<p>This function will implement the <a href="https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.acf.html"><code>acf()</code></a> function from the <a href="https://www.statsmodels.org"><code>statsmodels</code></a> library.</p>
</div>
<details class="abstract" open="open">
<summary>Details</summary>
<p>The acf at lag <code>0</code> (ie., <code>1</code>) is returned.</p>
<p>For very long time series it is recommended to use <code>fft</code> convolution instead. When <code>fft</code> is <code>False</code> uses a simple, direct estimator of the autocovariances that only computes the first <span class="arithmatex">\(nlags + 1\)</span> values. This can be much faster when the time series is long and only a small number of autocovariances are needed.</p>
<p>If <code>adjusted</code> is <code>True</code>, the denominator for the autocovariance is adjusted for the loss of data.</p>
<p>The ACF measures the correlation between a time series and its lagged values at different lags. The correlation is calculated as the ratio of the covariance between the series and its lagged values to the product of their standard deviations. The ACF is typically plotted as a graph, with the lag on the <code>x</code>-axis and the correlation coefficient on the <code>y</code>-axis.</p>
<p>If the ACF shows a strong positive correlation at lag <span class="arithmatex">\(k\)</span>, this means that values in the time series at time <span class="arithmatex">\(t\)</span> and time <span class="arithmatex">\(t-k\)</span> are strongly related. This can be useful in forecasting, as it suggests that past values can be used to predict future values. If the ACF shows a strong negative correlation at lag <span class="arithmatex">\(k\)</span>, this means that values at time <span class="arithmatex">\(t\)</span> and time <span class="arithmatex">\(t-k\)</span> are strongly inversely related, which can also be useful in forecasting.</p>
<p>The ACF can be used to identify the order of an autoregressive (AR) model, which is a type of model used in time series forecasting. The order of an AR model is the number of lags that are used to predict future values. The ACF can also be used to diagnose the presence of seasonality in a time series.</p>
<p>Overall, the autocorrelation function is a valuable tool in time series forecasting, as it helps to identify patterns and relationships between values in a time series that can be used to make predictions about future values.</p>
<p>The ACF can be calculated using the <code>acf()</code> function in the <code>statsmodels</code> package in Python. The function takes a time series array as input and returns an array of autocorrelation coefficients at different lags. The significance of the autocorrelation coefficients can be tested using the Ljung-Box test, which tests the null hypothesis that the autocorrelation coefficients are zero up to a certain lag. The Ljung-Box test can be performed using the <code>acorr_ljungbox()</code> function in the <code>statsmodels</code> package. If the p-value of the test is less than a certain significance level (e.g. <span class="arithmatex">\(0.05\)</span>), then there is evidence of significant autocorrelation in the time series up to the specified lag.</p>
</details>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="numpy.typing.ArrayLike">ArrayLike</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The time series data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>adjusted</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, then denominators for auto-covariance are <span class="arithmatex">\(n-k\)</span>, otherwise <span class="arithmatex">\(n\)</span>.<br>
Defaults to <code>False</code>.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>nlags</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of lags to return autocorrelation for. If not provided, uses <span class="arithmatex">\(\min(10 \times \log_{10}(n_{obs}), n_{obs}-1)\)</span> (calculated with: <code>min(int(10 * np.log10(nobs)), nobs - 1)</code>). The returned value includes lag <span class="arithmatex">\(0\)</span> (ie., <span class="arithmatex">\(1\)</span>) so size of the acf vector is <span class="arithmatex">\((nlags + 1,)\)</span>.<br>
Defaults to <code>None</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>qstat</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, also returns the Ljung-Box <span class="arithmatex">\(Q\)</span> statistic and corresponding p-values for each autocorrelation coefficient; see the <em>Returns</em> section for details.<br>
Defaults to <code>False</code>.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fft</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, computes the ACF via FFT.<br>
Defaults to <code>True</code>.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>alpha</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If a number is given, the confidence intervals for the given level are returned. For instance if <code>alpha=0.05</code>, a <span class="arithmatex">\(95\%\)</span> confidence intervals are returned where the standard deviation is computed according to Bartlett's formula.<br>
Defaults to <code>None</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bartlett_confint</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Confidence intervals for ACF values are generally placed at 2 standard errors around <span class="arithmatex">\(r_k\)</span>. The formula used for standard error depends upon the situation. If the autocorrelations are being used to test for randomness of residuals as part of the ARIMA routine, the standard errors are determined assuming the residuals are white noise. The approximate formula for any lag is that standard error of each <span class="arithmatex">\(r_k = \frac{1}{\sqrt{N}}\)</span>. See section 9.4 of [2] for more details on the <span class="arithmatex">\(\frac{1}{\sqrt{N}}\)</span> result. For more elementary discussion, see section 5.3.2 in [3]. For the ACF of raw data, the standard error at a lag <span class="arithmatex">\(k\)</span> is found as if the right model was an <span class="arithmatex">\(\text{MA}(k-1)\)</span>. This allows the possible interpretation that if all autocorrelations past a certain lag are within the limits, the model might be an <span class="arithmatex">\(\text{MA}\)</span> of order defined by the last significant autocorrelation. In this case, a moving average model is assumed for the data and the standard errors for the confidence intervals should be generated using Bartlett's formula. For more details on Bartlett formula result, see section 7.2 in [2].<br>
Defaults to <code>True</code>.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>missing</code>
            </td>
            <td>
                  <code><span title="ts_stat_tests.algorithms.correlation.VALID_ACF_MISSING_OPTIONS">VALID_ACF_MISSING_OPTIONS</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string in <code>["none", "raise", "conservative", "drop"]</code> specifying how the <code>NaN</code>'s are to be treated.</p>
<ul>
<li><code>"none"</code> performs no checks.</li>
<li><code>"raise"</code> raises an exception if NaN values are found.</li>
<li><code>"drop"</code> removes the missing observations and then estimates the autocovariances treating the non-missing as contiguous.</li>
<li><code>"conservative"</code> computes the autocovariance using nan-ops so that nans are removed when computing the mean and cross-products that are used to estimate the autocovariance.</li>
</ul>
<p>When using <code>"conservative"</code>, <span class="arithmatex">\(n\)</span> is set to the number of non-missing observations.<br>
Defaults to <code>"none"</code>.</p>
              </div>
            </td>
            <td>
                  <code>&#39;none&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>], <span title="tuple">tuple</span>[<span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>], <span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>]], <span title="tuple">tuple</span>[<span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>], <span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>], <span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>]], <span title="tuple">tuple</span>[<span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>], <span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>], <span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>], <span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Depending on <code>qstat</code> and <code>alpha</code>, returns the following values:
- <code>acf</code> (NDArray[np.float64]): The autocorrelation function for lags <code>0, 1, ..., nlags</code>.
- <code>confint</code> (NDArray[np.float64], optional): Confidence intervals for the ACF (returned if <code>alpha</code> is not <code>None</code>).
- <code>qstat</code> (NDArray[np.float64], optional): The Ljung-Box Q-Statistic (returned if <code>qstat</code> is <code>True</code>).
- <code>pvalues</code> (NDArray[np.float64], optional): P-values associated with the Q-statistics (returned if <code>qstat</code> is <code>True</code>).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <details class="example" open="open">
<summary>Examples</summary>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Setup</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ts_stat_tests.algorithms.correlation</span><span class="w"> </span><span class="kn">import</span> <span class="n">acf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ts_stat_tests.utils.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">data_airline</span><span class="p">,</span> <span class="n">data_macrodata</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_macro</span> <span class="o">=</span> <span class="n">data_macrodata</span><span class="o">.</span><span class="n">realgdp</span><span class="o">.</span><span class="n">values</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_airline</span> <span class="o">=</span> <span class="n">data_airline</span><span class="o">.</span><span class="n">values</span>
</code></pre></div></td></tr></table></div>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 1: Basic ACF</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">res_acf</span> <span class="o">=</span> <span class="n">acf</span><span class="p">(</span><span class="n">data_macro</span><span class="p">,</span> <span class="n">nlags</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">res_acf</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">])</span>
<span class="go">[0.98685781 0.97371846 0.96014366 0.94568545 0.93054425]</span>
</code></pre></div></td></tr></table></div>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 2: ACF with Confidence Intervals and Q-Statistics</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">res_acf</span><span class="p">,</span> <span class="n">res_confint</span><span class="p">,</span> <span class="n">res_qstat</span><span class="p">,</span> <span class="n">res_pvalues</span> <span class="o">=</span> <span class="n">acf</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">data_macro</span><span class="p">,</span> <span class="n">nlags</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">qstat</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">res_acf</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">])</span>
<span class="go">[0.98685781 0.97371846 0.96014366 0.94568545 0.93054425]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">res_confint</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">])</span>
<span class="go">[[0.84929531 1.12442032]</span>
<span class="go"> [0.73753616 1.20990077]</span>
<span class="go"> [0.65738012 1.2629072 ]</span>
<span class="go"> [0.5899385  1.30143239]</span>
<span class="go"> [0.53004062 1.33104787]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">res_qstat</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>
<span class="go">[200.63546275 396.93562234 588.75493948 775.77587865 957.77058934]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">res_pvalues</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>
<span class="go">[1.51761209e-045 6.40508316e-087 2.76141970e-127 1.35591614e-166</span>
<span class="go"> 8.33354393e-205]</span>
</code></pre></div></td></tr></table></div>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 3: ACF without FFT</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">res_acf</span><span class="p">,</span> <span class="n">res_confint</span><span class="p">,</span> <span class="n">res_qstat</span><span class="p">,</span> <span class="n">res_pvalues</span> <span class="o">=</span> <span class="n">acf</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">data_macro</span><span class="p">,</span> <span class="n">nlags</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">qstat</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">fft</span><span class="o">=</span><span class="kc">False</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">res_acf</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">])</span>
<span class="go">[0.98685781 0.97371846 0.96014366 0.94568545 0.93054425]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">res_qstat</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>
<span class="go">[200.63546275 396.93562234 588.75493948 775.77587865 957.77058934]</span>
</code></pre></div></td></tr></table></div>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 4: ACF with Adjusted Denominator</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">res_acf</span><span class="p">,</span> <span class="n">res_confint</span> <span class="o">=</span> <span class="n">acf</span><span class="p">(</span><span class="n">data_macro</span><span class="p">,</span> <span class="n">nlags</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">adjusted</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">res_acf</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">])</span>
<span class="go">[0.99174325 0.98340721 0.97454582 0.9646942  0.95404284]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">res_confint</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">])</span>
<span class="go">[[0.85418074 1.12930575]</span>
<span class="go"> [0.74645168 1.22036273]</span>
<span class="go"> [0.66999819 1.27909344]</span>
<span class="go"> [0.60595482 1.32343358]</span>
<span class="go"> [0.54917796 1.35890772]]</span>
</code></pre></div></td></tr></table></div>
</details>
<details class="equation">
<summary>Calculation</summary>
<p>The ACF at lag <span class="arithmatex">\(k\)</span> is defined as:</p>
<div class="arithmatex">\[
ACF(k) = \frac{ Cov(Y_t, Y_{t-k}) }{ \sqrt{Var(Y_t) \times Var(Y_{t-k})} }
\]</div>
<p>where:</p>
<ul>
<li><span class="arithmatex">\(Y_t\)</span> and <span class="arithmatex">\(Y_{t-k}\)</span> are the values of the time series at time <span class="arithmatex">\(t\)</span> and time <span class="arithmatex">\(t-k\)</span>, respectively,</li>
<li><span class="arithmatex">\(Cov(Y_t, Y_{t-k})\)</span> is the covariance between the two values, and</li>
<li><span class="arithmatex">\(Var(Y_t)\)</span> and <span class="arithmatex">\(Var(Y_{t-k})\)</span> are the variances of the two values.</li>
</ul>
<p>For a stationary series, this simplifies to:</p>
<div class="arithmatex">\[
ACF(k) = \frac{ Cov(Y_t, Y_{t-k}) }{ Var(Y_t) }
\]</div>
</details>
<details class="success">
<summary>Credit</summary>
<ul>
<li>All credit goes to the <a href="https://www.statsmodels.org/"><code>statsmodels</code></a> library.</li>
</ul>
</details>
<details class="question">
<summary>References</summary>
<ol>
<li>Parzen, E., 1963. On spectral analysis with missing observations and amplitude modulation. Sankhya: The Indian Journal of Statistics, Series A, pp.383-392.</li>
<li>Brockwell and Davis, 1987. Time Series Theory and Methods.</li>
<li>Brockwell and Davis, 2010. Introduction to Time Series and Forecasting, 2nd edition.</li>
</ol>
</details>
<details class="tip">
<summary>See Also</summary>
<ul>
<li><a href="https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.acf.html"><code>statsmodels.tsa.stattools.acf</code></a>: Estimate the autocorrelation function.</li>
<li><a href="https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.pacf.html"><code>statsmodels.tsa.stattools.pacf</code></a>: Partial autocorrelation estimation.</li>
<li><a href="https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.ccf.html"><code>statsmodels.tsa.stattools.ccf</code></a>: The cross-correlation function.</li>
<li><a class="autorefs autorefs-internal" title="            acf" href="#ts_stat_tests.algorithms.correlation.acf"><code>ts_stat_tests.algorithms.correlation.acf</code></a>: Estimate the autocorrelation function</li>
<li><a class="autorefs autorefs-internal" title="            pacf" href="#ts_stat_tests.algorithms.correlation.pacf"><code>ts_stat_tests.algorithms.correlation.pacf</code></a>: Partial autocorrelation estimate.</li>
<li><a class="autorefs autorefs-internal" title="            ccf" href="#ts_stat_tests.algorithms.correlation.ccf"><code>ts_stat_tests.algorithms.correlation.ccf</code></a>: The cross-correlation function.</li>
</ul>
</details>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/ts_stat_tests/algorithms/correlation.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@typechecked</span>
<span class="k">def</span><span class="w"> </span><span class="nf">acf</span><span class="p">(</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
    <span class="n">adjusted</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">nlags</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">fft</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">bartlett_confint</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">missing</span><span class="p">:</span> <span class="n">VALID_ACF_MISSING_OPTIONS</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">qstat</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">alpha</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span>
    <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span>
    <span class="nb">tuple</span><span class="p">[</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]],</span>
    <span class="nb">tuple</span><span class="p">[</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]],</span>
    <span class="nb">tuple</span><span class="p">[</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]],</span>
<span class="p">]:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    !!! note &quot;Summary&quot;</span>

<span class="sd">        The autocorrelation function (ACF) is a statistical tool used to study the correlation between a time series and its lagged values. In time series forecasting, the ACF is used to identify patterns and relationships between values in a time series at different lags, which can then be used to make predictions about future values.</span>

<span class="sd">        This function will implement the [`acf()`](https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.acf.html) function from the [`statsmodels`](https://www.statsmodels.org) library.</span>

<span class="sd">    ???+ abstract &quot;Details&quot;</span>

<span class="sd">        The acf at lag `0` (ie., `1`) is returned.</span>

<span class="sd">        For very long time series it is recommended to use `fft` convolution instead. When `fft` is `False` uses a simple, direct estimator of the autocovariances that only computes the first $nlags + 1$ values. This can be much faster when the time series is long and only a small number of autocovariances are needed.</span>

<span class="sd">        If `adjusted` is `True`, the denominator for the autocovariance is adjusted for the loss of data.</span>

<span class="sd">        The ACF measures the correlation between a time series and its lagged values at different lags. The correlation is calculated as the ratio of the covariance between the series and its lagged values to the product of their standard deviations. The ACF is typically plotted as a graph, with the lag on the `x`-axis and the correlation coefficient on the `y`-axis.</span>

<span class="sd">        If the ACF shows a strong positive correlation at lag $k$, this means that values in the time series at time $t$ and time $t-k$ are strongly related. This can be useful in forecasting, as it suggests that past values can be used to predict future values. If the ACF shows a strong negative correlation at lag $k$, this means that values at time $t$ and time $t-k$ are strongly inversely related, which can also be useful in forecasting.</span>

<span class="sd">        The ACF can be used to identify the order of an autoregressive (AR) model, which is a type of model used in time series forecasting. The order of an AR model is the number of lags that are used to predict future values. The ACF can also be used to diagnose the presence of seasonality in a time series.</span>

<span class="sd">        Overall, the autocorrelation function is a valuable tool in time series forecasting, as it helps to identify patterns and relationships between values in a time series that can be used to make predictions about future values.</span>

<span class="sd">        The ACF can be calculated using the `acf()` function in the `statsmodels` package in Python. The function takes a time series array as input and returns an array of autocorrelation coefficients at different lags. The significance of the autocorrelation coefficients can be tested using the Ljung-Box test, which tests the null hypothesis that the autocorrelation coefficients are zero up to a certain lag. The Ljung-Box test can be performed using the `acorr_ljungbox()` function in the `statsmodels` package. If the p-value of the test is less than a certain significance level (e.g. $0.05$), then there is evidence of significant autocorrelation in the time series up to the specified lag.</span>

<span class="sd">    Params:</span>
<span class="sd">        x (ArrayLike):</span>
<span class="sd">            The time series data.</span>
<span class="sd">        adjusted (bool, optional):</span>
<span class="sd">            If `True`, then denominators for auto-covariance are $n-k$, otherwise $n$.&lt;br&gt;</span>
<span class="sd">            Defaults to `False`.</span>
<span class="sd">        nlags (Optional[int], optional):</span>
<span class="sd">            Number of lags to return autocorrelation for. If not provided, uses $\min(10 \times \log_{10}(n_{obs}), n_{obs}-1)$ (calculated with: `min(int(10 * np.log10(nobs)), nobs - 1)`). The returned value includes lag $0$ (ie., $1$) so size of the acf vector is $(nlags + 1,)$.&lt;br&gt;</span>
<span class="sd">            Defaults to `None`.</span>
<span class="sd">        qstat (bool, optional):</span>
<span class="sd">            If `True`, also returns the Ljung-Box $Q$ statistic and corresponding p-values for each autocorrelation coefficient; see the *Returns* section for details.&lt;br&gt;</span>
<span class="sd">            Defaults to `False`.</span>
<span class="sd">        fft (bool, optional):</span>
<span class="sd">            If `True`, computes the ACF via FFT.&lt;br&gt;</span>
<span class="sd">            Defaults to `True`.</span>
<span class="sd">        alpha (Optional[float], optional):</span>
<span class="sd">            If a number is given, the confidence intervals for the given level are returned. For instance if `alpha=0.05`, a $95\%$ confidence intervals are returned where the standard deviation is computed according to Bartlett&#39;s formula.&lt;br&gt;</span>
<span class="sd">            Defaults to `None`.</span>
<span class="sd">        bartlett_confint (bool, optional):</span>
<span class="sd">            Confidence intervals for ACF values are generally placed at 2 standard errors around $r_k$. The formula used for standard error depends upon the situation. If the autocorrelations are being used to test for randomness of residuals as part of the ARIMA routine, the standard errors are determined assuming the residuals are white noise. The approximate formula for any lag is that standard error of each $r_k = \frac{1}{\sqrt{N}}$. See section 9.4 of [2] for more details on the $\frac{1}{\sqrt{N}}$ result. For more elementary discussion, see section 5.3.2 in [3]. For the ACF of raw data, the standard error at a lag $k$ is found as if the right model was an $\text{MA}(k-1)$. This allows the possible interpretation that if all autocorrelations past a certain lag are within the limits, the model might be an $\text{MA}$ of order defined by the last significant autocorrelation. In this case, a moving average model is assumed for the data and the standard errors for the confidence intervals should be generated using Bartlett&#39;s formula. For more details on Bartlett formula result, see section 7.2 in [2].&lt;br&gt;</span>
<span class="sd">            Defaults to `True`.</span>
<span class="sd">        missing (VALID_ACF_MISSING_OPTIONS, optional):</span>
<span class="sd">            A string in `[&quot;none&quot;, &quot;raise&quot;, &quot;conservative&quot;, &quot;drop&quot;]` specifying how the `NaN`&#39;s are to be treated.</span>

<span class="sd">            - `&quot;none&quot;` performs no checks.</span>
<span class="sd">            - `&quot;raise&quot;` raises an exception if NaN values are found.</span>
<span class="sd">            - `&quot;drop&quot;` removes the missing observations and then estimates the autocovariances treating the non-missing as contiguous.</span>
<span class="sd">            - `&quot;conservative&quot;` computes the autocovariance using nan-ops so that nans are removed when computing the mean and cross-products that are used to estimate the autocovariance.</span>

<span class="sd">            When using `&quot;conservative&quot;`, $n$ is set to the number of non-missing observations.&lt;br&gt;</span>
<span class="sd">            Defaults to `&quot;none&quot;`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (Union[NDArray[np.float64], tuple[NDArray[np.float64], NDArray[np.float64]], tuple[NDArray[np.float64], NDArray[np.float64], NDArray[np.float64]], tuple[NDArray[np.float64], NDArray[np.float64], NDArray[np.float64], NDArray[np.float64]]]):</span>
<span class="sd">            Depending on `qstat` and `alpha`, returns the following values:</span>
<span class="sd">            - `acf` (NDArray[np.float64]): The autocorrelation function for lags `0, 1, ..., nlags`.</span>
<span class="sd">            - `confint` (NDArray[np.float64], optional): Confidence intervals for the ACF (returned if `alpha` is not `None`).</span>
<span class="sd">            - `qstat` (NDArray[np.float64], optional): The Ljung-Box Q-Statistic (returned if `qstat` is `True`).</span>
<span class="sd">            - `pvalues` (NDArray[np.float64], optional): P-values associated with the Q-statistics (returned if `qstat` is `True`).</span>

<span class="sd">    ???+ example &quot;Examples&quot;</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Setup&quot;}</span>
<span class="sd">        &gt;&gt;&gt; from ts_stat_tests.algorithms.correlation import acf</span>
<span class="sd">        &gt;&gt;&gt; from ts_stat_tests.utils.data import data_airline, data_macrodata</span>
<span class="sd">        &gt;&gt;&gt; data_macro = data_macrodata.realgdp.values</span>
<span class="sd">        &gt;&gt;&gt; data_airline = data_airline.values</span>

<span class="sd">        ```</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Example 1: Basic ACF&quot;}</span>
<span class="sd">        &gt;&gt;&gt; res_acf = acf(data_macro, nlags=5)</span>
<span class="sd">        &gt;&gt;&gt; print(res_acf[1:6])</span>
<span class="sd">        [0.98685781 0.97371846 0.96014366 0.94568545 0.93054425]</span>

<span class="sd">        ```</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Example 2: ACF with Confidence Intervals and Q-Statistics&quot;}</span>
<span class="sd">        &gt;&gt;&gt; res_acf, res_confint, res_qstat, res_pvalues = acf(</span>
<span class="sd">        ...     data_macro, nlags=5, qstat=True, alpha=0.05</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; print(res_acf[1:6])</span>
<span class="sd">        [0.98685781 0.97371846 0.96014366 0.94568545 0.93054425]</span>
<span class="sd">        &gt;&gt;&gt; print(res_confint[1:6])</span>
<span class="sd">        [[0.84929531 1.12442032]</span>
<span class="sd">         [0.73753616 1.20990077]</span>
<span class="sd">         [0.65738012 1.2629072 ]</span>
<span class="sd">         [0.5899385  1.30143239]</span>
<span class="sd">         [0.53004062 1.33104787]]</span>
<span class="sd">        &gt;&gt;&gt; print(res_qstat[:5])</span>
<span class="sd">        [200.63546275 396.93562234 588.75493948 775.77587865 957.77058934]</span>
<span class="sd">        &gt;&gt;&gt; print(res_pvalues[:5])</span>
<span class="sd">        [1.51761209e-045 6.40508316e-087 2.76141970e-127 1.35591614e-166</span>
<span class="sd">         8.33354393e-205]</span>

<span class="sd">        ```</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Example 3: ACF without FFT&quot;}</span>
<span class="sd">        &gt;&gt;&gt; res_acf, res_confint, res_qstat, res_pvalues = acf(</span>
<span class="sd">        ...     data_macro, nlags=5, qstat=True, alpha=0.05, fft=False</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; print(res_acf[1:6])</span>
<span class="sd">        [0.98685781 0.97371846 0.96014366 0.94568545 0.93054425]</span>
<span class="sd">        &gt;&gt;&gt; print(res_qstat[:5])</span>
<span class="sd">        [200.63546275 396.93562234 588.75493948 775.77587865 957.77058934]</span>

<span class="sd">        ```</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Example 4: ACF with Adjusted Denominator&quot;}</span>
<span class="sd">        &gt;&gt;&gt; res_acf, res_confint = acf(data_macro, nlags=5, adjusted=True, alpha=0.05)</span>
<span class="sd">        &gt;&gt;&gt; print(res_acf[1:6])</span>
<span class="sd">        [0.99174325 0.98340721 0.97454582 0.9646942  0.95404284]</span>
<span class="sd">        &gt;&gt;&gt; print(res_confint[1:6])</span>
<span class="sd">        [[0.85418074 1.12930575]</span>
<span class="sd">         [0.74645168 1.22036273]</span>
<span class="sd">         [0.66999819 1.27909344]</span>
<span class="sd">         [0.60595482 1.32343358]</span>
<span class="sd">         [0.54917796 1.35890772]]</span>

<span class="sd">        ```</span>

<span class="sd">    ??? equation &quot;Calculation&quot;</span>

<span class="sd">        The ACF at lag $k$ is defined as:</span>

<span class="sd">        $$</span>
<span class="sd">        ACF(k) = \frac{ Cov(Y_t, Y_{t-k}) }{ \sqrt{Var(Y_t) \times Var(Y_{t-k})} }</span>
<span class="sd">        $$</span>

<span class="sd">        where:</span>

<span class="sd">        - $Y_t$ and $Y_{t-k}$ are the values of the time series at time $t$ and time $t-k$, respectively,</span>
<span class="sd">        - $Cov(Y_t, Y_{t-k})$ is the covariance between the two values, and</span>
<span class="sd">        - $Var(Y_t)$ and $Var(Y_{t-k})$ are the variances of the two values.</span>

<span class="sd">        For a stationary series, this simplifies to:</span>

<span class="sd">        $$</span>
<span class="sd">        ACF(k) = \frac{ Cov(Y_t, Y_{t-k}) }{ Var(Y_t) }</span>
<span class="sd">        $$</span>

<span class="sd">    ??? success &quot;Credit&quot;</span>
<span class="sd">        - All credit goes to the [`statsmodels`](https://www.statsmodels.org/) library.</span>

<span class="sd">    ??? question &quot;References&quot;</span>
<span class="sd">        1. Parzen, E., 1963. On spectral analysis with missing observations and amplitude modulation. Sankhya: The Indian Journal of Statistics, Series A, pp.383-392.</span>
<span class="sd">        2. Brockwell and Davis, 1987. Time Series Theory and Methods.</span>
<span class="sd">        3. Brockwell and Davis, 2010. Introduction to Time Series and Forecasting, 2nd edition.</span>

<span class="sd">    ??? tip &quot;See Also&quot;</span>
<span class="sd">        - [`statsmodels.tsa.stattools.acf`](https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.acf.html): Estimate the autocorrelation function.</span>
<span class="sd">        - [`statsmodels.tsa.stattools.pacf`](https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.pacf.html): Partial autocorrelation estimation.</span>
<span class="sd">        - [`statsmodels.tsa.stattools.ccf`](https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.ccf.html): The cross-correlation function.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.correlation.acf`][ts_stat_tests.algorithms.correlation.acf]: Estimate the autocorrelation function</span>
<span class="sd">        - [`ts_stat_tests.algorithms.correlation.pacf`][ts_stat_tests.algorithms.correlation.pacf]: Partial autocorrelation estimate.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.correlation.ccf`][ts_stat_tests.algorithms.correlation.ccf]: The cross-correlation function.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">st_acf</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
        <span class="n">adjusted</span><span class="o">=</span><span class="n">adjusted</span><span class="p">,</span>
        <span class="n">nlags</span><span class="o">=</span><span class="n">nlags</span><span class="p">,</span>
        <span class="n">qstat</span><span class="o">=</span><span class="n">qstat</span><span class="p">,</span>
        <span class="n">fft</span><span class="o">=</span><span class="n">fft</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
        <span class="n">bartlett_confint</span><span class="o">=</span><span class="n">bartlett_confint</span><span class="p">,</span>
        <span class="n">missing</span><span class="o">=</span><span class="n">missing</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="ts_stat_tests.algorithms.correlation.pacf" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">pacf</span>


<a href="#ts_stat_tests.algorithms.correlation.pacf" class="headerlink" title="Permanent link">ðŸ”—</a></h4>
          <div class="doc-overloads">
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">pacf</span><span class="p">(</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">ArrayLike1D</span><span class="p">,</span>
    <span class="n">nlags</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">method</span><span class="p">:</span> <span class="n">VALID_PACF_METHOD_OPTIONS</span> <span class="o">=</span> <span class="s2">&quot;ywadjusted&quot;</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">alpha</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]</span>
</code></pre></div><div class="doc-signature highlight"><pre><span></span><code><span class="nf">pacf</span><span class="p">(</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">ArrayLike1D</span><span class="p">,</span>
    <span class="n">nlags</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">method</span><span class="p">:</span> <span class="n">VALID_PACF_METHOD_OPTIONS</span> <span class="o">=</span> <span class="s2">&quot;ywadjusted&quot;</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]]</span>
</code></pre></div>          </div>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">pacf</span><span class="p">(</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">ArrayLike1D</span><span class="p">,</span>
    <span class="n">nlags</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">method</span><span class="p">:</span> <span class="n">VALID_PACF_METHOD_OPTIONS</span> <span class="o">=</span> <span class="s2">&quot;ywadjusted&quot;</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">alpha</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span>
    <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span>
    <span class="nb">tuple</span><span class="p">[</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]],</span>
<span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <div class="admonition note">
<p class="admonition-title">Summary</p>
<p>The partial autocorrelation function (PACF) is a statistical tool used in time series forecasting to identify the direct relationship between two variables, controlling for the effect of the other variables in the time series. In other words, the PACF measures the correlation between a time series and its lagged values, while controlling for the effects of other intermediate lags.</p>
<p>This function will implement the <a href="https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.pacf.html"><code>pacf()</code></a> function from the <a href="https://www.statsmodels.org"><code>statsmodels</code></a> library.</p>
</div>
<details class="abstract" open="open">
<summary>Details</summary>
<p>Based on simulation evidence across a range of low-order ARMA models, the best methods based on root MSE are Yule-Walker (MLW), Levinson-Durbin (MLE) and Burg, respectively. The estimators with the lowest bias included these three in addition to OLS and OLS-adjusted. Yule-Walker (adjusted) and Levinson-Durbin (adjusted) performed consistently worse than the other options.</p>
<p>The PACF is a plot of the correlation between a time series and its lagged values, controlling for the effect of other lags. The PACF is useful for identifying the order of an autoregressive (AR) model, which is a type of model used in time series forecasting. The order of an AR model is the number of lags that are used to predict future values.</p>
<p>The PACF is calculated using the Yule-Walker equations, which are a set of linear equations that describe the relationship between a time series and its lagged values. The PACF is calculated as the difference between the correlation coefficient at lag <span class="arithmatex">\(k\)</span> and the correlation coefficient at lag <span class="arithmatex">\(k-1\)</span>, controlling for the effects of intermediate lags.</p>
<p>The PACF is typically plotted as a graph, with the lag on the <code>x</code>-axis and the correlation coefficient on the <code>y</code>-axis. If the PACF shows a strong positive correlation at lag <span class="arithmatex">\(k\)</span>, this means that values in the time series at time <span class="arithmatex">\(t\)</span> and time <span class="arithmatex">\(t-k\)</span> are strongly related, after controlling for the effects of intermediate lags. This suggests that past values can be used to predict future values using an AR model with an order of <span class="arithmatex">\(k\)</span>.</p>
<p>Overall, the partial autocorrelation function is a valuable tool in time series forecasting, as it helps to identify the order of an autoregressive model and to control for the effects of intermediate lags. By identifying the direct relationship between two variables, the PACF can help to improve the accuracy of time series forecasting models.</p>
<p>The PACF can be calculated using the <code>pacf()</code> function in the <code>statsmodels</code> package in Python. The function takes a time series array as input and returns an array of partial autocorrelation coefficients at different lags. The significance of the partial autocorrelation coefficients can be tested using the same Ljung-Box test as for the ACF. If the p-value of the test is less than a certain significance level (e.g. <span class="arithmatex">\(0.05\)</span>), then there is evidence of significant partial autocorrelation in the time series up to the specified lag.</p>
</details>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="statsmodels.tsa.stattools.ArrayLike1D">ArrayLike1D</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Observations of time series for which pacf is calculated.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>nlags</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of lags to return autocorrelation for. If not provided, uses <span class="arithmatex">\(\min(10 \times \log_{10}(n_{obs}), \lfloor \frac{n_{obs}}{2} \rfloor - 1)\)</span> (calculated with: <code>min(int(10*np.log10(nobs)), nobs // 2 - 1)</code>). The returned value includes lag <code>0</code> (ie., <code>1</code>) so size of the pacf vector is <span class="arithmatex">\((nlags + 1,)\)</span>.<br>
Defaults to <code>None</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>method</code>
            </td>
            <td>
                  <code><span title="ts_stat_tests.algorithms.correlation.VALID_PACF_METHOD_OPTIONS">VALID_PACF_METHOD_OPTIONS</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Specifies which method for the calculations to use.</p>
<ul>
<li><code>"yw"</code> or <code>"ywadjusted"</code>: Yule-Walker with sample-size adjustment in denominator for acovf. Default.</li>
<li><code>"ywm"</code> or <code>"ywmle"</code>: Yule-Walker without adjustment.</li>
<li><code>"ols"</code>: regression of time series on lags of it and on constant.</li>
<li><code>"ols-inefficient"</code>: regression of time series on lags using a single common sample to estimate all pacf coefficients.</li>
<li><code>"ols-adjusted"</code>: regression of time series on lags with a bias adjustment.</li>
<li><code>"ld"</code> or <code>"ldadjusted"</code>: Levinson-Durbin recursion with bias correction.</li>
<li><code>"ldb"</code> or <code>"ldbiased"</code>: Levinson-Durbin recursion without bias correction.<br></li>
</ul>
<p>Defaults to <code>"ywadjusted"</code>.</p>
              </div>
            </td>
            <td>
                  <code>&#39;ywadjusted&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>alpha</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If a number is given, the confidence intervals for the given level are returned. For instance if <code>alpha=.05</code>, <span class="arithmatex">\(95\%\)</span> confidence intervals are returned where the standard deviation is computed according to <span class="arithmatex">\(\frac{1}{\sqrt{len(x)}}\)</span>.<br>
Defaults to <code>None</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>], <span title="tuple">tuple</span>[<span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>], <span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Depending on <code>alpha</code>, returns the following values:
- <code>pacf</code> (NDArray[np.float64]): The partial autocorrelations for lags <code>0, 1, ..., nlags</code>.
- <code>confint</code> (NDArray[np.float64], optional): Confidence intervals for the PACF (returned if <code>alpha</code> is not <code>None</code>).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <details class="example" open="open">
<summary>Examples</summary>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Setup</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ts_stat_tests.algorithms.correlation</span><span class="w"> </span><span class="kn">import</span> <span class="n">pacf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ts_stat_tests.utils.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">data_airline</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">data_airline</span><span class="o">.</span><span class="n">values</span>
</code></pre></div></td></tr></table></div>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 1: Basic PACF using Yule-Walker adjusted</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">res_pacf</span> <span class="o">=</span> <span class="n">pacf</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">nlags</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">res_pacf</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">])</span>
<span class="go">[ 0.95467704 -0.26527732  0.05546955  0.10885622  0.08112579]</span>
</code></pre></div></td></tr></table></div>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 2: PACF with confidence intervals</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">res_pacf</span><span class="p">,</span> <span class="n">res_confint</span> <span class="o">=</span> <span class="n">pacf</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">nlags</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">res_confint</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
<span class="go">[[ 0.79134671  1.11800737]</span>
<span class="go"> [-0.42860765 -0.10194698]]</span>
</code></pre></div></td></tr></table></div>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 3: PACF using OLS method</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">res_pacf_ols</span> <span class="o">=</span> <span class="n">pacf</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">nlags</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;ols&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">res_pacf_ols</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">])</span>
<span class="go">[ 0.95893198 -0.32983096  0.2018249   0.14500798  0.25848232]</span>
</code></pre></div></td></tr></table></div>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 4: PACF using Levinson-Durbin recursion with bias correction</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">res_pacf_ld</span> <span class="o">=</span> <span class="n">pacf</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">nlags</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;ldadjusted&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">res_pacf_ld</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">])</span>
<span class="go">[ 0.95467704 -0.26527732  0.05546955  0.10885622  0.08112579]</span>
</code></pre></div></td></tr></table></div>
</details>
<details class="equation">
<summary>Calculation</summary>
<p>The PACF at lag <span class="arithmatex">\(k\)</span> is defined as:</p>
<div class="arithmatex">\[
PACF(k) = \text{Corr}\left( Y_t, Y_{t-k} \mid Y_{t-1}, Y_{t-2}, \dots, Y_{t-k+1} \right)
\]</div>
<p>where:</p>
<ul>
<li><span class="arithmatex">\(Y_t\)</span> and <span class="arithmatex">\(Y_{t-k}\)</span> are the values of the time series at time <span class="arithmatex">\(t\)</span> and time <span class="arithmatex">\(t-k\)</span>, respectively, and</li>
<li><span class="arithmatex">\(Y_{t-1}, Y_{t-2}, \dots, Y_{t-k+1}\)</span> are the values of the time series at intervening lags.</li>
<li><span class="arithmatex">\(\text{Corr}()\)</span> denotes the correlation coefficient between two variables.</li>
</ul>
</details>
<details class="success">
<summary>Credit</summary>
<ul>
<li>All credit goes to the <a href="https://www.statsmodels.org/"><code>statsmodels</code></a> library.</li>
</ul>
</details>
<details class="question">
<summary>References</summary>
<ol>
<li>Box, G. E., Jenkins, G. M., Reinsel, G. C., &amp; Ljung, G. M. (2015). Time series analysis: forecasting and control. John Wiley &amp; Sons, p. 66.</li>
<li>Brockwell, P.J. and Davis, R.A., 2016. Introduction to time series and forecasting. Springer.</li>
</ol>
</details>
<details class="tip">
<summary>See Also</summary>
<ul>
<li><a href="https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.acf.html"><code>statsmodels.tsa.stattools.acf</code></a>: Estimate the autocorrelation function.</li>
<li><a href="https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.pacf.html"><code>statsmodels.tsa.stattools.pacf</code></a>: Partial autocorrelation estimation.</li>
<li><a href="https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.ccf.html"><code>statsmodels.tsa.stattools.ccf</code></a>: The cross-correlation function.</li>
<li><a href="https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.pacf_yw.html"><code>statsmodels.tsa.stattools.pacf_yw</code></a>: Partial autocorrelation estimation using Yule-Walker.</li>
<li><a href="https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.pacf_ols.html"><code>statsmodels.tsa.stattools.pacf_ols</code></a>: Partial autocorrelation estimation using OLS.</li>
<li><a href="https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.pacf_burg.html"><code>statsmodels.tsa.stattools.pacf_burg</code></a>: Partial autocorrelation estimation using Burg's method.</li>
<li><a class="autorefs autorefs-internal" title="            acf" href="#ts_stat_tests.algorithms.correlation.acf"><code>ts_stat_tests.algorithms.correlation.acf</code></a>: Estimate the autocorrelation function</li>
<li><a class="autorefs autorefs-internal" title="            pacf" href="#ts_stat_tests.algorithms.correlation.pacf"><code>ts_stat_tests.algorithms.correlation.pacf</code></a>: Partial autocorrelation estimate.</li>
<li><a class="autorefs autorefs-internal" title="            ccf" href="#ts_stat_tests.algorithms.correlation.ccf"><code>ts_stat_tests.algorithms.correlation.ccf</code></a>: The cross-correlation function.</li>
</ul>
</details>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/ts_stat_tests/algorithms/correlation.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@typechecked</span>
<span class="k">def</span><span class="w"> </span><span class="nf">pacf</span><span class="p">(</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">ArrayLike1D</span><span class="p">,</span>
    <span class="n">nlags</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">method</span><span class="p">:</span> <span class="n">VALID_PACF_METHOD_OPTIONS</span> <span class="o">=</span> <span class="s2">&quot;ywadjusted&quot;</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">alpha</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]]]:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    !!! note &quot;Summary&quot;</span>

<span class="sd">        The partial autocorrelation function (PACF) is a statistical tool used in time series forecasting to identify the direct relationship between two variables, controlling for the effect of the other variables in the time series. In other words, the PACF measures the correlation between a time series and its lagged values, while controlling for the effects of other intermediate lags.</span>

<span class="sd">        This function will implement the [`pacf()`](https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.pacf.html) function from the [`statsmodels`](https://www.statsmodels.org) library.</span>

<span class="sd">    ???+ abstract &quot;Details&quot;</span>

<span class="sd">        Based on simulation evidence across a range of low-order ARMA models, the best methods based on root MSE are Yule-Walker (MLW), Levinson-Durbin (MLE) and Burg, respectively. The estimators with the lowest bias included these three in addition to OLS and OLS-adjusted. Yule-Walker (adjusted) and Levinson-Durbin (adjusted) performed consistently worse than the other options.</span>

<span class="sd">        The PACF is a plot of the correlation between a time series and its lagged values, controlling for the effect of other lags. The PACF is useful for identifying the order of an autoregressive (AR) model, which is a type of model used in time series forecasting. The order of an AR model is the number of lags that are used to predict future values.</span>

<span class="sd">        The PACF is calculated using the Yule-Walker equations, which are a set of linear equations that describe the relationship between a time series and its lagged values. The PACF is calculated as the difference between the correlation coefficient at lag $k$ and the correlation coefficient at lag $k-1$, controlling for the effects of intermediate lags.</span>

<span class="sd">        The PACF is typically plotted as a graph, with the lag on the `x`-axis and the correlation coefficient on the `y`-axis. If the PACF shows a strong positive correlation at lag $k$, this means that values in the time series at time $t$ and time $t-k$ are strongly related, after controlling for the effects of intermediate lags. This suggests that past values can be used to predict future values using an AR model with an order of $k$.</span>

<span class="sd">        Overall, the partial autocorrelation function is a valuable tool in time series forecasting, as it helps to identify the order of an autoregressive model and to control for the effects of intermediate lags. By identifying the direct relationship between two variables, the PACF can help to improve the accuracy of time series forecasting models.</span>

<span class="sd">        The PACF can be calculated using the `pacf()` function in the `statsmodels` package in Python. The function takes a time series array as input and returns an array of partial autocorrelation coefficients at different lags. The significance of the partial autocorrelation coefficients can be tested using the same Ljung-Box test as for the ACF. If the p-value of the test is less than a certain significance level (e.g. $0.05$), then there is evidence of significant partial autocorrelation in the time series up to the specified lag.</span>

<span class="sd">    Params:</span>
<span class="sd">        x (ArrayLike1D):</span>
<span class="sd">            Observations of time series for which pacf is calculated.</span>
<span class="sd">        nlags (Optional[int], optional):</span>
<span class="sd">            Number of lags to return autocorrelation for. If not provided, uses $\min(10 \times \log_{10}(n_{obs}), \lfloor \frac{n_{obs}}{2} \rfloor - 1)$ (calculated with: `min(int(10*np.log10(nobs)), nobs // 2 - 1)`). The returned value includes lag `0` (ie., `1`) so size of the pacf vector is $(nlags + 1,)$.&lt;br&gt;</span>
<span class="sd">            Defaults to `None`.</span>
<span class="sd">        method (VALID_PACF_METHOD_OPTIONS, optional):</span>
<span class="sd">            Specifies which method for the calculations to use.</span>

<span class="sd">            - `&quot;yw&quot;` or `&quot;ywadjusted&quot;`: Yule-Walker with sample-size adjustment in denominator for acovf. Default.</span>
<span class="sd">            - `&quot;ywm&quot;` or `&quot;ywmle&quot;`: Yule-Walker without adjustment.</span>
<span class="sd">            - `&quot;ols&quot;`: regression of time series on lags of it and on constant.</span>
<span class="sd">            - `&quot;ols-inefficient&quot;`: regression of time series on lags using a single common sample to estimate all pacf coefficients.</span>
<span class="sd">            - `&quot;ols-adjusted&quot;`: regression of time series on lags with a bias adjustment.</span>
<span class="sd">            - `&quot;ld&quot;` or `&quot;ldadjusted&quot;`: Levinson-Durbin recursion with bias correction.</span>
<span class="sd">            - `&quot;ldb&quot;` or `&quot;ldbiased&quot;`: Levinson-Durbin recursion without bias correction.&lt;br&gt;</span>

<span class="sd">            Defaults to `&quot;ywadjusted&quot;`.</span>
<span class="sd">        alpha (Optional[float], optional):</span>
<span class="sd">            If a number is given, the confidence intervals for the given level are returned. For instance if `alpha=.05`, $95\%$ confidence intervals are returned where the standard deviation is computed according to $\frac{1}{\sqrt{len(x)}}$.&lt;br&gt;</span>
<span class="sd">            Defaults to `None`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (Union[NDArray[np.float64], tuple[NDArray[np.float64], NDArray[np.float64]]]):</span>
<span class="sd">            Depending on `alpha`, returns the following values:</span>
<span class="sd">            - `pacf` (NDArray[np.float64]): The partial autocorrelations for lags `0, 1, ..., nlags`.</span>
<span class="sd">            - `confint` (NDArray[np.float64], optional): Confidence intervals for the PACF (returned if `alpha` is not `None`).</span>

<span class="sd">    ???+ example &quot;Examples&quot;</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Setup&quot;}</span>
<span class="sd">        &gt;&gt;&gt; from ts_stat_tests.algorithms.correlation import pacf</span>
<span class="sd">        &gt;&gt;&gt; from ts_stat_tests.utils.data import data_airline</span>
<span class="sd">        &gt;&gt;&gt; data = data_airline.values</span>

<span class="sd">        ```</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Example 1: Basic PACF using Yule-Walker adjusted&quot;}</span>
<span class="sd">        &gt;&gt;&gt; res_pacf = pacf(data, nlags=5)</span>
<span class="sd">        &gt;&gt;&gt; print(res_pacf[1:6])</span>
<span class="sd">        [ 0.95467704 -0.26527732  0.05546955  0.10885622  0.08112579]</span>

<span class="sd">        ```</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Example 2: PACF with confidence intervals&quot;}</span>
<span class="sd">        &gt;&gt;&gt; res_pacf, res_confint = pacf(data, nlags=5, alpha=0.05)</span>
<span class="sd">        &gt;&gt;&gt; print(res_confint[1:3])</span>
<span class="sd">        [[ 0.79134671  1.11800737]</span>
<span class="sd">         [-0.42860765 -0.10194698]]</span>

<span class="sd">        ```</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Example 3: PACF using OLS method&quot;}</span>
<span class="sd">        &gt;&gt;&gt; res_pacf_ols = pacf(data, nlags=5, method=&quot;ols&quot;)</span>
<span class="sd">        &gt;&gt;&gt; print(res_pacf_ols[1:6])</span>
<span class="sd">        [ 0.95893198 -0.32983096  0.2018249   0.14500798  0.25848232]</span>

<span class="sd">        ```</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Example 4: PACF using Levinson-Durbin recursion with bias correction&quot;}</span>
<span class="sd">        &gt;&gt;&gt; res_pacf_ld = pacf(data, nlags=5, method=&quot;ldadjusted&quot;)</span>
<span class="sd">        &gt;&gt;&gt; print(res_pacf_ld[1:6])</span>
<span class="sd">        [ 0.95467704 -0.26527732  0.05546955  0.10885622  0.08112579]</span>

<span class="sd">        ```</span>

<span class="sd">    ??? equation &quot;Calculation&quot;</span>

<span class="sd">        The PACF at lag $k$ is defined as:</span>

<span class="sd">        $$</span>
<span class="sd">        PACF(k) = \text{Corr}\left( Y_t, Y_{t-k} \mid Y_{t-1}, Y_{t-2}, \dots, Y_{t-k+1} \right)</span>
<span class="sd">        $$</span>

<span class="sd">        where:</span>

<span class="sd">        - $Y_t$ and $Y_{t-k}$ are the values of the time series at time $t$ and time $t-k$, respectively, and</span>
<span class="sd">        - $Y_{t-1}, Y_{t-2}, \dots, Y_{t-k+1}$ are the values of the time series at intervening lags.</span>
<span class="sd">        - $\text{Corr}()$ denotes the correlation coefficient between two variables.</span>

<span class="sd">    ??? success &quot;Credit&quot;</span>
<span class="sd">        - All credit goes to the [`statsmodels`](https://www.statsmodels.org/) library.</span>

<span class="sd">    ??? question &quot;References&quot;</span>
<span class="sd">        1. Box, G. E., Jenkins, G. M., Reinsel, G. C., &amp; Ljung, G. M. (2015). Time series analysis: forecasting and control. John Wiley &amp; Sons, p. 66.</span>
<span class="sd">        2. Brockwell, P.J. and Davis, R.A., 2016. Introduction to time series and forecasting. Springer.</span>

<span class="sd">    ??? tip &quot;See Also&quot;</span>
<span class="sd">        - [`statsmodels.tsa.stattools.acf`](https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.acf.html): Estimate the autocorrelation function.</span>
<span class="sd">        - [`statsmodels.tsa.stattools.pacf`](https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.pacf.html): Partial autocorrelation estimation.</span>
<span class="sd">        - [`statsmodels.tsa.stattools.ccf`](https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.ccf.html): The cross-correlation function.</span>
<span class="sd">        - [`statsmodels.tsa.stattools.pacf_yw`](https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.pacf_yw.html): Partial autocorrelation estimation using Yule-Walker.</span>
<span class="sd">        - [`statsmodels.tsa.stattools.pacf_ols`](https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.pacf_ols.html): Partial autocorrelation estimation using OLS.</span>
<span class="sd">        - [`statsmodels.tsa.stattools.pacf_burg`](https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.pacf_burg.html): Partial autocorrelation estimation using Burg&#39;s method.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.correlation.acf`][ts_stat_tests.algorithms.correlation.acf]: Estimate the autocorrelation function</span>
<span class="sd">        - [`ts_stat_tests.algorithms.correlation.pacf`][ts_stat_tests.algorithms.correlation.pacf]: Partial autocorrelation estimate.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.correlation.ccf`][ts_stat_tests.algorithms.correlation.ccf]: The cross-correlation function.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">st_pacf</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
        <span class="n">nlags</span><span class="o">=</span><span class="n">nlags</span><span class="p">,</span>
        <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="ts_stat_tests.algorithms.correlation.ccf" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">ccf</span>


<a href="#ts_stat_tests.algorithms.correlation.ccf" class="headerlink" title="Permanent link">ðŸ”—</a></h4>
          <div class="doc-overloads">
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">ccf</span><span class="p">(</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
    <span class="n">adjusted</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">fft</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">nlags</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">alpha</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]</span>
</code></pre></div><div class="doc-signature highlight"><pre><span></span><code><span class="nf">ccf</span><span class="p">(</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
    <span class="n">adjusted</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">fft</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">nlags</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]]</span>
</code></pre></div>          </div>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">ccf</span><span class="p">(</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
    <span class="n">adjusted</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">fft</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">nlags</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">alpha</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span>
    <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span>
    <span class="nb">tuple</span><span class="p">[</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]],</span>
<span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <div class="admonition note">
<p class="admonition-title">Summary</p>
<p>The cross-correlation function (CCF) is a statistical tool used in time series forecasting to measure the correlation between two time series at different lags. It is used to study the relationship between two time series, and can help to identify lead-lag relationships and causal effects.</p>
<p>This function will implement the <a href="https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.ccf.html"><code>ccf()</code></a> function from the <a href="https://www.statsmodels.org"><code>statsmodels</code></a> library.</p>
</div>
<details class="abstract" open="open">
<summary>Details</summary>
<p>If <code>adjusted</code> is <code>True</code>, the denominator for the autocovariance is adjusted.</p>
<p>The CCF measures the correlation between two time series at different lags. It is calculated as the ratio of the covariance between the two series at lag <span class="arithmatex">\(k\)</span> to the product of their standard deviations. The CCF is typically plotted as a graph, with the lag on the <code>x</code>-axis and the correlation coefficient on the <code>y</code>-axis.</p>
<p>If the CCF shows a strong positive correlation at lag <span class="arithmatex">\(k\)</span>, this means that changes in one time series at time <span class="arithmatex">\(t\)</span> are strongly related to changes in the other time series at time <span class="arithmatex">\(t-k\)</span>. This suggests a lead-lag relationship between the two time series, where changes in one series lead changes in the other series by a certain number of periods. The CCF can be used to estimate the time lag between the two time series.</p>
<p>The CCF can also help to identify causal relationships between two time series. If the CCF shows a strong positive correlation at lag <span class="arithmatex">\(k\)</span>, and the lag is consistent with a causal relationship between the two time series, this suggests that changes in one time series are causing changes in the other time series.</p>
<p>Overall, the cross-correlation function is a valuable tool in time series forecasting, as it helps to study the relationship between two time series and to identify lead-lag relationships and causal effects. By identifying the relationship between two time series, the CCF can help to improve the accuracy of time series forecasting models.</p>
<p>The CCF can be calculated using the <code>ccf()</code> function in the <code>statsmodels</code> package in Python. The function takes two time series arrays as input and returns an array of cross-correlation coefficients at different lags. The significance of the cross-correlation coefficients can be tested using a similar test to the Ljung-Box test, such as the Box-Pierce test or the Breusch-Godfrey test. These tests can be performed using the <code>boxpierce()</code> and <code>lm()</code> functions in the <code>statsmodels</code> package, respectively. If the p-value of the test is less than a certain significance level (e.g. <span class="arithmatex">\(0.05\)</span>), then there is evidence of significant cross-correlation between the two time series at the specified lag.</p>
</details>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="numpy.typing.ArrayLike">ArrayLike</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The time series data to use in the calculation.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y</code>
            </td>
            <td>
                  <code><span title="numpy.typing.ArrayLike">ArrayLike</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The time series data to use in the calculation.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>adjusted</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, then denominators for cross-correlation is <span class="arithmatex">\(n-k\)</span>, otherwise <span class="arithmatex">\(n\)</span>.<br>
Defaults to <code>True</code>.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fft</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, use FFT convolution. This method should be preferred for long time series.<br>
Defaults to <code>True</code>.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>nlags</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of lags to return cross-correlations for. If not provided, the number of lags equals len(x).
Defaults to <code>None</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>alpha</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If a number is given, the confidence intervals for the given level are returned. For instance if <code>alpha=.05</code>, 95% confidence intervals are returned where the standard deviation is computed according to <code>1/sqrt(len(x))</code>.
Defaults to <code>None</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>], <span title="tuple">tuple</span>[<span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>], <span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Depending on <code>alpha</code>, returns the following values:
- <code>ccf</code> (NDArray[np.float64]): The cross-correlation function of <code>x</code> and <code>y</code> for lags <code>0, 1, ..., nlags</code>.
- <code>confint</code> (NDArray[np.float64], optional): Confidence intervals for the CCF (returned if <code>alpha</code> is not <code>None</code>).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <details class="example" open="open">
<summary>Examples</summary>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Setup</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ts_stat_tests.algorithms.correlation</span><span class="w"> </span><span class="kn">import</span> <span class="n">ccf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ts_stat_tests.utils.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">data_airline</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">data_airline</span><span class="o">.</span><span class="n">values</span>
</code></pre></div></td></tr></table></div>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 1: Basic CCF</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">ccf</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">data</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">adjusted</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>
<span class="go">[1.         0.95467704 0.88790688 0.82384458 0.774129  ]</span>
</code></pre></div></td></tr></table></div>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 2: CCF with confidence intervals</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">res_ccf</span><span class="p">,</span> <span class="n">res_conf</span> <span class="o">=</span> <span class="n">ccf</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">data</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">res_ccf</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>
<span class="go">[1.         0.95467704 0.88790688 0.82384458 0.774129  ]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">res_conf</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>
<span class="go">[[0.83666967 1.16333033]</span>
<span class="go"> [0.79134671 1.11800737]</span>
<span class="go"> [0.72457654 1.05123721]</span>
<span class="go"> [0.66051425 0.98717492]</span>
<span class="go"> [0.61079867 0.93745933]]</span>
</code></pre></div></td></tr></table></div>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 3: CCF without adjustment</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">res_ccf_no_adj</span> <span class="o">=</span> <span class="n">ccf</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">data</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">adjusted</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">res_ccf_no_adj</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>
<span class="go">[1.         0.94804734 0.87557484 0.80668116 0.75262542]</span>
</code></pre></div></td></tr></table></div>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 4: CCF without FFT</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">res_ccf_no_fft</span> <span class="o">=</span> <span class="n">ccf</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">data</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">fft</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">res_ccf_no_fft</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>
<span class="go">[1.         0.95467704 0.88790688 0.82384458 0.774129  ]</span>
</code></pre></div></td></tr></table></div>
</details>
<details class="equation">
<summary>Calculation</summary>
<p>The CCF at lag <span class="arithmatex">\(k\)</span> is defined as:</p>
<div class="arithmatex">\[
CCF(k) = \text{Corr}(X_t, Y_{t-k})
\]</div>
<p>where:</p>
<ul>
<li><span class="arithmatex">\(X_t\)</span> and <span class="arithmatex">\(Y_{t-k}\)</span> are the values of the two time series at time <span class="arithmatex">\(t\)</span> and time <span class="arithmatex">\(t-k\)</span>, respectively.</li>
<li><span class="arithmatex">\(\text{Corr}()\)</span> denotes the correlation coefficient between two variables.</li>
</ul>
</details>
<details class="success">
<summary>Credit</summary>
<ul>
<li>All credit goes to the <a href="https://www.statsmodels.org/"><code>statsmodels</code></a> library.</li>
</ul>
</details>
<details class="tip">
<summary>See Also</summary>
<ul>
<li><a href="https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.acf.html"><code>statsmodels.tsa.stattools.acf</code></a>: Estimate the autocorrelation function.</li>
<li><a href="https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.pacf.html"><code>statsmodels.tsa.stattools.pacf</code></a>: Partial autocorrelation estimation.</li>
<li><a href="https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.ccf.html"><code>statsmodels.tsa.stattools.ccf</code></a>: The cross-correlation function.</li>
<li><a class="autorefs autorefs-internal" title="            acf" href="#ts_stat_tests.algorithms.correlation.acf"><code>ts_stat_tests.algorithms.correlation.acf</code></a>: Estimate the autocorrelation function</li>
<li><a class="autorefs autorefs-internal" title="            pacf" href="#ts_stat_tests.algorithms.correlation.pacf"><code>ts_stat_tests.algorithms.correlation.pacf</code></a>: Partial autocorrelation estimate.</li>
<li><a class="autorefs autorefs-internal" title="            ccf" href="#ts_stat_tests.algorithms.correlation.ccf"><code>ts_stat_tests.algorithms.correlation.ccf</code></a>: The cross-correlation function.</li>
</ul>
</details>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/ts_stat_tests/algorithms/correlation.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@typechecked</span>
<span class="k">def</span><span class="w"> </span><span class="nf">ccf</span><span class="p">(</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
    <span class="n">adjusted</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">fft</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">nlags</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">alpha</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]]]:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    !!! note &quot;Summary&quot;</span>

<span class="sd">        The cross-correlation function (CCF) is a statistical tool used in time series forecasting to measure the correlation between two time series at different lags. It is used to study the relationship between two time series, and can help to identify lead-lag relationships and causal effects.</span>

<span class="sd">        This function will implement the [`ccf()`](https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.ccf.html) function from the [`statsmodels`](https://www.statsmodels.org) library.</span>

<span class="sd">    ???+ abstract &quot;Details&quot;</span>

<span class="sd">        If `adjusted` is `True`, the denominator for the autocovariance is adjusted.</span>

<span class="sd">        The CCF measures the correlation between two time series at different lags. It is calculated as the ratio of the covariance between the two series at lag $k$ to the product of their standard deviations. The CCF is typically plotted as a graph, with the lag on the `x`-axis and the correlation coefficient on the `y`-axis.</span>

<span class="sd">        If the CCF shows a strong positive correlation at lag $k$, this means that changes in one time series at time $t$ are strongly related to changes in the other time series at time $t-k$. This suggests a lead-lag relationship between the two time series, where changes in one series lead changes in the other series by a certain number of periods. The CCF can be used to estimate the time lag between the two time series.</span>

<span class="sd">        The CCF can also help to identify causal relationships between two time series. If the CCF shows a strong positive correlation at lag $k$, and the lag is consistent with a causal relationship between the two time series, this suggests that changes in one time series are causing changes in the other time series.</span>

<span class="sd">        Overall, the cross-correlation function is a valuable tool in time series forecasting, as it helps to study the relationship between two time series and to identify lead-lag relationships and causal effects. By identifying the relationship between two time series, the CCF can help to improve the accuracy of time series forecasting models.</span>

<span class="sd">        The CCF can be calculated using the `ccf()` function in the `statsmodels` package in Python. The function takes two time series arrays as input and returns an array of cross-correlation coefficients at different lags. The significance of the cross-correlation coefficients can be tested using a similar test to the Ljung-Box test, such as the Box-Pierce test or the Breusch-Godfrey test. These tests can be performed using the `boxpierce()` and `lm()` functions in the `statsmodels` package, respectively. If the p-value of the test is less than a certain significance level (e.g. $0.05$), then there is evidence of significant cross-correlation between the two time series at the specified lag.</span>

<span class="sd">    Params:</span>
<span class="sd">        x (ArrayLike):</span>
<span class="sd">            The time series data to use in the calculation.</span>
<span class="sd">        y (ArrayLike):</span>
<span class="sd">            The time series data to use in the calculation.</span>
<span class="sd">        adjusted (bool, optional):</span>
<span class="sd">            If `True`, then denominators for cross-correlation is $n-k$, otherwise $n$.&lt;br&gt;</span>
<span class="sd">            Defaults to `True`.</span>
<span class="sd">        fft (bool, optional):</span>
<span class="sd">            If `True`, use FFT convolution. This method should be preferred for long time series.&lt;br&gt;</span>
<span class="sd">            Defaults to `True`.</span>
<span class="sd">        nlags (Optional[int], optional):</span>
<span class="sd">            Number of lags to return cross-correlations for. If not provided, the number of lags equals len(x).</span>
<span class="sd">            Defaults to `None`.</span>
<span class="sd">        alpha (Optional[float], optional):</span>
<span class="sd">            If a number is given, the confidence intervals for the given level are returned. For instance if `alpha=.05`, 95% confidence intervals are returned where the standard deviation is computed according to `1/sqrt(len(x))`.</span>
<span class="sd">            Defaults to `None`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (Union[NDArray[np.float64], tuple[NDArray[np.float64], NDArray[np.float64]]]):</span>
<span class="sd">            Depending on `alpha`, returns the following values:</span>
<span class="sd">            - `ccf` (NDArray[np.float64]): The cross-correlation function of `x` and `y` for lags `0, 1, ..., nlags`.</span>
<span class="sd">            - `confint` (NDArray[np.float64], optional): Confidence intervals for the CCF (returned if `alpha` is not `None`).</span>

<span class="sd">    ???+ example &quot;Examples&quot;</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Setup&quot;}</span>
<span class="sd">        &gt;&gt;&gt; from ts_stat_tests.algorithms.correlation import ccf</span>
<span class="sd">        &gt;&gt;&gt; from ts_stat_tests.utils.data import data_airline</span>
<span class="sd">        &gt;&gt;&gt; data = data_airline.values</span>

<span class="sd">        ```</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Example 1: Basic CCF&quot;}</span>
<span class="sd">        &gt;&gt;&gt; res = ccf(data, data + 1, adjusted=True)</span>
<span class="sd">        &gt;&gt;&gt; print(res[:5])</span>
<span class="sd">        [1.         0.95467704 0.88790688 0.82384458 0.774129  ]</span>

<span class="sd">        ```</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Example 2: CCF with confidence intervals&quot;}</span>
<span class="sd">        &gt;&gt;&gt; res_ccf, res_conf = ccf(data, data + 1, alpha=0.05)</span>
<span class="sd">        &gt;&gt;&gt; print(res_ccf[:5])</span>
<span class="sd">        [1.         0.95467704 0.88790688 0.82384458 0.774129  ]</span>
<span class="sd">        &gt;&gt;&gt; print(res_conf[:5])</span>
<span class="sd">        [[0.83666967 1.16333033]</span>
<span class="sd">         [0.79134671 1.11800737]</span>
<span class="sd">         [0.72457654 1.05123721]</span>
<span class="sd">         [0.66051425 0.98717492]</span>
<span class="sd">         [0.61079867 0.93745933]]</span>

<span class="sd">        ```</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Example 3: CCF without adjustment&quot;}</span>
<span class="sd">        &gt;&gt;&gt; res_ccf_no_adj = ccf(data, data + 1, adjusted=False)</span>
<span class="sd">        &gt;&gt;&gt; print(res_ccf_no_adj[:5])</span>
<span class="sd">        [1.         0.94804734 0.87557484 0.80668116 0.75262542]</span>

<span class="sd">        ```</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Example 4: CCF without FFT&quot;}</span>
<span class="sd">        &gt;&gt;&gt; res_ccf_no_fft = ccf(data, data + 1, fft=False)</span>
<span class="sd">        &gt;&gt;&gt; print(res_ccf_no_fft[:5])</span>
<span class="sd">        [1.         0.95467704 0.88790688 0.82384458 0.774129  ]</span>

<span class="sd">        ```</span>

<span class="sd">    ??? equation &quot;Calculation&quot;</span>

<span class="sd">        The CCF at lag $k$ is defined as:</span>

<span class="sd">        $$</span>
<span class="sd">        CCF(k) = \text{Corr}(X_t, Y_{t-k})</span>
<span class="sd">        $$</span>

<span class="sd">        where:</span>

<span class="sd">        - $X_t$ and $Y_{t-k}$ are the values of the two time series at time $t$ and time $t-k$, respectively.</span>
<span class="sd">        - $\text{Corr}()$ denotes the correlation coefficient between two variables.</span>

<span class="sd">    ??? success &quot;Credit&quot;</span>
<span class="sd">        - All credit goes to the [`statsmodels`](https://www.statsmodels.org/) library.</span>

<span class="sd">    ??? tip &quot;See Also&quot;</span>
<span class="sd">        - [`statsmodels.tsa.stattools.acf`](https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.acf.html): Estimate the autocorrelation function.</span>
<span class="sd">        - [`statsmodels.tsa.stattools.pacf`](https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.pacf.html): Partial autocorrelation estimation.</span>
<span class="sd">        - [`statsmodels.tsa.stattools.ccf`](https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.ccf.html): The cross-correlation function.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.correlation.acf`][ts_stat_tests.algorithms.correlation.acf]: Estimate the autocorrelation function</span>
<span class="sd">        - [`ts_stat_tests.algorithms.correlation.pacf`][ts_stat_tests.algorithms.correlation.pacf]: Partial autocorrelation estimate.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.correlation.ccf`][ts_stat_tests.algorithms.correlation.ccf]: The cross-correlation function.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">st_ccf</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
        <span class="n">adjusted</span><span class="o">=</span><span class="n">adjusted</span><span class="p">,</span>
        <span class="n">fft</span><span class="o">=</span><span class="n">fft</span><span class="p">,</span>
        <span class="n">nlags</span><span class="o">=</span><span class="n">nlags</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="ts_stat_tests.algorithms.correlation.lb" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">lb</span>


<a href="#ts_stat_tests.algorithms.correlation.lb" class="headerlink" title="Permanent link">ðŸ”—</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">lb</span><span class="p">(</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
    <span class="n">lags</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">ArrayLike</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">boxpierce</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">model_df</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">period</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">return_df</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">auto_lag</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <div class="admonition note">
<p class="admonition-title">Summary</p>
<p>The Ljung-Box test is a statistical test used in time series forecasting to test for the presence of autocorrelation in the residuals of a model. The test is based on the autocorrelation function (ACF) of the residuals, and can be used to assess the adequacy of a time series model and to identify areas for improvement.</p>
<p>This function will implement the <a href="https://www.statsmodels.org/stable/generated/statsmodels.stats.diagnostic.acorr_ljungbox.html"><code>acorr_ljungbox()</code></a> function from the <a href="https://www.statsmodels.org"><code>statsmodels</code></a> library.</p>
</div>
<details class="abstract" open="open">
<summary>Details</summary>
<p>The Ljung-Box and Box-Pierce statistics differ in how they scale the autocorrelation function; the Ljung-Box test has better finite-sample properties.</p>
<p>Under the null hypothesis, the test statistic follows a chi-squared distribution with degrees of freedom equal to <span class="arithmatex">\(m-p\)</span>, where <span class="arithmatex">\(p\)</span> is the number of parameters estimated in fitting the time series model.</p>
<p>The Ljung-Box test is performed by calculating the autocorrelation function (ACF) of the residuals from a time series model, and then comparing the ACF values to the expected values under the null hypothesis of no autocorrelation. The test statistic is calculated as the sum of the squared autocorrelations up to a given lag, and is compared to a chi-squared distribution with degrees of freedom equal to the number of lags tested.</p>
<p>If the test statistic is greater than the critical value from the chi-squared distribution, then the null hypothesis of no autocorrelation is rejected, indicating that there is evidence of autocorrelation in the residuals. This suggests that the time series model is inadequate, and that additional terms may need to be added to the model to account for the remaining autocorrelation.</p>
<p>If the test statistic is less than the critical value from the chi-squared distribution, then the null hypothesis of no autocorrelation is not rejected, indicating that there is no evidence of autocorrelation in the residuals. This suggests that the time series model is adequate, and that no further improvements are needed.</p>
<p>Overall, the Ljung-Box test is a valuable tool in time series forecasting, as it helps to assess the adequacy of a time series model and to identify areas for improvement. By testing for autocorrelation in the residuals, the test helps to ensure that the model is accurately capturing the underlying patterns in the time series data.</p>
<p>The Ljung-Box test can be calculated using the <code>acorr_ljungbox()</code> function in the <code>statsmodels</code> package in Python. The function takes a time series array and the maximum lag <span class="arithmatex">\(m\)</span> as input, and returns an array of <span class="arithmatex">\(Q\)</span>-statistics and associated p-values for each lag up to <span class="arithmatex">\(m\)</span>. If the p-value of the test is less than a certain significance level (e.g. <span class="arithmatex">\(0.05\)</span>), then there is evidence of significant autocorrelation in the time series up to the specified lag.</p>
</details>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="numpy.typing.ArrayLike">ArrayLike</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The data series. The data is demeaned before the test statistic is computed.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>lags</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="int">int</span>, <span title="numpy.typing.ArrayLike">ArrayLike</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If lags is an integer (<code>int</code>) then this is taken to be the largest lag that is included, the test result is reported for all smaller lag length. If lags is a list or array, then all lags are included up to the largest lag in the list, however only the tests for the lags in the list are reported. If lags is <code>None</code>, then the default maxlag is currently <span class="arithmatex">\(\min(\lfloor \frac{n_{obs}}{2} \rfloor - 2, 40)\)</span> (calculated with: <code>min(nobs // 2 - 2, 40)</code>). The default number of <code>lags</code> changes if <code>period</code> is set.</p>
<div class="admonition deprecation">
<p class="admonition-title">Deprecation</p>
<p>After <code>statsmodels</code> version <code>0.12</code>, this calculation will change from</p>
<div class="arithmatex">\[
\min\left(\lfloor \frac{n_{obs}}{2} \rfloor - 2, 40\right)
\]</div>
<p>to</p>
<div class="arithmatex">\[
\min\left(10, \frac{n_{obs}}{5}\right)
\]</div>
</div>
<p>Defaults to <code>None</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>boxpierce</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, then additional to the results of the Ljung-Box test also the Box-Pierce test results are returned.<br>
Defaults to <code>False</code>.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>model_df</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of degrees of freedom consumed by the model. In an ARMA model, this value is usually <span class="arithmatex">\(p+q\)</span> where <span class="arithmatex">\(p\)</span> is the AR order and <span class="arithmatex">\(q\)</span> is the MA order. This value is subtracted from the degrees-of-freedom used in the test so that the adjusted dof for the statistics are <span class="arithmatex">\(lags - model_df\)</span>. If <span class="arithmatex">\(lags - model_df \le 0\)</span>, then <code>NaN</code> is returned.<br>
Defaults to <code>0</code>.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>period</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The period of a Seasonal time series. Used to compute the max lag for seasonal data which uses <span class="arithmatex">\(\min(2 \times period, \lfloor \frac{n_{obs}}{5} \rfloor)\)</span> (calculated with: <code>min(2*period,nobs//5)</code>) if set. If <code>None</code>, then the default rule is used to set the number of lags. When set, must be <span class="arithmatex">\(\ge 2\)</span>.<br>
Defaults to <code>None</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>return_df</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Flag indicating whether to return the result as a single DataFrame with columns <code>lb_stat</code>, <code>lb_pvalue</code>, and optionally <code>bp_stat</code> and <code>bp_pvalue</code>. Set to <code>True</code> to return the DataFrame or <code>False</code> to continue returning the <span class="arithmatex">\(2-4\)</span> output. If <code>None</code> (the default), a warning is raised.</p>
<div class="admonition deprecation">
<p class="admonition-title">Deprecation</p>
<p>After <code>statsmodels</code> version <code>0.12</code>, this will become the only return method.</p>
</div>
<p>Defaults to <code>True</code>.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>auto_lag</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Flag indicating whether to automatically determine the optimal lag length based on threshold of maximum correlation value.<br>
Defaults to <code>False</code>.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="pandas.DataFrame">DataFrame</span>, <span title="tuple">tuple</span>[<span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>], <span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>]], <span title="tuple">tuple</span>[<span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>], <span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>], <span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>], <span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Depending on <code>return_df</code> and <code>boxpierce</code>, returns the following values:
- <code>lb_stat</code> (NDArray[np.float64]): The Ljung-Box test statistic.
- <code>lb_pvalue</code> (NDArray[np.float64]): The p-value for the Ljung-Box test.
- <code>bp_stat</code> (NDArray[np.float64], optional): The Box-Pierce test statistic (returned if <code>boxpierce</code> is <code>True</code>).
- <code>bp_pvalue</code> (NDArray[np.float64], optional): The p-value for the Box-Pierce test (returned if <code>boxpierce</code> is <code>True</code>).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <details class="example" open="open">
<summary>Examples</summary>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Setup</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels</span><span class="w"> </span><span class="kn">import</span> <span class="n">api</span> <span class="k">as</span> <span class="n">sm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ts_stat_tests.algorithms.correlation</span><span class="w"> </span><span class="kn">import</span> <span class="n">lb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ts_stat_tests.utils.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">data_airline</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">data_airline</span><span class="o">.</span><span class="n">values</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">ARIMA</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 1: Ljung-Box test on ARIMA residuals</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">lb</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="n">return_df</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
<span class="go">      lb_stat  lb_pvalue</span>
<span class="go">10  13.844361    0.18021</span>
</code></pre></div></td></tr></table></div>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 2: Ljung-Box and Box-Pierce tests with multiple lags</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">lb</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span> <span class="n">boxpierce</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_df</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
<span class="go">      lb_stat     lb_pvalue    bp_stat     bp_pvalue</span>
<span class="go">5    6.274986  2.803736e-01   6.019794  3.042976e-01</span>
<span class="go">10  13.844361  1.802099e-01  13.080554  2.192028e-01</span>
<span class="go">15  86.182531  5.083111e-12  78.463124  1.332482e-10</span>
</code></pre></div></td></tr></table></div>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 3: Ljung-Box test with specific lag</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">lb</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="n">return_df</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
<span class="go">    lb_stat  lb_pvalue</span>
<span class="go">5  6.274986   0.280374</span>
</code></pre></div></td></tr></table></div>
</details>
<details class="equation">
<summary>Calculation</summary>
<p>The Ljung-Box test statistic is calculated as:</p>
<div class="arithmatex">\[
Q(m) = n(n+2) \sum_{k=1}^m \frac{r_k^2}{n-k}
\]</div>
<p>where:</p>
<ul>
<li><span class="arithmatex">\(n\)</span> is the sample size,</li>
<li><span class="arithmatex">\(m\)</span> is the maximum lag being tested,</li>
<li><span class="arithmatex">\(r_k\)</span> is the sample autocorrelation at lag <span class="arithmatex">\(k\)</span>, and</li>
<li><span class="arithmatex">\(\sum\)</span> denotes the sum over <span class="arithmatex">\(k\)</span> from <span class="arithmatex">\(1\)</span> to <span class="arithmatex">\(m\)</span>.</li>
</ul>
</details>
<details class="success">
<summary>Credit</summary>
<ul>
<li>All credit goes to the <a href="https://www.statsmodels.org/"><code>statsmodels</code></a> library.</li>
</ul>
</details>
<details class="question">
<summary>References</summary>
<ol>
<li>Green, W. "Econometric Analysis," 5th ed., Pearson, 2003.</li>
<li>J. Carlos Escanciano, Ignacio N. Lobato "An automatic Portmanteau test for serial correlation"., Volume 151, 2009.</li>
</ol>
</details>
<details class="tip">
<summary>See Also</summary>
<ul>
<li><a href="https://www.statsmodels.org/stable/generated/statsmodels.regression.linear_model.OLS.fit.html"><code>statsmodels.regression.linear_model.OLS.fit</code></a>: Fit a linear model.</li>
<li><a href="https://www.statsmodels.org/stable/generated/statsmodels.regression.linear_model.RegressionResults.html"><code>statsmodels.regression.linear_model.RegressionResults</code></a>: The output results of a linear regression model.</li>
<li><a href="https://www.statsmodels.org/stable/generated/statsmodels.stats.diagnostic.acorr_ljungbox.html"><code>statsmodels.stats.diagnostic.acorr_ljungbox</code></a>: Ljung-Box test for serial correlation.</li>
<li><a href="https://www.statsmodels.org/stable/generated/statsmodels.stats.diagnostic.acorr_lm.html"><code>statsmodels.stats.diagnostic.acorr_lm</code></a>: Lagrange Multiplier tests for autocorrelation.</li>
<li><a href="https://www.statsmodels.org/stable/generated/statsmodels.stats.diagnostic.acorr_breusch_godfrey.html"><code>statsmodels.stats.diagnostic.acorr_breusch_godfrey</code></a>: Breusch-Godfrey test for serial correlation.</li>
<li><a class="autorefs autorefs-internal" title="            lb" href="#ts_stat_tests.algorithms.correlation.lb"><code>ts_stat_tests.algorithms.correlation.lb</code></a>: Ljung-Box test of autocorrelation in residuals.</li>
<li><a class="autorefs autorefs-internal" title="            lm" href="#ts_stat_tests.algorithms.correlation.lm"><code>ts_stat_tests.algorithms.correlation.lm</code></a>: Lagrange Multiplier tests for autocorrelation.</li>
<li><a class="autorefs autorefs-internal" title="            bglm" href="#ts_stat_tests.algorithms.correlation.bglm"><code>ts_stat_tests.algorithms.correlation.bglm</code></a>: Breusch-Godfrey Lagrange Multiplier tests for residual autocorrelation.</li>
</ul>
</details>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/ts_stat_tests/algorithms/correlation.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@typechecked</span>
<span class="k">def</span><span class="w"> </span><span class="nf">lb</span><span class="p">(</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
    <span class="n">lags</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">ArrayLike</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">boxpierce</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">model_df</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">period</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">return_df</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">auto_lag</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    !!! note &quot;Summary&quot;</span>

<span class="sd">        The Ljung-Box test is a statistical test used in time series forecasting to test for the presence of autocorrelation in the residuals of a model. The test is based on the autocorrelation function (ACF) of the residuals, and can be used to assess the adequacy of a time series model and to identify areas for improvement.</span>

<span class="sd">        This function will implement the [`acorr_ljungbox()`](https://www.statsmodels.org/stable/generated/statsmodels.stats.diagnostic.acorr_ljungbox.html) function from the [`statsmodels`](https://www.statsmodels.org) library.</span>

<span class="sd">    ???+ abstract &quot;Details&quot;</span>

<span class="sd">        The Ljung-Box and Box-Pierce statistics differ in how they scale the autocorrelation function; the Ljung-Box test has better finite-sample properties.</span>

<span class="sd">        Under the null hypothesis, the test statistic follows a chi-squared distribution with degrees of freedom equal to $m-p$, where $p$ is the number of parameters estimated in fitting the time series model.</span>

<span class="sd">        The Ljung-Box test is performed by calculating the autocorrelation function (ACF) of the residuals from a time series model, and then comparing the ACF values to the expected values under the null hypothesis of no autocorrelation. The test statistic is calculated as the sum of the squared autocorrelations up to a given lag, and is compared to a chi-squared distribution with degrees of freedom equal to the number of lags tested.</span>

<span class="sd">        If the test statistic is greater than the critical value from the chi-squared distribution, then the null hypothesis of no autocorrelation is rejected, indicating that there is evidence of autocorrelation in the residuals. This suggests that the time series model is inadequate, and that additional terms may need to be added to the model to account for the remaining autocorrelation.</span>

<span class="sd">        If the test statistic is less than the critical value from the chi-squared distribution, then the null hypothesis of no autocorrelation is not rejected, indicating that there is no evidence of autocorrelation in the residuals. This suggests that the time series model is adequate, and that no further improvements are needed.</span>

<span class="sd">        Overall, the Ljung-Box test is a valuable tool in time series forecasting, as it helps to assess the adequacy of a time series model and to identify areas for improvement. By testing for autocorrelation in the residuals, the test helps to ensure that the model is accurately capturing the underlying patterns in the time series data.</span>

<span class="sd">        The Ljung-Box test can be calculated using the `acorr_ljungbox()` function in the `statsmodels` package in Python. The function takes a time series array and the maximum lag $m$ as input, and returns an array of $Q$-statistics and associated p-values for each lag up to $m$. If the p-value of the test is less than a certain significance level (e.g. $0.05$), then there is evidence of significant autocorrelation in the time series up to the specified lag.</span>

<span class="sd">    Params:</span>
<span class="sd">        x (ArrayLike):</span>
<span class="sd">            The data series. The data is demeaned before the test statistic is computed.</span>
<span class="sd">        lags (Optional[Union[int, ArrayLike]], optional):</span>
<span class="sd">            If lags is an integer (`int`) then this is taken to be the largest lag that is included, the test result is reported for all smaller lag length. If lags is a list or array, then all lags are included up to the largest lag in the list, however only the tests for the lags in the list are reported. If lags is `None`, then the default maxlag is currently $\min(\lfloor \frac{n_{obs}}{2} \rfloor - 2, 40)$ (calculated with: `min(nobs // 2 - 2, 40)`). The default number of `lags` changes if `period` is set.</span>
<span class="sd">            !!! deprecation &quot;Deprecation&quot;</span>
<span class="sd">                After `statsmodels` version `0.12`, this calculation will change from</span>

<span class="sd">                $$</span>
<span class="sd">                \min\left(\lfloor \frac{n_{obs}}{2} \rfloor - 2, 40\right)</span>
<span class="sd">                $$</span>

<span class="sd">                to</span>

<span class="sd">                $$</span>
<span class="sd">                \min\left(10, \frac{n_{obs}}{5}\right)</span>
<span class="sd">                $$</span>

<span class="sd">            Defaults to `None`.</span>
<span class="sd">        boxpierce (bool, optional):</span>
<span class="sd">            If `True`, then additional to the results of the Ljung-Box test also the Box-Pierce test results are returned.&lt;br&gt;</span>
<span class="sd">            Defaults to `False`.</span>
<span class="sd">        model_df (int, optional):</span>
<span class="sd">            Number of degrees of freedom consumed by the model. In an ARMA model, this value is usually $p+q$ where $p$ is the AR order and $q$ is the MA order. This value is subtracted from the degrees-of-freedom used in the test so that the adjusted dof for the statistics are $lags - model_df$. If $lags - model_df \le 0$, then `NaN` is returned.&lt;br&gt;</span>
<span class="sd">            Defaults to `0`.</span>
<span class="sd">        period (Optional[int], optional):</span>
<span class="sd">            The period of a Seasonal time series. Used to compute the max lag for seasonal data which uses $\min(2 \times period, \lfloor \frac{n_{obs}}{5} \rfloor)$ (calculated with: `min(2*period,nobs//5)`) if set. If `None`, then the default rule is used to set the number of lags. When set, must be $\ge 2$.&lt;br&gt;</span>
<span class="sd">            Defaults to `None`.</span>
<span class="sd">        return_df (bool, optional):</span>
<span class="sd">            Flag indicating whether to return the result as a single DataFrame with columns `lb_stat`, `lb_pvalue`, and optionally `bp_stat` and `bp_pvalue`. Set to `True` to return the DataFrame or `False` to continue returning the $2-4$ output. If `None` (the default), a warning is raised.</span>

<span class="sd">            !!! deprecation &quot;Deprecation&quot;</span>
<span class="sd">                After `statsmodels` version `0.12`, this will become the only return method.</span>

<span class="sd">            Defaults to `True`.</span>
<span class="sd">        auto_lag (bool, optional):</span>
<span class="sd">            Flag indicating whether to automatically determine the optimal lag length based on threshold of maximum correlation value.&lt;br&gt;</span>
<span class="sd">            Defaults to `False`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (Union[pd.DataFrame, tuple[NDArray[np.float64], NDArray[np.float64]], tuple[NDArray[np.float64], NDArray[np.float64], NDArray[np.float64], NDArray[np.float64]]]):</span>
<span class="sd">            Depending on `return_df` and `boxpierce`, returns the following values:</span>
<span class="sd">            - `lb_stat` (NDArray[np.float64]): The Ljung-Box test statistic.</span>
<span class="sd">            - `lb_pvalue` (NDArray[np.float64]): The p-value for the Ljung-Box test.</span>
<span class="sd">            - `bp_stat` (NDArray[np.float64], optional): The Box-Pierce test statistic (returned if `boxpierce` is `True`).</span>
<span class="sd">            - `bp_pvalue` (NDArray[np.float64], optional): The p-value for the Box-Pierce test (returned if `boxpierce` is `True`).</span>

<span class="sd">    ???+ example &quot;Examples&quot;</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Setup&quot;}</span>
<span class="sd">        &gt;&gt;&gt; from statsmodels import api as sm</span>
<span class="sd">        &gt;&gt;&gt; from ts_stat_tests.algorithms.correlation import lb</span>
<span class="sd">        &gt;&gt;&gt; from ts_stat_tests.utils.data import data_airline</span>
<span class="sd">        &gt;&gt;&gt; data = data_airline.values</span>
<span class="sd">        &gt;&gt;&gt; res = sm.tsa.ARIMA(data, order=(1, 0, 1)).fit()</span>

<span class="sd">        ```</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Example 1: Ljung-Box test on ARIMA residuals&quot;}</span>
<span class="sd">        &gt;&gt;&gt; results = lb(res.resid, lags=[10], return_df=True)</span>
<span class="sd">        &gt;&gt;&gt; print(results)</span>
<span class="sd">              lb_stat  lb_pvalue</span>
<span class="sd">        10  13.844361    0.18021</span>

<span class="sd">        ```</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Example 2: Ljung-Box and Box-Pierce tests with multiple lags&quot;}</span>
<span class="sd">        &gt;&gt;&gt; results = lb(res.resid, lags=[5, 10, 15], boxpierce=True, return_df=True)</span>
<span class="sd">        &gt;&gt;&gt; print(results)</span>
<span class="sd">              lb_stat     lb_pvalue    bp_stat     bp_pvalue</span>
<span class="sd">        5    6.274986  2.803736e-01   6.019794  3.042976e-01</span>
<span class="sd">        10  13.844361  1.802099e-01  13.080554  2.192028e-01</span>
<span class="sd">        15  86.182531  5.083111e-12  78.463124  1.332482e-10</span>

<span class="sd">        ```</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Example 3: Ljung-Box test with specific lag&quot;}</span>
<span class="sd">        &gt;&gt;&gt; results = lb(res.resid, lags=[5], return_df=True)</span>
<span class="sd">        &gt;&gt;&gt; print(results)</span>
<span class="sd">            lb_stat  lb_pvalue</span>
<span class="sd">        5  6.274986   0.280374</span>

<span class="sd">        ```</span>

<span class="sd">    ??? equation &quot;Calculation&quot;</span>

<span class="sd">        The Ljung-Box test statistic is calculated as:</span>

<span class="sd">        $$</span>
<span class="sd">        Q(m) = n(n+2) \sum_{k=1}^m \frac{r_k^2}{n-k}</span>
<span class="sd">        $$</span>

<span class="sd">        where:</span>

<span class="sd">        - $n$ is the sample size,</span>
<span class="sd">        - $m$ is the maximum lag being tested,</span>
<span class="sd">        - $r_k$ is the sample autocorrelation at lag $k$, and</span>
<span class="sd">        - $\sum$ denotes the sum over $k$ from $1$ to $m$.</span>

<span class="sd">    ??? success &quot;Credit&quot;</span>
<span class="sd">        - All credit goes to the [`statsmodels`](https://www.statsmodels.org/) library.</span>

<span class="sd">    ??? question &quot;References&quot;</span>
<span class="sd">        1. Green, W. &quot;Econometric Analysis,&quot; 5th ed., Pearson, 2003.</span>
<span class="sd">        2. J. Carlos Escanciano, Ignacio N. Lobato &quot;An automatic Portmanteau test for serial correlation&quot;., Volume 151, 2009.</span>

<span class="sd">    ??? tip &quot;See Also&quot;</span>
<span class="sd">        - [`statsmodels.regression.linear_model.OLS.fit`](https://www.statsmodels.org/stable/generated/statsmodels.regression.linear_model.OLS.fit.html): Fit a linear model.</span>
<span class="sd">        - [`statsmodels.regression.linear_model.RegressionResults`](https://www.statsmodels.org/stable/generated/statsmodels.regression.linear_model.RegressionResults.html): The output results of a linear regression model.</span>
<span class="sd">        - [`statsmodels.stats.diagnostic.acorr_ljungbox`](https://www.statsmodels.org/stable/generated/statsmodels.stats.diagnostic.acorr_ljungbox.html): Ljung-Box test for serial correlation.</span>
<span class="sd">        - [`statsmodels.stats.diagnostic.acorr_lm`](https://www.statsmodels.org/stable/generated/statsmodels.stats.diagnostic.acorr_lm.html): Lagrange Multiplier tests for autocorrelation.</span>
<span class="sd">        - [`statsmodels.stats.diagnostic.acorr_breusch_godfrey`](https://www.statsmodels.org/stable/generated/statsmodels.stats.diagnostic.acorr_breusch_godfrey.html): Breusch-Godfrey test for serial correlation.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.correlation.lb`][ts_stat_tests.algorithms.correlation.lb]: Ljung-Box test of autocorrelation in residuals.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.correlation.lm`][ts_stat_tests.algorithms.correlation.lm]: Lagrange Multiplier tests for autocorrelation.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.correlation.bglm`][ts_stat_tests.algorithms.correlation.bglm]: Breusch-Godfrey Lagrange Multiplier tests for residual autocorrelation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">acorr_ljungbox</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
        <span class="n">lags</span><span class="o">=</span><span class="n">lags</span><span class="p">,</span>
        <span class="n">boxpierce</span><span class="o">=</span><span class="n">boxpierce</span><span class="p">,</span>
        <span class="n">model_df</span><span class="o">=</span><span class="n">model_df</span><span class="p">,</span>
        <span class="n">period</span><span class="o">=</span><span class="n">period</span><span class="p">,</span>
        <span class="n">return_df</span><span class="o">=</span><span class="n">return_df</span><span class="p">,</span>
        <span class="n">auto_lag</span><span class="o">=</span><span class="n">auto_lag</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="ts_stat_tests.algorithms.correlation.lm" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">lm</span>


<a href="#ts_stat_tests.algorithms.correlation.lm" class="headerlink" title="Permanent link">ðŸ”—</a></h4>
          <div class="doc-overloads">
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">lm</span><span class="p">(</span>
    <span class="n">resid</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
    <span class="n">nlags</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">store</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">period</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">ddof</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">cov_type</span><span class="p">:</span> <span class="n">VALID_LM_COV_TYPE_OPTIONS</span> <span class="o">=</span> <span class="s2">&quot;nonrobust&quot;</span><span class="p">,</span>
    <span class="n">cov_kwargs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span>
</code></pre></div><div class="doc-signature highlight"><pre><span></span><code><span class="nf">lm</span><span class="p">(</span>
    <span class="n">resid</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
    <span class="n">nlags</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">store</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="kc">True</span><span class="p">],</span>
    <span class="n">period</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">ddof</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">cov_type</span><span class="p">:</span> <span class="n">VALID_LM_COV_TYPE_OPTIONS</span> <span class="o">=</span> <span class="s2">&quot;nonrobust&quot;</span><span class="p">,</span>
    <span class="n">cov_kwargs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="n">ResultsStore</span><span class="p">]</span>
</code></pre></div>          </div>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">lm</span><span class="p">(</span>
    <span class="n">resid</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
    <span class="n">nlags</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">store</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">period</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">ddof</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">cov_type</span><span class="p">:</span> <span class="n">VALID_LM_COV_TYPE_OPTIONS</span> <span class="o">=</span> <span class="s2">&quot;nonrobust&quot;</span><span class="p">,</span>
    <span class="n">cov_kwargs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span>
    <span class="nb">tuple</span><span class="p">[</span>
        <span class="nb">float</span><span class="p">,</span>
        <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]],</span>
        <span class="nb">float</span><span class="p">,</span>
        <span class="nb">float</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="nb">tuple</span><span class="p">[</span>
        <span class="nb">float</span><span class="p">,</span>
        <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]],</span>
        <span class="nb">float</span><span class="p">,</span>
        <span class="nb">float</span><span class="p">,</span>
        <span class="n">ResultsStore</span><span class="p">,</span>
    <span class="p">],</span>
<span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <div class="admonition note">
<p class="admonition-title">Summary</p>
<p>The Lagrange Multiplier (LM) test is a statistical test used in time series forecasting to test for the presence of autocorrelation in a model. The test is based on the residual sum of squares (RSS) of a time series model, and can be used to assess the adequacy of the model and to identify areas for improvement.</p>
<p>This function implements the <a href="https://www.statsmodels.org/stable/generated/statsmodels.stats.diagnostic.acorr_lm.html"><code>acorr_lm()</code></a> function from the <a href="https://www.statsmodels.org"><code>statsmodels</code></a> library.</p>
</div>
<details class="abstract" open="open">
<summary>Details</summary>
<p>This is a generic Lagrange Multiplier (LM) test for autocorrelation. It returns Engle's ARCH test if <code>resid</code> is the squared residual array. The Breusch-Godfrey test is a variation on this LM test with additional exogenous variables in the auxiliary regression.</p>
<p>The LM test proceeds by:</p>
<ul>
<li>Fitting a time series model to the data and obtaining the residuals.</li>
<li>Running an auxiliary regression of these residuals on their past <code>nlags</code> values (and any relevant exogenous variables).</li>
<li>Computing the LM statistic as <span class="arithmatex">\((n_{obs} - ddof) \times R^2\)</span> from this auxiliary regression.</li>
</ul>
<p>Under the null hypothesis that the autocorrelations up to the specified lag are zero (no serial correlation in the residuals), the LM statistic is asymptotically distributed as a chi-squared random variable with degrees of freedom equal to the number of lagged residual terms included in the auxiliary regression (i.e. the number of lags being tested, adjusted for any restrictions implied by the model).</p>
<p>If the test statistic is greater than the critical value from the chi-squared distribution (or equivalently, if the p-value is less than a chosen significance level such as <span class="arithmatex">\(0.05\)</span>), then the null hypothesis of no autocorrelation is rejected, indicating that there is evidence of autocorrelation in the residuals.</p>
<p>The LM test is a generalization of the Durbin-Watson test, which is a simpler test that only tests for first-order autocorrelation.</p>
</details>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>resid</code>
            </td>
            <td>
                  <code><span title="numpy.typing.ArrayLike">ArrayLike</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time series to test.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>nlags</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Highest lag to use. Defaults to <code>None</code>.</p>
<div class="admonition deprecation">
<p class="admonition-title">Deprecation</p>
<p>The behavior of this parameter will change after <code>statsmodels</code> version <code>0.12</code>.</p>
</div>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>store</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code> then the intermediate results are also returned. Defaults to <code>False</code>.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>period</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The period of a Seasonal time series. Used to compute the max lag for seasonal data which uses <span class="arithmatex">\(\min(2 \times period, \lfloor \frac{n_{obs}}{5} \rfloor)\)</span> (calculated with: <code>min(2*period,nobs//5)</code>) if set. If <code>None</code>, then the default rule is used to set the number of lags. When set, must be <span class="arithmatex">\(\ge 2\)</span>. Defaults to <code>None</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ddof</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of degrees of freedom consumed by the model used to produce <code>resid</code>. Defaults to <code>0</code>.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cov_type</code>
            </td>
            <td>
                  <code><span title="ts_stat_tests.algorithms.correlation.VALID_LM_COV_TYPE_OPTIONS">VALID_LM_COV_TYPE_OPTIONS</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Covariance type. The default is <code>"nonrobust"</code> which uses the classic OLS covariance estimator. Specify one of <code>"HC0"</code>, <code>"HC1"</code>, <code>"HC2"</code>, <code>"HC3"</code> to use White's covariance estimator. All covariance types supported by <code>OLS.fit</code> are accepted. Defaults to <code>"nonrobust"</code>.</p>
              </div>
            </td>
            <td>
                  <code>&#39;nonrobust&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cov_kwargs</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="dict">dict</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of covariance options passed to <code>OLS.fit</code>. See <a href="https://www.statsmodels.org/stable/generated/statsmodels.regression.linear_model.OLS.fit.html"><code>OLS.fit</code></a> for more details. Defaults to <code>None</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="tuple">tuple</span>[<span title="float">float</span>, <span title="typing.Union">Union</span>[<span title="float">float</span>, <span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>]], <span title="float">float</span>, <span title="float">float</span>], <span title="tuple">tuple</span>[<span title="float">float</span>, <span title="typing.Union">Union</span>[<span title="float">float</span>, <span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>]], <span title="float">float</span>, <span title="float">float</span>, <span title="statsmodels.stats.diagnostic.ResultsStore">ResultsStore</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Returns the following values:
- <code>lm</code> (float): Lagrange multiplier test statistic.
- <code>lmpval</code> (Union[float, NDArray[np.float64]]): The p-value for the Lagrange multiplier test.
- <code>fval</code> (float): The f-statistic of the F test.
- <code>fpval</code> (float): The p-value of the F test.
- <code>res_store</code> (ResultsStore, optional): Intermediate results (returned if <code>store</code> is <code>True</code>).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <details class="example" open="open">
<summary>Examples</summary>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Setup</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ts_stat_tests.algorithms.correlation</span><span class="w"> </span><span class="kn">import</span> <span class="n">lm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ts_stat_tests.utils.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">data_airline</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">data_airline</span><span class="o">.</span><span class="n">values</span>
</code></pre></div></td></tr></table></div>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 1: Lagrange Multiplier test</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">res_lm</span><span class="p">,</span> <span class="n">res_p</span><span class="p">,</span> <span class="n">res_f</span><span class="p">,</span> <span class="n">res_fp</span> <span class="o">=</span> <span class="n">lm</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;LM statistic: </span><span class="si">{</span><span class="n">res_lm</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">LM statistic: 128.0966</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;p-value: </span><span class="si">{</span><span class="n">res_p</span><span class="si">:</span><span class="s2">.4e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">p-value: 1.1417e-22</span>
</code></pre></div></td></tr></table></div>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 2: Lagrange Multiplier test with intermediate results</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">res_lm</span><span class="p">,</span> <span class="n">res_p</span><span class="p">,</span> <span class="n">res_f</span><span class="p">,</span> <span class="n">res_fp</span><span class="p">,</span> <span class="n">res_store</span> <span class="o">=</span> <span class="n">lm</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">store</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;LM statistic: </span><span class="si">{</span><span class="n">res_lm</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">LM statistic: 128.0966</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;p-value: </span><span class="si">{</span><span class="n">res_p</span><span class="si">:</span><span class="s2">.4e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">p-value: 1.1417e-22</span>
</code></pre></div></td></tr></table></div>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 3: Lagrange Multiplier test with robust covariance</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">res_lm</span><span class="p">,</span> <span class="n">res_p</span><span class="p">,</span> <span class="n">res_f</span><span class="p">,</span> <span class="n">res_fp</span> <span class="o">=</span> <span class="n">lm</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cov_type</span><span class="o">=</span><span class="s2">&quot;HC3&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;LM statistic: </span><span class="si">{</span><span class="n">res_lm</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">LM statistic: 2063.3981</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;p-value: </span><span class="si">{</span><span class="n">res_p</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">p-value: 0.0</span>
</code></pre></div></td></tr></table></div>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 4: Lagrange Multiplier test with seasonal period</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">res_lm</span><span class="p">,</span> <span class="n">res_p</span><span class="p">,</span> <span class="n">res_f</span><span class="p">,</span> <span class="n">res_fp</span> <span class="o">=</span> <span class="n">lm</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;LM statistic: </span><span class="si">{</span><span class="n">res_lm</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">LM statistic: 119.1109</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;p-value: </span><span class="si">{</span><span class="n">res_p</span><span class="si">:</span><span class="s2">.4e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">p-value: 1.3968e-14</span>
</code></pre></div></td></tr></table></div>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 5: Lagrange Multiplier test with specified degrees of freedom</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">res_lm</span><span class="p">,</span> <span class="n">res_p</span><span class="p">,</span> <span class="n">res_f</span><span class="p">,</span> <span class="n">res_fp</span> <span class="o">=</span> <span class="n">lm</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;LM statistic: </span><span class="si">{</span><span class="n">res_lm</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">LM statistic: 126.1847</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;p-value: </span><span class="si">{</span><span class="n">res_p</span><span class="si">:</span><span class="s2">.4e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">p-value: 2.7990e-22</span>
</code></pre></div></td></tr></table></div>
</details>
<details class="equation">
<summary>Calculation</summary>
<p>The LM test statistic is computed as:</p>
<div class="arithmatex">\[
LM = (n_{obs} - ddof) \times R^2
\]</div>
<p>where:</p>
<ul>
<li><span class="arithmatex">\(R^2\)</span> is the coefficient of determination from the auxiliary regression of the residuals on their own <code>nlags</code> lags,</li>
<li><span class="arithmatex">\(n_{obs}\)</span> is the number of observations, and</li>
<li><span class="arithmatex">\(ddof\)</span> is the model degrees of freedom lost due to parameter estimation.</li>
</ul>
</details>
<details class="success">
<summary>Credit</summary>
<ul>
<li>All credit goes to the <a href="https://www.statsmodels.org/"><code>statsmodels</code></a> library.</li>
</ul>
</details>
<details class="tip">
<summary>See Also</summary>
<ul>
<li><a href="https://www.statsmodels.org/stable/generated/statsmodels.stats.diagnostic.acorr_lm.html"><code>statsmodels.stats.diagnostic.acorr_lm</code></a>: Lagrange Multiplier tests for autocorrelation.</li>
<li><a class="autorefs autorefs-internal" title="            lb" href="#ts_stat_tests.algorithms.correlation.lb"><code>ts_stat_tests.algorithms.correlation.lb</code></a>: Ljung-Box test of autocorrelation in residuals.</li>
<li><a class="autorefs autorefs-internal" title="            bglm" href="#ts_stat_tests.algorithms.correlation.bglm"><code>ts_stat_tests.algorithms.correlation.bglm</code></a>: Breusch-Godfrey Lagrange Multiplier tests for residual autocorrelation.</li>
</ul>
</details>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/ts_stat_tests/algorithms/correlation.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span>
<span class="normal">955</span>
<span class="normal">956</span>
<span class="normal">957</span>
<span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span>
<span class="normal">961</span>
<span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span>
<span class="normal">967</span>
<span class="normal">968</span>
<span class="normal">969</span>
<span class="normal">970</span>
<span class="normal">971</span>
<span class="normal">972</span>
<span class="normal">973</span>
<span class="normal">974</span>
<span class="normal">975</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@typechecked</span>
<span class="k">def</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span>
    <span class="n">resid</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
    <span class="n">nlags</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">store</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">period</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">ddof</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">cov_type</span><span class="p">:</span> <span class="n">VALID_LM_COV_TYPE_OPTIONS</span> <span class="o">=</span> <span class="s2">&quot;nonrobust&quot;</span><span class="p">,</span>
    <span class="n">cov_kwargs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span>
    <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]],</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
    <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]],</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="n">ResultsStore</span><span class="p">],</span>
<span class="p">]:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    !!! note &quot;Summary&quot;</span>

<span class="sd">        The Lagrange Multiplier (LM) test is a statistical test used in time series forecasting to test for the presence of autocorrelation in a model. The test is based on the residual sum of squares (RSS) of a time series model, and can be used to assess the adequacy of the model and to identify areas for improvement.</span>

<span class="sd">        This function implements the [`acorr_lm()`](https://www.statsmodels.org/stable/generated/statsmodels.stats.diagnostic.acorr_lm.html) function from the [`statsmodels`](https://www.statsmodels.org) library.</span>

<span class="sd">    ???+ abstract &quot;Details&quot;</span>

<span class="sd">        This is a generic Lagrange Multiplier (LM) test for autocorrelation. It returns Engle&#39;s ARCH test if `resid` is the squared residual array. The Breusch-Godfrey test is a variation on this LM test with additional exogenous variables in the auxiliary regression.</span>

<span class="sd">        The LM test proceeds by:</span>

<span class="sd">        - Fitting a time series model to the data and obtaining the residuals.</span>
<span class="sd">        - Running an auxiliary regression of these residuals on their past `nlags` values (and any relevant exogenous variables).</span>
<span class="sd">        - Computing the LM statistic as $(n_{obs} - ddof) \times R^2$ from this auxiliary regression.</span>

<span class="sd">        Under the null hypothesis that the autocorrelations up to the specified lag are zero (no serial correlation in the residuals), the LM statistic is asymptotically distributed as a chi-squared random variable with degrees of freedom equal to the number of lagged residual terms included in the auxiliary regression (i.e. the number of lags being tested, adjusted for any restrictions implied by the model).</span>

<span class="sd">        If the test statistic is greater than the critical value from the chi-squared distribution (or equivalently, if the p-value is less than a chosen significance level such as $0.05$), then the null hypothesis of no autocorrelation is rejected, indicating that there is evidence of autocorrelation in the residuals.</span>

<span class="sd">        The LM test is a generalization of the Durbin-Watson test, which is a simpler test that only tests for first-order autocorrelation.</span>

<span class="sd">    Params:</span>
<span class="sd">        resid (ArrayLike):</span>
<span class="sd">            Time series to test.</span>
<span class="sd">        nlags (Optional[int], optional):</span>
<span class="sd">            Highest lag to use. Defaults to `None`.</span>
<span class="sd">            !!! deprecation &quot;Deprecation&quot;</span>
<span class="sd">                The behavior of this parameter will change after `statsmodels` version `0.12`.</span>
<span class="sd">        store (bool, optional):</span>
<span class="sd">            If `True` then the intermediate results are also returned. Defaults to `False`.</span>
<span class="sd">        period (Optional[int], optional):</span>
<span class="sd">            The period of a Seasonal time series. Used to compute the max lag for seasonal data which uses $\min(2 \times period, \lfloor \frac{n_{obs}}{5} \rfloor)$ (calculated with: `min(2*period,nobs//5)`) if set. If `None`, then the default rule is used to set the number of lags. When set, must be $\ge 2$. Defaults to `None`.</span>
<span class="sd">        ddof (int, optional):</span>
<span class="sd">            The number of degrees of freedom consumed by the model used to produce `resid`. Defaults to `0`.</span>
<span class="sd">        cov_type (VALID_LM_COV_TYPE_OPTIONS, optional):</span>
<span class="sd">            Covariance type. The default is `&quot;nonrobust&quot;` which uses the classic OLS covariance estimator. Specify one of `&quot;HC0&quot;`, `&quot;HC1&quot;`, `&quot;HC2&quot;`, `&quot;HC3&quot;` to use White&#39;s covariance estimator. All covariance types supported by `OLS.fit` are accepted. Defaults to `&quot;nonrobust&quot;`.</span>
<span class="sd">        cov_kwargs (Optional[dict], optional):</span>
<span class="sd">            Dictionary of covariance options passed to `OLS.fit`. See [`OLS.fit`](https://www.statsmodels.org/stable/generated/statsmodels.regression.linear_model.OLS.fit.html) for more details. Defaults to `None`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (Union[tuple[float, Union[float, NDArray[np.float64]], float, float], tuple[float, Union[float, NDArray[np.float64]], float, float, ResultsStore]]):</span>
<span class="sd">            Returns the following values:</span>
<span class="sd">            - `lm` (float): Lagrange multiplier test statistic.</span>
<span class="sd">            - `lmpval` (Union[float, NDArray[np.float64]]): The p-value for the Lagrange multiplier test.</span>
<span class="sd">            - `fval` (float): The f-statistic of the F test.</span>
<span class="sd">            - `fpval` (float): The p-value of the F test.</span>
<span class="sd">            - `res_store` (ResultsStore, optional): Intermediate results (returned if `store` is `True`).</span>

<span class="sd">    ???+ example &quot;Examples&quot;</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Setup&quot;}</span>
<span class="sd">        &gt;&gt;&gt; from ts_stat_tests.algorithms.correlation import lm</span>
<span class="sd">        &gt;&gt;&gt; from ts_stat_tests.utils.data import data_airline</span>
<span class="sd">        &gt;&gt;&gt; data = data_airline.values</span>

<span class="sd">        ```</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Example 1: Lagrange Multiplier test&quot;}</span>
<span class="sd">        &gt;&gt;&gt; res_lm, res_p, res_f, res_fp = lm(data)</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;LM statistic: {res_lm:.4f}&quot;)</span>
<span class="sd">        LM statistic: 128.0966</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;p-value: {res_p:.4e}&quot;)</span>
<span class="sd">        p-value: 1.1417e-22</span>

<span class="sd">        ```</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Example 2: Lagrange Multiplier test with intermediate results&quot;}</span>
<span class="sd">        &gt;&gt;&gt; res_lm, res_p, res_f, res_fp, res_store = lm(data, store=True)</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;LM statistic: {res_lm:.4f}&quot;)</span>
<span class="sd">        LM statistic: 128.0966</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;p-value: {res_p:.4e}&quot;)</span>
<span class="sd">        p-value: 1.1417e-22</span>

<span class="sd">        ```</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Example 3: Lagrange Multiplier test with robust covariance&quot;}</span>
<span class="sd">        &gt;&gt;&gt; res_lm, res_p, res_f, res_fp = lm(data, cov_type=&quot;HC3&quot;)</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;LM statistic: {res_lm:.4f}&quot;)</span>
<span class="sd">        LM statistic: 2063.3981</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;p-value: {res_p:.1f}&quot;)</span>
<span class="sd">        p-value: 0.0</span>

<span class="sd">        ```</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Example 4: Lagrange Multiplier test with seasonal period&quot;}</span>
<span class="sd">        &gt;&gt;&gt; res_lm, res_p, res_f, res_fp = lm(data, period=12)</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;LM statistic: {res_lm:.4f}&quot;)</span>
<span class="sd">        LM statistic: 119.1109</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;p-value: {res_p:.4e}&quot;)</span>
<span class="sd">        p-value: 1.3968e-14</span>

<span class="sd">        ```</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Example 5: Lagrange Multiplier test with specified degrees of freedom&quot;}</span>
<span class="sd">        &gt;&gt;&gt; res_lm, res_p, res_f, res_fp = lm(data, ddof=2)</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;LM statistic: {res_lm:.4f}&quot;)</span>
<span class="sd">        LM statistic: 126.1847</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;p-value: {res_p:.4e}&quot;)</span>
<span class="sd">        p-value: 2.7990e-22</span>

<span class="sd">        ```</span>

<span class="sd">    ??? equation &quot;Calculation&quot;</span>

<span class="sd">        The LM test statistic is computed as:</span>

<span class="sd">        $$</span>
<span class="sd">        LM = (n_{obs} - ddof) \times R^2</span>
<span class="sd">        $$</span>

<span class="sd">        where:</span>

<span class="sd">        - $R^2$ is the coefficient of determination from the auxiliary regression of the residuals on their own `nlags` lags,</span>
<span class="sd">        - $n_{obs}$ is the number of observations, and</span>
<span class="sd">        - $ddof$ is the model degrees of freedom lost due to parameter estimation.</span>

<span class="sd">    ??? success &quot;Credit&quot;</span>
<span class="sd">        - All credit goes to the [`statsmodels`](https://www.statsmodels.org/) library.</span>

<span class="sd">    ??? tip &quot;See Also&quot;</span>
<span class="sd">        - [`statsmodels.stats.diagnostic.acorr_lm`](https://www.statsmodels.org/stable/generated/statsmodels.stats.diagnostic.acorr_lm.html): Lagrange Multiplier tests for autocorrelation.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.correlation.lb`][ts_stat_tests.algorithms.correlation.lb]: Ljung-Box test of autocorrelation in residuals.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.correlation.bglm`][ts_stat_tests.algorithms.correlation.bglm]: Breusch-Godfrey Lagrange Multiplier tests for residual autocorrelation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">acorr_lm</span><span class="p">(</span>
        <span class="n">resid</span><span class="o">=</span><span class="n">resid</span><span class="p">,</span>
        <span class="n">nlags</span><span class="o">=</span><span class="n">nlags</span><span class="p">,</span>
        <span class="n">store</span><span class="o">=</span><span class="n">store</span><span class="p">,</span>
        <span class="n">period</span><span class="o">=</span><span class="n">period</span><span class="p">,</span>
        <span class="n">ddof</span><span class="o">=</span><span class="n">ddof</span><span class="p">,</span>
        <span class="n">cov_type</span><span class="o">=</span><span class="n">cov_type</span><span class="p">,</span>
        <span class="n">cov_kwargs</span><span class="o">=</span><span class="n">cov_kwargs</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="ts_stat_tests.algorithms.correlation.bglm" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">bglm</span>


<a href="#ts_stat_tests.algorithms.correlation.bglm" class="headerlink" title="Permanent link">ðŸ”—</a></h4>
          <div class="doc-overloads">
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">bglm</span><span class="p">(</span>
    <span class="n">res</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">RegressionResults</span><span class="p">,</span> <span class="n">RegressionResultsWrapper</span><span class="p">],</span>
    <span class="n">nlags</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">store</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span>
    <span class="nb">float</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]],</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span>
<span class="p">]</span>
</code></pre></div><div class="doc-signature highlight"><pre><span></span><code><span class="nf">bglm</span><span class="p">(</span>
    <span class="n">res</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">RegressionResults</span><span class="p">,</span> <span class="n">RegressionResultsWrapper</span><span class="p">],</span>
    <span class="n">nlags</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">store</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="kc">True</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span>
    <span class="nb">float</span><span class="p">,</span>
    <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]],</span>
    <span class="nb">float</span><span class="p">,</span>
    <span class="nb">float</span><span class="p">,</span>
    <span class="n">ResultsStore</span><span class="p">,</span>
<span class="p">]</span>
</code></pre></div>          </div>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">bglm</span><span class="p">(</span>
    <span class="n">res</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">RegressionResults</span><span class="p">,</span> <span class="n">RegressionResultsWrapper</span><span class="p">],</span>
    <span class="n">nlags</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">store</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span>
    <span class="nb">tuple</span><span class="p">[</span>
        <span class="nb">float</span><span class="p">,</span>
        <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]],</span>
        <span class="nb">float</span><span class="p">,</span>
        <span class="nb">float</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="nb">tuple</span><span class="p">[</span>
        <span class="nb">float</span><span class="p">,</span>
        <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]],</span>
        <span class="nb">float</span><span class="p">,</span>
        <span class="nb">float</span><span class="p">,</span>
        <span class="n">ResultsStore</span><span class="p">,</span>
    <span class="p">],</span>
<span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <div class="admonition note">
<p class="admonition-title">Summary</p>
<p>The Breusch-Godfrey Lagrange Multiplier (BGLM) test is a statistical test used in time series forecasting to test for the presence of autocorrelation in the residuals of a model. The test is a generalization of the LM test and can be used to test for autocorrelation up to a specified order.</p>
<p>This function implements the <a href="https://www.statsmodels.org/stable/generated/statsmodels.stats.diagnostic.acorr_breusch_godfrey.html"><code>acorr_breusch_godfrey()</code></a> function from the <a href="https://www.statsmodels.org"><code>statsmodels</code></a> library.</p>
</div>
<details class="abstract" open="open">
<summary>Details</summary>
<p>BG adds lags of residual to exog in the design matrix for the auxiliary regression with residuals as endog. See Greene (2002), section 12.7.1.</p>
<p>The BGLM test is performed by first fitting a time series model to the data and then obtaining the residuals from the model. The residuals are then used to estimate the autocorrelation function (ACF) up to a specified order.</p>
<p>Under the null hypothesis that there is no autocorrelation in the residuals of the regression model, the BGLM test statistic follows a chi-squared distribution with degrees of freedom equal to the number of lags included in the model.</p>
<p>If the test statistic is greater than the critical value from the chi-squared distribution, then the null hypothesis of no autocorrelation is rejected, indicating that there is evidence of autocorrelation in the residuals.</p>
</details>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>res</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="statsmodels.regression.linear_model.RegressionResults">RegressionResults</span>, <span title="statsmodels.regression.linear_model.RegressionResultsWrapper">RegressionResultsWrapper</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Estimation results for which the residuals are tested for serial correlation.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>nlags</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of lags to include in the auxiliary regression. (<code>nlags</code> is highest lag). Defaults to <code>None</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>store</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>store</code> is <code>True</code>, then an additional class instance that contains intermediate results is returned. Defaults to <code>False</code>.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="tuple">tuple</span>[<span title="float">float</span>, <span title="float">float</span>, <span title="float">float</span>, <span title="float">float</span>], <span title="tuple">tuple</span>[<span title="float">float</span>, <span title="float">float</span>, <span title="float">float</span>, <span title="float">float</span>, <span title="statsmodels.stats.diagnostic.ResultsStore">ResultsStore</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Returns the following values:
- <code>lm</code> (float): Lagrange multiplier test statistic.
- <code>lmpval</code> (float): The p-value for the Lagrange multiplier test.
- <code>fval</code> (float): The value of the f-statistic for the F test.
- <code>fpval</code> (float): The p-value of the F test.
- <code>res_store</code> (ResultsStore, optional): Intermediate results (returned if <code>store</code> is <code>True</code>).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <details class="example" open="open">
<summary>Examples</summary>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Setup</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels</span><span class="w"> </span><span class="kn">import</span> <span class="n">api</span> <span class="k">as</span> <span class="n">sm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ts_stat_tests.algorithms.correlation</span><span class="w"> </span><span class="kn">import</span> <span class="n">bglm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">longley</span><span class="o">.</span><span class="n">load_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">endog</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">longley</span><span class="o">.</span><span class="n">load_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">exog</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 1: Breusch-Godfrey test</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">res_lm</span><span class="p">,</span> <span class="n">res_p</span><span class="p">,</span> <span class="n">res_f</span><span class="p">,</span> <span class="n">res_fp</span> <span class="o">=</span> <span class="n">bglm</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;LM statistic: </span><span class="si">{</span><span class="n">res_lm</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">LM statistic: 5.1409</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;p-value: </span><span class="si">{</span><span class="n">res_p</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">p-value: 0.1618</span>
</code></pre></div></td></tr></table></div>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 2: Breusch-Godfrey test with intermediate results</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">res_lm</span><span class="p">,</span> <span class="n">res_p</span><span class="p">,</span> <span class="n">res_f</span><span class="p">,</span> <span class="n">res_fp</span><span class="p">,</span> <span class="n">res_store</span> <span class="o">=</span> <span class="n">bglm</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">store</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;LM statistic: </span><span class="si">{</span><span class="n">res_lm</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">LM statistic: 5.1409</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;p-value: </span><span class="si">{</span><span class="n">res_p</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">p-value: 0.1618</span>
</code></pre></div></td></tr></table></div>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 3: Breusch-Godfrey test with specified lags</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">res_lm</span><span class="p">,</span> <span class="n">res_p</span><span class="p">,</span> <span class="n">res_f</span><span class="p">,</span> <span class="n">res_fp</span> <span class="o">=</span> <span class="n">bglm</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">nlags</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;LM statistic: </span><span class="si">{</span><span class="n">res_lm</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">LM statistic: 2.8762</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;p-value: </span><span class="si">{</span><span class="n">res_p</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">p-value: 0.2374</span>
</code></pre></div></td></tr></table></div>
</details>
<details class="equation">
<summary>Calculation</summary>
<p>The BGLM test statistic is calculated as:</p>
<div class="arithmatex">\[
BGLM = n \times R^2
\]</div>
<p>where:</p>
<ul>
<li><span class="arithmatex">\(n\)</span> is the sample size and</li>
<li><span class="arithmatex">\(R^2\)</span> is the coefficient of determination from a regression of the residuals on the lagged values of the residuals and the lagged values of the predictor variable.</li>
</ul>
</details>
<details class="success">
<summary>Credit</summary>
<ul>
<li>All credit goes to the <a href="https://www.statsmodels.org/"><code>statsmodels</code></a> library.</li>
</ul>
</details>
<details class="question">
<summary>References</summary>
<ol>
<li>Greene, W. H. Econometric Analysis. New Jersey. Prentice Hall; 5th edition. (2002).</li>
</ol>
</details>
<details class="tip">
<summary>See Also</summary>
<ul>
<li><a href="https://www.statsmodels.org/stable/generated/statsmodels.stats.diagnostic.acorr_breusch_godfrey.html"><code>statsmodels.stats.diagnostic.acorr_breusch_godfrey</code></a>: Breusch-Godfrey test for serial correlation.</li>
<li><a class="autorefs autorefs-internal" title="            lb" href="#ts_stat_tests.algorithms.correlation.lb"><code>ts_stat_tests.algorithms.correlation.lb</code></a>: Ljung-Box test of autocorrelation in residuals.</li>
<li><a class="autorefs autorefs-internal" title="            lm" href="#ts_stat_tests.algorithms.correlation.lm"><code>ts_stat_tests.algorithms.correlation.lm</code></a>: Lagrange Multiplier tests for autocorrelation.</li>
</ul>
</details>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/ts_stat_tests/algorithms/correlation.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@typechecked</span>
<span class="k">def</span><span class="w"> </span><span class="nf">bglm</span><span class="p">(</span>
    <span class="n">res</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">RegressionResults</span><span class="p">,</span> <span class="n">RegressionResultsWrapper</span><span class="p">],</span>
    <span class="n">nlags</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">store</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span>
    <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]],</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
    <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]],</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="n">ResultsStore</span><span class="p">],</span>
<span class="p">]:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    !!! note &quot;Summary&quot;</span>

<span class="sd">        The Breusch-Godfrey Lagrange Multiplier (BGLM) test is a statistical test used in time series forecasting to test for the presence of autocorrelation in the residuals of a model. The test is a generalization of the LM test and can be used to test for autocorrelation up to a specified order.</span>

<span class="sd">        This function implements the [`acorr_breusch_godfrey()`](https://www.statsmodels.org/stable/generated/statsmodels.stats.diagnostic.acorr_breusch_godfrey.html) function from the [`statsmodels`](https://www.statsmodels.org) library.</span>

<span class="sd">    ???+ abstract &quot;Details&quot;</span>

<span class="sd">        BG adds lags of residual to exog in the design matrix for the auxiliary regression with residuals as endog. See Greene (2002), section 12.7.1.</span>

<span class="sd">        The BGLM test is performed by first fitting a time series model to the data and then obtaining the residuals from the model. The residuals are then used to estimate the autocorrelation function (ACF) up to a specified order.</span>

<span class="sd">        Under the null hypothesis that there is no autocorrelation in the residuals of the regression model, the BGLM test statistic follows a chi-squared distribution with degrees of freedom equal to the number of lags included in the model.</span>

<span class="sd">        If the test statistic is greater than the critical value from the chi-squared distribution, then the null hypothesis of no autocorrelation is rejected, indicating that there is evidence of autocorrelation in the residuals.</span>

<span class="sd">    Params:</span>
<span class="sd">        res (Union[RegressionResults, RegressionResultsWrapper]):</span>
<span class="sd">            Estimation results for which the residuals are tested for serial correlation.</span>
<span class="sd">        nlags (Optional[int], optional):</span>
<span class="sd">            Number of lags to include in the auxiliary regression. (`nlags` is highest lag). Defaults to `None`.</span>
<span class="sd">        store (bool, optional):</span>
<span class="sd">            If `store` is `True`, then an additional class instance that contains intermediate results is returned. Defaults to `False`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (Union[tuple[float, float, float, float], tuple[float, float, float, float, ResultsStore]]):</span>
<span class="sd">            Returns the following values:</span>
<span class="sd">            - `lm` (float): Lagrange multiplier test statistic.</span>
<span class="sd">            - `lmpval` (float): The p-value for the Lagrange multiplier test.</span>
<span class="sd">            - `fval` (float): The value of the f-statistic for the F test.</span>
<span class="sd">            - `fpval` (float): The p-value of the F test.</span>
<span class="sd">            - `res_store` (ResultsStore, optional): Intermediate results (returned if `store` is `True`).</span>

<span class="sd">    ???+ example &quot;Examples&quot;</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Setup&quot;}</span>
<span class="sd">        &gt;&gt;&gt; from statsmodels import api as sm</span>
<span class="sd">        &gt;&gt;&gt; from ts_stat_tests.algorithms.correlation import bglm</span>
<span class="sd">        &gt;&gt;&gt; y = sm.datasets.longley.load_pandas().endog</span>
<span class="sd">        &gt;&gt;&gt; X = sm.datasets.longley.load_pandas().exog</span>
<span class="sd">        &gt;&gt;&gt; X = sm.add_constant(X)</span>
<span class="sd">        &gt;&gt;&gt; model = sm.OLS(y, X).fit()</span>

<span class="sd">        ```</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Example 1: Breusch-Godfrey test&quot;}</span>
<span class="sd">        &gt;&gt;&gt; res_lm, res_p, res_f, res_fp = bglm(model)</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;LM statistic: {res_lm:.4f}&quot;)</span>
<span class="sd">        LM statistic: 5.1409</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;p-value: {res_p:.4f}&quot;)</span>
<span class="sd">        p-value: 0.1618</span>

<span class="sd">        ```</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Example 2: Breusch-Godfrey test with intermediate results&quot;}</span>
<span class="sd">        &gt;&gt;&gt; res_lm, res_p, res_f, res_fp, res_store = bglm(model, store=True)</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;LM statistic: {res_lm:.4f}&quot;)</span>
<span class="sd">        LM statistic: 5.1409</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;p-value: {res_p:.4f}&quot;)</span>
<span class="sd">        p-value: 0.1618</span>

<span class="sd">        ```</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Example 3: Breusch-Godfrey test with specified lags&quot;}</span>
<span class="sd">        &gt;&gt;&gt; res_lm, res_p, res_f, res_fp = bglm(model, nlags=2)</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;LM statistic: {res_lm:.4f}&quot;)</span>
<span class="sd">        LM statistic: 2.8762</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;p-value: {res_p:.4f}&quot;)</span>
<span class="sd">        p-value: 0.2374</span>

<span class="sd">        ```</span>

<span class="sd">    ??? equation &quot;Calculation&quot;</span>

<span class="sd">        The BGLM test statistic is calculated as:</span>

<span class="sd">        $$</span>
<span class="sd">        BGLM = n \times R^2</span>
<span class="sd">        $$</span>

<span class="sd">        where:</span>

<span class="sd">        - $n$ is the sample size and</span>
<span class="sd">        - $R^2$ is the coefficient of determination from a regression of the residuals on the lagged values of the residuals and the lagged values of the predictor variable.</span>

<span class="sd">    ??? success &quot;Credit&quot;</span>
<span class="sd">        - All credit goes to the [`statsmodels`](https://www.statsmodels.org/) library.</span>

<span class="sd">    ??? question &quot;References&quot;</span>
<span class="sd">        1. Greene, W. H. Econometric Analysis. New Jersey. Prentice Hall; 5th edition. (2002).</span>

<span class="sd">    ??? tip &quot;See Also&quot;</span>
<span class="sd">        - [`statsmodels.stats.diagnostic.acorr_breusch_godfrey`](https://www.statsmodels.org/stable/generated/statsmodels.stats.diagnostic.acorr_breusch_godfrey.html): Breusch-Godfrey test for serial correlation.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.correlation.lb`][ts_stat_tests.algorithms.correlation.lb]: Ljung-Box test of autocorrelation in residuals.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.correlation.lm`][ts_stat_tests.algorithms.correlation.lm]: Lagrange Multiplier tests for autocorrelation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">acorr_breusch_godfrey</span><span class="p">(</span>
        <span class="n">res</span><span class="o">=</span><span class="n">res</span><span class="p">,</span>
        <span class="n">nlags</span><span class="o">=</span><span class="n">nlags</span><span class="p">,</span>
        <span class="n">store</span><span class="o">=</span><span class="n">store</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "navigation.indexes", "navigation.top", "navigation.instant", "search.highlight", "search.suggest", "toc.follow", "content.action.edit", "content.action.view", "content.code.select", "content.code.copy", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "latest", "provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="../../assets/js/mathjax.js"></script>
      
    
  </body>
</html>