
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A Python library for performing statistical tests on time series data.">
      
      
        <meta name="author" content="[Chris Mahoney](mailto:chris@mahoneyconsultingservices.com)">
      
      
      
        <link rel="prev" href="../normality/">
      
      
        <link rel="next" href="../seasonality/">
      
      
        
      
      
      <link rel="icon" href="../../assets/icons/1205526.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Stationarity - Time Series Statistical Tests</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../assets/css/style.css">
    
      <link rel="stylesheet" href="../../assets/css/admonitions.css">
    
      <link rel="stylesheet" href="../../assets/css/code_chunks.css">
    
      <link rel="stylesheet" href="../../assets/css/shortcodes.css">
    
      <link rel="stylesheet" href="../../assets/css/progress_bar.css">
    
      <link rel="stylesheet" href="https://site-assets.fontawesome.com/releases/v6.4.2/css/all.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#test-the-stationarity-of-a-given-time-series-dataset" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
          <aside class="md-banner md-banner--warning">
            <div class="md-banner__inner md-grid md-typeset">
              
  You're not viewing the latest version.
  <a href="../../..">
    <strong>Click here to go to latest.</strong>
  </a>

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),base=new URL("../.."),outdated=__md_get("__outdated",sessionStorage,base);!0===outdated&&el&&(el.hidden=!1)</script>
          </aside>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Time Series Statistical Tests" class="md-header__button md-logo" aria-label="Time Series Statistical Tests" data-md-component="logo">
      
  <img src="../../assets/icons/1205526.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Time Series Statistical Tests
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Stationarity
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/data-science-extensions/ts-stat-tests" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg>
  </div>
  <div class="md-source__repository">
    ts-stat-tests
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../usage/overview/" class="md-tabs__link">
          
  
  
    
  
  Usage

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  
    
  
  Modules

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="https://data-science-extensions.com/" class="md-tabs__link">
        
  
  
    
  
  Data Science Extensions

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Time Series Statistical Tests" class="md-nav__button md-logo" aria-label="Time Series Statistical Tests" data-md-component="logo">
      
  <img src="../../assets/icons/1205526.svg" alt="logo">

    </a>
    Time Series Statistical Tests
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/data-science-extensions/ts-stat-tests" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg>
  </div>
  <div class="md-source__repository">
    ts-stat-tests
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Usage
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Usage
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/contributing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Contributing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/changelog/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Change Log
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Modules
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Modules
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../correlation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Correlation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../regularity/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Regularity
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../normality/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Normality
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Stationarity
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Stationarity
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      
        Introduction
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stationarity-tests" class="md-nav__link">
    <span class="md-ellipsis">
      
        Stationarity Tests
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Stationarity Tests">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ts_stat_tests.tests.stationarity" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;stationarity
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Â stationarity">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ts_stat_tests.tests.stationarity.stationarity" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;stationarity
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ts_stat_tests.tests.stationarity.is_stationary" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;is_stationary
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stationarity-algorithms" class="md-nav__link">
    <span class="md-ellipsis">
      
        Stationarity Algorithms
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Stationarity Algorithms">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ts_stat_tests.algorithms.stationarity" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;stationarity
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Â stationarity">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ts_stat_tests.algorithms.stationarity.adf" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;adf
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ts_stat_tests.algorithms.stationarity.kpss" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;kpss
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ts_stat_tests.algorithms.stationarity.rur" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;rur
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ts_stat_tests.algorithms.stationarity.za" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;za
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ts_stat_tests.algorithms.stationarity.pp" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;pp
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ts_stat_tests.algorithms.stationarity.ers" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;ers
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ts_stat_tests.algorithms.stationarity.vr" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;vr
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../seasonality/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Seasonality
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_7" >
        
          
          <label class="md-nav__link" for="__nav_3_7" id="__nav_3_7_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Utilities
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Utilities
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Data
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../errors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Errors
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://data-science-extensions.com/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Data Science Extensions
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      
        Introduction
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stationarity-tests" class="md-nav__link">
    <span class="md-ellipsis">
      
        Stationarity Tests
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Stationarity Tests">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ts_stat_tests.tests.stationarity" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;stationarity
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Â stationarity">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ts_stat_tests.tests.stationarity.stationarity" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;stationarity
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ts_stat_tests.tests.stationarity.is_stationary" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;is_stationary
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stationarity-algorithms" class="md-nav__link">
    <span class="md-ellipsis">
      
        Stationarity Algorithms
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Stationarity Algorithms">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ts_stat_tests.algorithms.stationarity" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;stationarity
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Â stationarity">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ts_stat_tests.algorithms.stationarity.adf" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;adf
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ts_stat_tests.algorithms.stationarity.kpss" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;kpss
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ts_stat_tests.algorithms.stationarity.rur" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;rur
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ts_stat_tests.algorithms.stationarity.za" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;za
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ts_stat_tests.algorithms.stationarity.pp" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;pp
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ts_stat_tests.algorithms.stationarity.ers" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;ers
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ts_stat_tests.algorithms.stationarity.vr" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;vr
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/data-science-extensions/ts-stat-tests/edit/main/docs/code/stationarity.md" title="Edit this page" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/data-science-extensions/ts-stat-tests/raw/main/docs/code/stationarity.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


<h1 id="test-the-stationarity-of-a-given-time-series-dataset">Test the <code>stationarity</code> of a given Time-Series Dataset<a class="headerlink" href="#test-the-stationarity-of-a-given-time-series-dataset" title="Permanent link">ðŸ”—</a></h1>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">ðŸ”—</a></h2>
<div class="admonition abstract">
<p class="admonition-title">Summary</p>
<div class="admonition quote">
<p class="admonition-title">As stated by <a href="https://people.duke.edu/~rnau/411arim.htm">Robert Nau, Duke University</a>:</p>
<p>A stationary time series is one whose statistical properties such as mean, variance, autocorrelation, etc. are all constant over time. Most statistical forecasting methods are based on the assumption that the time series can be rendered approximately stationary (i.e., "stationarized") through the use of mathematical transformations.</p>
<hr />
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 15V9h8V4.16L19.84 12 12 19.84V15z"/></svg></span> For more info, see: <a href="https://people.duke.edu/~rnau/411arim.htm">Introduction to ARIMA models</a>.</p>
</div>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>There are two primary libraries used to implement these tests, ensuring both breadth of coverage and numerical reliability:</p>
<table>
<thead>
<tr>
<th>library</th>
<th>category</th>
<th>algorithm</th>
<th>short</th>
<th>import script</th>
<th>url</th>
</tr>
</thead>
<tbody>
<tr>
<td>statsmodels</td>
<td>Stationarity</td>
<td>Augmented Dickey-Fuller</td>
<td>ADF</td>
<td><code>from statsmodels.tsa.stattools import adfuller</code></td>
<td><a href="https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.adfuller.html">https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.adfuller.html</a></td>
</tr>
<tr>
<td></td>
<td>Stationarity</td>
<td>Kwiatkowski-Phillips-Schmidt-Shin</td>
<td>KPSS</td>
<td><code>from statsmodels.tsa.stattools import kpss</code></td>
<td><a href="https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.kpss.html">https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.kpss.html</a></td>
</tr>
<tr>
<td></td>
<td>Unit-Root</td>
<td>Zivot-Andrews structural-break unit-root test</td>
<td>ZA</td>
<td><code>from statsmodels.tsa.stattools import zivot_andrews</code></td>
<td><a href="https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.zivot_andrews.html">https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.zivot_andrews.html</a></td>
</tr>
<tr>
<td></td>
<td>Stationarity</td>
<td>Range unit-root test for stationarity</td>
<td>RUR</td>
<td><code>from statsmodels.tsa.stattools import range_unit_root_test</code></td>
<td><a href="https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.range_unit_root_test.html">https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.range_unit_root_test.html</a></td>
</tr>
<tr>
<td>arch</td>
<td>Stationarity</td>
<td>Phillips-Perron</td>
<td>PP</td>
<td><code>from arch.unitroot import PhillipsPerron</code></td>
<td><a href="https://arch.readthedocs.io/en/latest/unitroot/generated/arch.unitroot.PhillipsPerron.html">https://arch.readthedocs.io/en/latest/unitroot/generated/arch.unitroot.PhillipsPerron.html</a></td>
</tr>
<tr>
<td></td>
<td>Stationarity</td>
<td>Elliott-Rothenberg-Stock (ERS) de-trended DF</td>
<td>ERS</td>
<td><code>from arch.unitroot import DFGLS</code></td>
<td><a href="https://arch.readthedocs.io/en/latest/unitroot/generated/arch.unitroot.DFGLS.html">https://arch.readthedocs.io/en/latest/unitroot/generated/arch.unitroot.DFGLS.html</a></td>
</tr>
<tr>
<td></td>
<td>Unit-Root</td>
<td>Variance Ratio (VR) test</td>
<td>VR</td>
<td><code>from arch.unitroot import VarianceRatio</code></td>
<td><a href="https://arch.readthedocs.io/en/latest/unitroot/generated/arch.unitroot.VarianceRatio.html">https://arch.readthedocs.io/en/latest/unitroot/generated/arch.unitroot.VarianceRatio.html</a></td>
</tr>
</tbody>
</table>
<hr />
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 15V9h8V4.16L19.84 12 12 19.84V15z"/></svg></span> For more info, see: <a href="https://www.statsmodels.org/stable/tsa.html">Statsmodels TSA</a> and <a href="https://arch.readthedocs.io/en/latest/unitroot/unitroot.html">Arch Unit Roots</a>.</p>
</div>
<div class="admonition question">
<p class="admonition-title">Source Library</p>
<p>The <code>statsmodels</code> and <code>arch</code> packages were chosen because they provide robust, industry-standard implementations of unit root and stationarity tests. Specifically, <code>statsmodels</code> offers the classic ADF and KPSS tests along with specialized ones like Zivot-Andrews and RUR, while <code>arch</code> provides high-performance implementations of Phillips-Perron, ERS, and Variance Ratio tests, ensuring a comprehensive suite of tools for detecting non-stationarity and random walks.</p>
</div>
<div class="admonition example">
<p class="admonition-title">Source Module</p>
<p>All of the source code can be found within these modules:</p>
<ul>
<li><a href="https://github.com/chrimaho/ts-stat-tests/blob/main/src/ts_stat_tests/algorithms/stationarity.py"><code>ts_stat_tests.algorithms.stationarity</code></a>.</li>
<li><a href="https://github.com/chrimaho/ts-stat-tests/blob/main/src/ts_stat_tests/tests/stationarity.py"><code>ts_stat_tests.tests.stationarity</code></a>.</li>
</ul>
</div>
</div>
<h2 id="stationarity-tests">Stationarity Tests<a class="headerlink" href="#stationarity-tests" title="Permanent link">ðŸ”—</a></h2>


<div class="doc doc-object doc-module">



<h3 id="ts_stat_tests.tests.stationarity" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">ts_stat_tests.tests.stationarity</span>


<a href="#ts_stat_tests.tests.stationarity" class="headerlink" title="Permanent link">ðŸ”—</a></h3>

    <div class="doc doc-contents first">

        <div class="admonition note">
<p class="admonition-title">Summary</p>
<p>This module contains convenience functions and tests for stationarity measures,
allowing for easy access to different unit root and stationarity algorithms.</p>
</div>










  <div class="doc doc-children">















































































<div class="doc doc-object doc-function">


<h4 id="ts_stat_tests.tests.stationarity.stationarity" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">stationarity</span>


<a href="#ts_stat_tests.tests.stationarity.stationarity" class="headerlink" title="Permanent link">ðŸ”—</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">stationarity</span><span class="p">(</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
    <span class="n">algorithm</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;adf&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">STATIONARITY_RETURN_TYPE</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <div class="admonition note">
<p class="admonition-title">Summary</p>
<p>Perform a stationarity test on the given data.</p>
</div>
<details class="abstract" open="open">
<summary>Details</summary>
<p>This function is a convenience wrapper around multiple underlying algorithms:<br>
- <a class="autorefs autorefs-internal" title="            adf" href="#ts_stat_tests.algorithms.stationarity.adf"><code>adf()</code></a><br>
- <a class="autorefs autorefs-internal" title="            kpss" href="#ts_stat_tests.algorithms.stationarity.kpss"><code>kpss()</code></a><br>
- <a class="autorefs autorefs-internal" title="            pp" href="#ts_stat_tests.algorithms.stationarity.pp"><code>pp()</code></a><br>
- <a class="autorefs autorefs-internal" title="            za" href="#ts_stat_tests.algorithms.stationarity.za"><code>za()</code></a><br>
- <a class="autorefs autorefs-internal" title="            ers" href="#ts_stat_tests.algorithms.stationarity.ers"><code>ers()</code></a><br>
- <a class="autorefs autorefs-internal" title="            vr" href="#ts_stat_tests.algorithms.stationarity.vr"><code>vr()</code></a><br>
- <a class="autorefs autorefs-internal" title="            rur" href="#ts_stat_tests.algorithms.stationarity.rur"><code>rur()</code></a></p>
</details>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="numpy.typing.ArrayLike">ArrayLike</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The data to be checked.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>algorithm</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Which stationarity algorithm to use.<br>
- <code>adf()</code>: <code>["adf", "augmented_dickey_fuller"]</code><br>
- <code>kpss()</code>: <code>["kpss", "kwiatkowski_phillips_schmidt_shin"]</code><br>
- <code>pp()</code>: <code>["pp", "phillips_perron"]</code><br>
- <code>za()</code>: <code>["za", "zivot_andrews"]</code><br>
- <code>ers()</code>: <code>["ers", "elliott_rothenberg_stock"]</code><br>
- <code>vr()</code>: <code>["vr", "variance_ratio"]</code><br>
- <code>rur()</code>: <code>["rur", "range_unit_root"]</code><br>
Defaults to <code>"adf"</code>.</p>
              </div>
            </td>
            <td>
                  <code>&#39;adf&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>kwargs</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="float">float</span>, <span title="int">int</span>, <span title="str">str</span>, <span title="bool">bool</span>, <span title="numpy.typing.ArrayLike">ArrayLike</span>, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional arguments to pass to the underlying algorithm.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>When the given value for <code>algorithm</code> is not valid.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<span title="typing.Union">Union</span>[<span title="float">float</span>, <span title="int">int</span>, <span title="dict">dict</span>, <span title="statsmodels.stats.diagnostic.ResultsStore">ResultsStore</span>, None], ...]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The result of the stationarity test.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <div class="admonition success">
<p class="admonition-title">Credit</p>
<p>Calculations are performed by <code>statsmodels</code>, <code>arch</code>, and <code>pmdarima</code>.</p>
</div>
<details class="example" open="open">
<summary>Examples</summary>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Setup</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ts_stat_tests.tests.stationarity</span><span class="w"> </span><span class="kn">import</span> <span class="n">stationarity</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ts_stat_tests.utils.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">data_normal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">normal</span> <span class="o">=</span> <span class="n">data_normal</span>
</code></pre></div></td></tr></table></div>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 1: Augmented Dickey-Fuller</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">stationarity</span><span class="p">(</span><span class="n">normal</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;adf&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ADF statistic: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">ADF statistic: -30.7838</span>
</code></pre></div></td></tr></table></div>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 2: Kwiatkowski-Phillips-Schmidt-Shin</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">stationarity</span><span class="p">(</span><span class="n">normal</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;kpss&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;KPSS statistic: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">KPSS statistic: 0.0858</span>
</code></pre></div></td></tr></table></div>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 3: Phillips-Perron</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">stationarity</span><span class="p">(</span><span class="n">normal</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;pp&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;PP statistic: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">PP statistic: -30.7758</span>
</code></pre></div></td></tr></table></div>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 4: Zivot-Andrews</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">stationarity</span><span class="p">(</span><span class="n">normal</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;za&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ZA statistic: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">ZA statistic: -30.8800</span>
</code></pre></div></td></tr></table></div>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 5: Elliot-Rothenberg-Stock</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">stationarity</span><span class="p">(</span><span class="n">normal</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;ers&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ERS statistic: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">ERS statistic: -30.1517</span>
</code></pre></div></td></tr></table></div>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 6: Variance Ratio</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">stationarity</span><span class="p">(</span><span class="n">normal</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;vr&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;VR statistic: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">VR statistic: -12.8518</span>
</code></pre></div></td></tr></table></div>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 7: Range Unit Root</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">stationarity</span><span class="p">(</span><span class="n">normal</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;rur&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RUR statistic: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">RUR statistic: 0.3479</span>
</code></pre></div></td></tr></table></div>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 8: Invalid algorithm</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">stationarity</span><span class="p">(</span><span class="n">normal</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;invalid&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="w">    </span><span class="o">...</span>
<span class="gr">ValueError</span>: <span class="n">Invalid &#39;algorithm&#39;: invalid. Options: {&#39;adf&#39;: (&#39;adf&#39;, &#39;augmented_dickey_fuller&#39;), &#39;kpss&#39;: (&#39;kpss&#39;, &#39;kwiatkowski_phillips_schmidt_shin&#39;), &#39;pp&#39;: (&#39;pp&#39;, &#39;phillips_perron&#39;), &#39;za&#39;: (&#39;za&#39;, &#39;zivot_andrews&#39;), &#39;ers&#39;: (&#39;ers&#39;, &#39;elliott_rothenberg_stock&#39;), &#39;vr&#39;: (&#39;vr&#39;, &#39;variance_ratio&#39;), &#39;rur&#39;: (&#39;rur&#39;, &#39;range_unit_root&#39;)}</span>
</code></pre></div></td></tr></table></div>
</details>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/ts_stat_tests/tests/stationarity.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@typechecked</span>
<span class="k">def</span><span class="w"> </span><span class="nf">stationarity</span><span class="p">(</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
    <span class="n">algorithm</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;adf&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">STATIONARITY_RETURN_TYPE</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    !!! note &quot;Summary&quot;</span>
<span class="sd">        Perform a stationarity test on the given data.</span>

<span class="sd">    ???+ abstract &quot;Details&quot;</span>
<span class="sd">        This function is a convenience wrapper around multiple underlying algorithms:&lt;br&gt;</span>
<span class="sd">        - [`adf()`][ts_stat_tests.algorithms.stationarity.adf]&lt;br&gt;</span>
<span class="sd">        - [`kpss()`][ts_stat_tests.algorithms.stationarity.kpss]&lt;br&gt;</span>
<span class="sd">        - [`pp()`][ts_stat_tests.algorithms.stationarity.pp]&lt;br&gt;</span>
<span class="sd">        - [`za()`][ts_stat_tests.algorithms.stationarity.za]&lt;br&gt;</span>
<span class="sd">        - [`ers()`][ts_stat_tests.algorithms.stationarity.ers]&lt;br&gt;</span>
<span class="sd">        - [`vr()`][ts_stat_tests.algorithms.stationarity.vr]&lt;br&gt;</span>
<span class="sd">        - [`rur()`][ts_stat_tests.algorithms.stationarity.rur]</span>

<span class="sd">    Params:</span>
<span class="sd">        x (ArrayLike):</span>
<span class="sd">            The data to be checked.</span>
<span class="sd">        algorithm (str):</span>
<span class="sd">            Which stationarity algorithm to use.&lt;br&gt;</span>
<span class="sd">            - `adf()`: `[&quot;adf&quot;, &quot;augmented_dickey_fuller&quot;]`&lt;br&gt;</span>
<span class="sd">            - `kpss()`: `[&quot;kpss&quot;, &quot;kwiatkowski_phillips_schmidt_shin&quot;]`&lt;br&gt;</span>
<span class="sd">            - `pp()`: `[&quot;pp&quot;, &quot;phillips_perron&quot;]`&lt;br&gt;</span>
<span class="sd">            - `za()`: `[&quot;za&quot;, &quot;zivot_andrews&quot;]`&lt;br&gt;</span>
<span class="sd">            - `ers()`: `[&quot;ers&quot;, &quot;elliott_rothenberg_stock&quot;]`&lt;br&gt;</span>
<span class="sd">            - `vr()`: `[&quot;vr&quot;, &quot;variance_ratio&quot;]`&lt;br&gt;</span>
<span class="sd">            - `rur()`: `[&quot;rur&quot;, &quot;range_unit_root&quot;]`&lt;br&gt;</span>
<span class="sd">            Defaults to `&quot;adf&quot;`.</span>
<span class="sd">        kwargs (Union[float, int, str, bool, ArrayLike, None]):</span>
<span class="sd">            Additional arguments to pass to the underlying algorithm.</span>

<span class="sd">    Raises:</span>
<span class="sd">        (ValueError):</span>
<span class="sd">            When the given value for `algorithm` is not valid.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (tuple[Union[float, int, dict, ResultsStore, None], ...]):</span>
<span class="sd">            The result of the stationarity test.</span>

<span class="sd">    !!! success &quot;Credit&quot;</span>
<span class="sd">        Calculations are performed by `statsmodels`, `arch`, and `pmdarima`.</span>

<span class="sd">    ???+ example &quot;Examples&quot;</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Setup&quot;}</span>
<span class="sd">        &gt;&gt;&gt; from ts_stat_tests.tests.stationarity import stationarity</span>
<span class="sd">        &gt;&gt;&gt; from ts_stat_tests.utils.data import data_normal</span>
<span class="sd">        &gt;&gt;&gt; normal = data_normal</span>

<span class="sd">        ```</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Example 1: Augmented Dickey-Fuller&quot;}</span>
<span class="sd">        &gt;&gt;&gt; result = stationarity(normal, algorithm=&quot;adf&quot;)</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;ADF statistic: {result[0]:.4f}&quot;)</span>
<span class="sd">        ADF statistic: -30.7838</span>

<span class="sd">        ```</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Example 2: Kwiatkowski-Phillips-Schmidt-Shin&quot;}</span>
<span class="sd">        &gt;&gt;&gt; result = stationarity(normal, algorithm=&quot;kpss&quot;)</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;KPSS statistic: {result[0]:.4f}&quot;)</span>
<span class="sd">        KPSS statistic: 0.0858</span>

<span class="sd">        ```</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Example 3: Phillips-Perron&quot;}</span>
<span class="sd">        &gt;&gt;&gt; result = stationarity(normal, algorithm=&quot;pp&quot;)</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;PP statistic: {result[0]:.4f}&quot;)</span>
<span class="sd">        PP statistic: -30.7758</span>

<span class="sd">        ```</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Example 4: Zivot-Andrews&quot;}</span>
<span class="sd">        &gt;&gt;&gt; result = stationarity(normal, algorithm=&quot;za&quot;)</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;ZA statistic: {result[0]:.4f}&quot;)</span>
<span class="sd">        ZA statistic: -30.8800</span>

<span class="sd">        ```</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Example 5: Elliot-Rothenberg-Stock&quot;}</span>
<span class="sd">        &gt;&gt;&gt; result = stationarity(normal, algorithm=&quot;ers&quot;)</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;ERS statistic: {result[0]:.4f}&quot;)</span>
<span class="sd">        ERS statistic: -30.1517</span>

<span class="sd">        ```</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Example 6: Variance Ratio&quot;}</span>
<span class="sd">        &gt;&gt;&gt; result = stationarity(normal, algorithm=&quot;vr&quot;)</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;VR statistic: {result[0]:.4f}&quot;)</span>
<span class="sd">        VR statistic: -12.8518</span>

<span class="sd">        ```</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Example 7: Range Unit Root&quot;}</span>
<span class="sd">        &gt;&gt;&gt; result = stationarity(normal, algorithm=&quot;rur&quot;)</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;RUR statistic: {result[0]:.4f}&quot;)</span>
<span class="sd">        RUR statistic: 0.3479</span>

<span class="sd">        ```</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Example 8: Invalid algorithm&quot;}</span>
<span class="sd">        &gt;&gt;&gt; stationarity(normal, algorithm=&quot;invalid&quot;)</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">            ...</span>
<span class="sd">        ValueError: Invalid &#39;algorithm&#39;: invalid. Options: {&#39;adf&#39;: (&#39;adf&#39;, &#39;augmented_dickey_fuller&#39;), &#39;kpss&#39;: (&#39;kpss&#39;, &#39;kwiatkowski_phillips_schmidt_shin&#39;), &#39;pp&#39;: (&#39;pp&#39;, &#39;phillips_perron&#39;), &#39;za&#39;: (&#39;za&#39;, &#39;zivot_andrews&#39;), &#39;ers&#39;: (&#39;ers&#39;, &#39;elliott_rothenberg_stock&#39;), &#39;vr&#39;: (&#39;vr&#39;, &#39;variance_ratio&#39;), &#39;rur&#39;: (&#39;rur&#39;, &#39;range_unit_root&#39;)}</span>

<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">options</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;adf&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;adf&quot;</span><span class="p">,</span> <span class="s2">&quot;augmented_dickey_fuller&quot;</span><span class="p">),</span>
        <span class="s2">&quot;kpss&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;kpss&quot;</span><span class="p">,</span> <span class="s2">&quot;kwiatkowski_phillips_schmidt_shin&quot;</span><span class="p">),</span>
        <span class="s2">&quot;pp&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;pp&quot;</span><span class="p">,</span> <span class="s2">&quot;phillips_perron&quot;</span><span class="p">),</span>
        <span class="s2">&quot;za&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;za&quot;</span><span class="p">,</span> <span class="s2">&quot;zivot_andrews&quot;</span><span class="p">),</span>
        <span class="s2">&quot;ers&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;ers&quot;</span><span class="p">,</span> <span class="s2">&quot;elliott_rothenberg_stock&quot;</span><span class="p">),</span>
        <span class="s2">&quot;vr&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;vr&quot;</span><span class="p">,</span> <span class="s2">&quot;variance_ratio&quot;</span><span class="p">),</span>
        <span class="s2">&quot;rur&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;rur&quot;</span><span class="p">,</span> <span class="s2">&quot;range_unit_root&quot;</span><span class="p">),</span>
    <span class="p">}</span>

    <span class="c1"># Internal helper to handle kwargs casting for ty</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_call</span><span class="p">(</span>
        <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">STATIONARITY_RETURN_TYPE</span><span class="p">],</span>
        <span class="o">**</span><span class="n">args</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">STATIONARITY_RETURN_TYPE</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        !!! note &quot;Summary&quot;</span>
<span class="sd">            Internal helper to call the test function.</span>

<span class="sd">        Params:</span>
<span class="sd">            func (Callable[..., STATIONARITY_RETURN_TYPE]):</span>
<span class="sd">                The function to call.</span>
<span class="sd">            args (Union[float, int, str, bool, ArrayLike, None]):</span>
<span class="sd">                The arguments to pass to the function.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (STATIONARITY_RETURN_TYPE):</span>
<span class="sd">                The result of the function call.</span>

<span class="sd">        ???+ example &quot;Examples&quot;</span>

<span class="sd">            ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Setup&quot;}</span>
<span class="sd">            &gt;&gt;&gt; from ts_stat_tests.tests.stationarity import stationarity</span>
<span class="sd">            &gt;&gt;&gt; from ts_stat_tests.utils.data import data_normal</span>
<span class="sd">            &gt;&gt;&gt; normal = data_normal</span>
<span class="sd">            ```</span>

<span class="sd">            ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Example 1: ADF test via internal helper&quot;}</span>
<span class="sd">            &gt;&gt;&gt; result = stationarity(normal, algorithm=&quot;adf&quot;)</span>
<span class="sd">            &gt;&gt;&gt; print(f&quot;ADF statistic: {result[0]:.4f}&quot;)</span>
<span class="sd">            ADF statistic: -30.7838</span>

<span class="sd">            ```</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">**</span><span class="n">args</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">algorithm</span> <span class="ow">in</span> <span class="n">options</span><span class="p">[</span><span class="s2">&quot;adf&quot;</span><span class="p">]:</span>
        <span class="k">return</span> <span class="n">_call</span><span class="p">(</span><span class="n">_adf</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">algorithm</span> <span class="ow">in</span> <span class="n">options</span><span class="p">[</span><span class="s2">&quot;kpss&quot;</span><span class="p">]:</span>
        <span class="k">return</span> <span class="n">_call</span><span class="p">(</span><span class="n">_kpss</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">algorithm</span> <span class="ow">in</span> <span class="n">options</span><span class="p">[</span><span class="s2">&quot;pp&quot;</span><span class="p">]:</span>
        <span class="k">return</span> <span class="n">_call</span><span class="p">(</span><span class="n">_pp</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">algorithm</span> <span class="ow">in</span> <span class="n">options</span><span class="p">[</span><span class="s2">&quot;za&quot;</span><span class="p">]:</span>
        <span class="k">return</span> <span class="n">_call</span><span class="p">(</span><span class="n">_za</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">algorithm</span> <span class="ow">in</span> <span class="n">options</span><span class="p">[</span><span class="s2">&quot;ers&quot;</span><span class="p">]:</span>
        <span class="k">return</span> <span class="n">_call</span><span class="p">(</span><span class="n">_ers</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">algorithm</span> <span class="ow">in</span> <span class="n">options</span><span class="p">[</span><span class="s2">&quot;vr&quot;</span><span class="p">]:</span>
        <span class="k">return</span> <span class="n">_call</span><span class="p">(</span><span class="n">_vr</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">algorithm</span> <span class="ow">in</span> <span class="n">options</span><span class="p">[</span><span class="s2">&quot;rur&quot;</span><span class="p">]:</span>
        <span class="k">return</span> <span class="n">_call</span><span class="p">(</span><span class="n">_rur</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
        <span class="n">generate_error_message</span><span class="p">(</span>
            <span class="n">parameter_name</span><span class="o">=</span><span class="s2">&quot;algorithm&quot;</span><span class="p">,</span>
            <span class="n">value_parsed</span><span class="o">=</span><span class="n">algorithm</span><span class="p">,</span>
            <span class="n">options</span><span class="o">=</span><span class="n">options</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="ts_stat_tests.tests.stationarity.is_stationary" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">is_stationary</span>


<a href="#ts_stat_tests.tests.stationarity.is_stationary" class="headerlink" title="Permanent link">ðŸ”—</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">is_stationary</span><span class="p">(</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
    <span class="n">algorithm</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;adf&quot;</span><span class="p">,</span>
    <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">STATIONARITY_ITEM</span><span class="p">,</span> <span class="kc">None</span><span class="p">]]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <div class="admonition note">
<p class="admonition-title">Summary</p>
<p>Test whether a given data set is <code>stationary</code> or not.</p>
</div>
<details class="abstract" open="open">
<summary>Details</summary>
<p>This function checks the results of a stationarity test against a significance level <code>alpha</code>.</p>
<p>Note that different tests have different null hypotheses:
- For ADF, PP, ZA, ERS, VR, RUR: H0 is non-stationarity (unit root). Stationary if p-value &lt; alpha.
- For KPSS: H0 is stationarity. Stationary if p-value &gt; alpha.</p>
</details>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="numpy.typing.ArrayLike">ArrayLike</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The data to be checked.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>algorithm</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Which stationarity algorithm to use. Defaults to <code>"adf"</code>.</p>
              </div>
            </td>
            <td>
                  <code>&#39;adf&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>alpha</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The significance level for the test. Defaults to <code>0.05</code>.</p>
              </div>
            </td>
            <td>
                  <code>0.05</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>kwargs</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="float">float</span>, <span title="int">int</span>, <span title="str">str</span>, <span title="bool">bool</span>, <span title="numpy.typing.ArrayLike">ArrayLike</span>, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional arguments to pass to the underlying algorithm.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="float">float</span>, <span title="bool">bool</span>, None]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary containing:
- <code>"result"</code> (bool): Indicator if the series is stationary.
- <code>"statistic"</code> (float): The test statistic.
- <code>"pvalue"</code> (float): The p-value of the test.
- <code>"alpha"</code> (float): The significance level used.
- <code>"algorithm"</code> (str): The algorithm used.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <details class="example" open="open">
<summary>Examples</summary>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Setup</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ts_stat_tests.tests.stationarity</span><span class="w"> </span><span class="kn">import</span> <span class="n">is_stationary</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ts_stat_tests.utils.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">data_normal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">normal</span> <span class="o">=</span> <span class="n">data_normal</span>
</code></pre></div></td></tr></table></div>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 1: ADF test on stationary data</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">is_stationary</span><span class="p">(</span><span class="n">normal</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;adf&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="p">[</span><span class="s2">&quot;result&quot;</span><span class="p">]</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;p-value: </span><span class="si">{</span><span class="n">res</span><span class="p">[</span><span class="s1">&#39;pvalue&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">p-value: 0.0000</span>
</code></pre></div></td></tr></table></div>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 2: KPSS test on stationary data</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">is_stationary</span><span class="p">(</span><span class="n">normal</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;kpss&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="p">[</span><span class="s2">&quot;result&quot;</span><span class="p">]</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;p-value: </span><span class="si">{</span><span class="n">res</span><span class="p">[</span><span class="s1">&#39;pvalue&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">p-value: 0.1000</span>
</code></pre></div></td></tr></table></div>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 3: RUR test</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">is_stationary</span><span class="p">(</span><span class="n">normal</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;rur&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="p">[</span><span class="s2">&quot;result&quot;</span><span class="p">]</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;p-value: </span><span class="si">{</span><span class="n">res</span><span class="p">[</span><span class="s1">&#39;pvalue&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">p-value: 0.01</span>
</code></pre></div></td></tr></table></div>
</details>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/ts_stat_tests/tests/stationarity.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@typechecked</span>
<span class="k">def</span><span class="w"> </span><span class="nf">is_stationary</span><span class="p">(</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
    <span class="n">algorithm</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;adf&quot;</span><span class="p">,</span>
    <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">STATIONARITY_ITEM</span><span class="p">,</span> <span class="kc">None</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    !!! note &quot;Summary&quot;</span>
<span class="sd">        Test whether a given data set is `stationary` or not.</span>

<span class="sd">    ???+ abstract &quot;Details&quot;</span>
<span class="sd">        This function checks the results of a stationarity test against a significance level `alpha`.</span>

<span class="sd">        Note that different tests have different null hypotheses:</span>
<span class="sd">        - For ADF, PP, ZA, ERS, VR, RUR: H0 is non-stationarity (unit root). Stationary if p-value &lt; alpha.</span>
<span class="sd">        - For KPSS: H0 is stationarity. Stationary if p-value &gt; alpha.</span>

<span class="sd">    Params:</span>
<span class="sd">        x (ArrayLike):</span>
<span class="sd">            The data to be checked.</span>
<span class="sd">        algorithm (str):</span>
<span class="sd">            Which stationarity algorithm to use. Defaults to `&quot;adf&quot;`.</span>
<span class="sd">        alpha (float, optional):</span>
<span class="sd">            The significance level for the test. Defaults to `0.05`.</span>
<span class="sd">        kwargs (Union[float, int, str, bool, ArrayLike, None]):</span>
<span class="sd">            Additional arguments to pass to the underlying algorithm.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (dict[str, Union[str, float, bool, None]]):</span>
<span class="sd">            A dictionary containing:</span>
<span class="sd">            - `&quot;result&quot;` (bool): Indicator if the series is stationary.</span>
<span class="sd">            - `&quot;statistic&quot;` (float): The test statistic.</span>
<span class="sd">            - `&quot;pvalue&quot;` (float): The p-value of the test.</span>
<span class="sd">            - `&quot;alpha&quot;` (float): The significance level used.</span>
<span class="sd">            - `&quot;algorithm&quot;` (str): The algorithm used.</span>

<span class="sd">    ???+ example &quot;Examples&quot;</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Setup&quot;}</span>
<span class="sd">        &gt;&gt;&gt; from ts_stat_tests.tests.stationarity import is_stationary</span>
<span class="sd">        &gt;&gt;&gt; from ts_stat_tests.utils.data import data_normal</span>
<span class="sd">        &gt;&gt;&gt; normal = data_normal</span>

<span class="sd">        ```</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Example 1: ADF test on stationary data&quot;}</span>
<span class="sd">        &gt;&gt;&gt; res = is_stationary(normal, algorithm=&quot;adf&quot;)</span>
<span class="sd">        &gt;&gt;&gt; res[&quot;result&quot;]</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;p-value: {res[&#39;pvalue&#39;]:.4f}&quot;)</span>
<span class="sd">        p-value: 0.0000</span>

<span class="sd">        ```</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Example 2: KPSS test on stationary data&quot;}</span>
<span class="sd">        &gt;&gt;&gt; res = is_stationary(normal, algorithm=&quot;kpss&quot;)</span>
<span class="sd">        &gt;&gt;&gt; res[&quot;result&quot;]</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;p-value: {res[&#39;pvalue&#39;]:.4f}&quot;)</span>
<span class="sd">        p-value: 0.1000</span>

<span class="sd">        ```</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Example 3: RUR test&quot;}</span>
<span class="sd">        &gt;&gt;&gt; res = is_stationary(normal, algorithm=&quot;rur&quot;)</span>
<span class="sd">        &gt;&gt;&gt; res[&quot;result&quot;]</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;p-value: {res[&#39;pvalue&#39;]:.2f}&quot;)</span>
<span class="sd">        p-value: 0.01</span>

<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">res</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">stationarity</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="n">algorithm</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="n">stat</span><span class="p">:</span> <span class="n">Any</span>
    <span class="n">pvalue</span><span class="p">:</span> <span class="n">Any</span>

    <span class="c1"># stationarity() always returns a tuple</span>
    <span class="n">res_tuple</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">res</span>
    <span class="n">stat</span> <span class="o">=</span> <span class="n">res_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">pvalue_or_bool</span> <span class="o">=</span> <span class="n">res_tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1"># Handle H0 logic</span>
    <span class="n">stationary_h0</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;kpss&quot;</span><span class="p">,</span>
        <span class="s2">&quot;kwiatkowski_phillips_schmidt_shin&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">is_stat</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">pvalue</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pvalue_or_bool</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="n">is_stat</span> <span class="o">=</span> <span class="n">pvalue_or_bool</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pvalue_or_bool</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
        <span class="n">pvalue</span> <span class="o">=</span> <span class="n">pvalue_or_bool</span>
        <span class="k">if</span> <span class="n">algorithm</span> <span class="ow">in</span> <span class="n">stationary_h0</span><span class="p">:</span>
            <span class="n">is_stat</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">pvalue</span> <span class="o">&gt;</span> <span class="n">alpha</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">is_stat</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">pvalue</span> <span class="o">&lt;</span> <span class="n">alpha</span><span class="p">)</span>

    <span class="c1"># Define return dict explicitly to match return type hint</span>
    <span class="n">ret</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">STATIONARITY_ITEM</span><span class="p">,</span> <span class="kc">None</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="nb">bool</span><span class="p">(</span><span class="n">is_stat</span><span class="p">),</span>
        <span class="s2">&quot;statistic&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">stat</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">stat</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))</span> <span class="k">else</span> <span class="n">stat</span><span class="p">,</span>
        <span class="s2">&quot;pvalue&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">pvalue</span><span class="p">)</span> <span class="k">if</span> <span class="n">pvalue</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
        <span class="s2">&quot;alpha&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">alpha</span><span class="p">),</span>
        <span class="s2">&quot;algorithm&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">algorithm</span><span class="p">),</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">ret</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div><h2 id="stationarity-algorithms">Stationarity Algorithms<a class="headerlink" href="#stationarity-algorithms" title="Permanent link">ðŸ”—</a></h2>


<div class="doc doc-object doc-module">



<h3 id="ts_stat_tests.algorithms.stationarity" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">ts_stat_tests.algorithms.stationarity</span>


<a href="#ts_stat_tests.algorithms.stationarity" class="headerlink" title="Permanent link">ðŸ”—</a></h3>

    <div class="doc doc-contents first">

        <div class="admonition note">
<p class="admonition-title">Summary</p>
<p>Stationarity tests are statistical tests used to determine whether a time series is stationary or not. A stationary time series is one whose statistical properties, such as mean and variance, do not change over time. Stationarity is an important assumption in many time series forecasting models, as it allows for the use of techniques such as autoregression and moving averages.</p>
<p>There are several different types of stationarity tests, including the Augmented Dickey-Fuller (ADF) test, the Kwiatkowski-Phillips-Schmidt-Shin (KPSS) test, the Phillips-Perron (PP) test, the Elliott-Rothenberg-Stock (ERS) test, and the Variance Ratio (VR) test. Each of these tests has its own strengths and weaknesses, and the choice of which test to use will depend on the specific characteristics of the time series being analyzed.</p>
<p>Overall, stationarity tests are an important tool in time series analysis and forecasting, as they help identify whether a time series is stationary or non-stationary, which can have implications for the choice of forecasting models and methods.</p>
<p>For a really good article on ADF &amp; KPSS tests, check: <a href="https://towardsdatascience.com/when-a-time-series-only-quacks-like-a-duck-10de9e165e">When A Time Series Only Quacks Like A Duck: Testing for Stationarity Before Running Forecast Models. With Python. And A Duckling Picture.</a></p>
</div>










  <div class="doc doc-children">



















































































































<div class="doc doc-object doc-function">


<h4 id="ts_stat_tests.algorithms.stationarity.adf" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">adf</span>


<a href="#ts_stat_tests.algorithms.stationarity.adf" class="headerlink" title="Permanent link">ðŸ”—</a></h4>
          <div class="doc-overloads">
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">adf</span><span class="p">(</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
    <span class="n">maxlag</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">regression</span><span class="p">:</span> <span class="n">VALID_ADF_REGRESSION_OPTIONS</span> <span class="o">=</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">autolag</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">VALID_ADF_AUTOLAG_OPTIONS</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;AIC&quot;</span><span class="p">,</span>
    <span class="n">store</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="kc">True</span><span class="p">],</span>
    <span class="n">regresults</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">ResultsStore</span><span class="p">]</span>
</code></pre></div><div class="doc-signature highlight"><pre><span></span><code><span class="nf">adf</span><span class="p">(</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
    <span class="n">maxlag</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">regression</span><span class="p">:</span> <span class="n">VALID_ADF_REGRESSION_OPTIONS</span> <span class="o">=</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">autolag</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">store</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">regresults</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]</span>
</code></pre></div><div class="doc-signature highlight"><pre><span></span><code><span class="nf">adf</span><span class="p">(</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
    <span class="n">maxlag</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">regression</span><span class="p">:</span> <span class="n">VALID_ADF_REGRESSION_OPTIONS</span> <span class="o">=</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">autolag</span><span class="p">:</span> <span class="n">VALID_ADF_AUTOLAG_OPTIONS</span> <span class="o">=</span> <span class="s2">&quot;AIC&quot;</span><span class="p">,</span>
    <span class="n">store</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">regresults</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">dict</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span>
</code></pre></div>          </div>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">adf</span><span class="p">(</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
    <span class="n">maxlag</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">regression</span><span class="p">:</span> <span class="n">VALID_ADF_REGRESSION_OPTIONS</span> <span class="o">=</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">autolag</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">VALID_ADF_AUTOLAG_OPTIONS</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;AIC&quot;</span><span class="p">,</span>
    <span class="n">store</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">regresults</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span>
    <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">ResultsStore</span><span class="p">],</span>
    <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">dict</span><span class="p">],</span>
    <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">dict</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
<span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <div class="admonition note">
<p class="admonition-title">Summary</p>
<p>The Augmented Dickey-Fuller test can be used to test for a unit root in a univariate process in the presence of serial correlation.</p>
</div>
<details class="abstract" open="open">
<summary>Details</summary>
<p>The Augmented Dickey-Fuller (ADF) test is a statistical test used to determine whether a time series is stationary or not. Stationarity refers to the property of a time series where the statistical properties, such as mean and variance, remain constant over time. Stationarity is important for time series forecasting as it allows for the use of many popular forecasting models, such as ARIMA.</p>
<p>The ADF test is an extension of the Dickey-Fuller test and involves regressing the first-difference of the time series on its lagged values, and then testing whether the coefficient of the lagged first-difference term is statistically significant. If it is, then the time series is considered non-stationary.</p>
<p>The null hypothesis of the ADF test is that the time series has a unit root, which means that it is non-stationary. The alternative hypothesis is that the time series is stationary. If the p-value of the test is less than a chosen significance level, typically 0.05, then we reject the null hypothesis and conclude that the time series is stationary.</p>
<p>In practical terms, if a time series is found to be non-stationary by the ADF test, one can apply differencing to the time series until it becomes stationary. This involves taking the difference between consecutive observations and potentially repeating this process until the time series is stationary.</p>
</details>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="numpy.typing.ArrayLike">ArrayLike</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The data series to test.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>maxlag</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum lag which is included in test, default value of <span class="arithmatex">\(12 \times (\frac{nobs}{100})^{\frac{1}{4}}\)</span> is used when <code>None</code>.
Default: <code>None</code></p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>regression</code>
            </td>
            <td>
                  <code><span title="ts_stat_tests.algorithms.stationarity.VALID_ADF_REGRESSION_OPTIONS">VALID_ADF_REGRESSION_OPTIONS</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Constant and trend order to include in regression.</p>
<ul>
<li><code>"c"</code>: constant only (default).</li>
<li><code>"ct"</code>: constant and trend.</li>
<li><code>"ctt"</code>: constant, and linear and quadratic trend.</li>
<li><code>"n"</code>: no constant, no trend.</li>
</ul>
<p>Default: <code>"c"</code></p>
              </div>
            </td>
            <td>
                  <code>&#39;c&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>autolag</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="ts_stat_tests.algorithms.stationarity.VALID_ADF_AUTOLAG_OPTIONS">VALID_ADF_AUTOLAG_OPTIONS</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Method to use when automatically determining the lag length among the values <span class="arithmatex">\(0, 1, ..., maxlag\)</span>.</p>
<ul>
<li>If <code>"AIC"</code> (default) or <code>"BIC"</code>, then the number of lags is chosen to minimize the corresponding information criterion.</li>
<li><code>"t-stat"</code> based choice of <code>maxlag</code>. Starts with <code>maxlag</code> and drops a lag until the t-statistic on the last lag length is significant using a 5%-sized test.</li>
<li>If <code>None</code>, then the number of included lags is set to <code>maxlag</code>.</li>
</ul>
<p>Default: <code>"AIC"</code></p>
              </div>
            </td>
            <td>
                  <code>&#39;AIC&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>store</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, then a result instance is returned additionally to the <code>adf</code> statistic.
Default: <code>False</code></p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>regresults</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, the full regression results are returned.
Default: <code>False</code></p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="tuple">tuple</span>[<span title="float">float</span>, <span title="float">float</span>, <span title="dict">dict</span>, <span title="statsmodels.stats.diagnostic.ResultsStore">ResultsStore</span>], <span title="tuple">tuple</span>[<span title="float">float</span>, <span title="float">float</span>, <span title="int">int</span>, <span title="int">int</span>, <span title="dict">dict</span>], <span title="tuple">tuple</span>[<span title="float">float</span>, <span title="float">float</span>, <span title="int">int</span>, <span title="int">int</span>, <span title="dict">dict</span>, <span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Depending on parameters, returns a tuple containing:
- <code>adf</code> (float): The test statistic.
- <code>pvalue</code> (float): MacKinnon's approximate p-value.
- <code>uselag</code> (int): The number of lags used.
- <code>nobs</code> (int): The number of observations used.
- <code>critical_values</code> (dict): Critical values at the 1%, 5%, and 10% levels.
- <code>icbest</code> (float): The maximized information criterion (if <code>autolag</code> is not <code>None</code>).
- <code>resstore</code> (Optional[ResultsStore]): Result instance (if <code>store</code> is <code>True</code>).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <details class="example" open="open">
<summary>Examples</summary>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Setup</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ts_stat_tests.algorithms.stationarity</span><span class="w"> </span><span class="kn">import</span> <span class="n">adf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ts_stat_tests.utils.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">data_airline</span><span class="p">,</span> <span class="n">data_normal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">normal</span> <span class="o">=</span> <span class="n">data_normal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">airline</span> <span class="o">=</span> <span class="n">data_airline</span><span class="o">.</span><span class="n">values</span>
</code></pre></div></td></tr></table></div>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 1: Stationary Series</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">stat</span><span class="p">,</span> <span class="n">pvalue</span><span class="p">,</span> <span class="n">lags</span><span class="p">,</span> <span class="n">nobs</span><span class="p">,</span> <span class="n">crit</span><span class="p">,</span> <span class="n">icbest</span> <span class="o">=</span> <span class="n">adf</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">normal</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ADF statistic: </span><span class="si">{</span><span class="n">stat</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">ADF statistic: -30.7838</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;p-value: </span><span class="si">{</span><span class="n">pvalue</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">p-value: 0.0000</span>
</code></pre></div></td></tr></table></div>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 2: Airline Passengers Data</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">stat</span><span class="p">,</span> <span class="n">pvalue</span><span class="p">,</span> <span class="n">lags</span><span class="p">,</span> <span class="n">nobs</span><span class="p">,</span> <span class="n">crit</span><span class="p">,</span> <span class="n">icbest</span> <span class="o">=</span> <span class="n">adf</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">airline</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;p-value: </span><span class="si">{</span><span class="n">pvalue</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">p-value: 0.9919</span>
</code></pre></div></td></tr></table></div>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 3: Store Result Instance</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">adf</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">airline</span><span class="p">,</span> <span class="n">store</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<span class="go">(0.8153..., 0.9918..., {&#39;1%&#39;: np.float64(-3.4816...), &#39;5%&#39;: np.float64(-2.8840...), &#39;10%&#39;: np.float64(-2.5787...)}, &lt;statsmodels.stats.diagnostic.ResultsStore object at ...&gt;)</span>
</code></pre></div></td></tr></table></div>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 4: No Autolag</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">stat</span><span class="p">,</span> <span class="n">pvalue</span><span class="p">,</span> <span class="n">lags</span><span class="p">,</span> <span class="n">nobs</span><span class="p">,</span> <span class="n">crit</span> <span class="o">=</span> <span class="n">adf</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">airline</span><span class="p">,</span> <span class="n">autolag</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">maxlag</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;p-value: </span><span class="si">{</span><span class="n">pvalue</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">p-value: 0.7670</span>
</code></pre></div></td></tr></table></div>
</details>
<details class="equation">
<summary>Calculation</summary>
<p>The mathematical equation for the Augmented Dickey-Fuller (ADF) test for stationarity in time series forecasting is:</p>
<div class="arithmatex">\[
\Delta y_t = \alpha + \beta y_{t-1} + \sum_{i=1}^p \delta_i \Delta y_{t-i} + \epsilon_t
\]</div>
<p>where:</p>
<ul>
<li><span class="arithmatex">\(y_t\)</span> is the value of the time series at time <span class="arithmatex">\(t\)</span>.</li>
<li><span class="arithmatex">\(\Delta y_t\)</span> is the first difference of <span class="arithmatex">\(y_t\)</span>, which is defined as <span class="arithmatex">\(\Delta y_t = y_t - y_{t-1}\)</span>.</li>
<li><span class="arithmatex">\(\alpha\)</span> is the constant term.</li>
<li><span class="arithmatex">\(\beta\)</span> is the coefficient on <span class="arithmatex">\(y_{t-1}\)</span>.</li>
<li><span class="arithmatex">\(\delta_i\)</span> are the coefficients on the lagged differences of <span class="arithmatex">\(y\)</span>.</li>
<li><span class="arithmatex">\(\epsilon_t\)</span> is the error term.</li>
</ul>
<p>The ADF test involves testing the null hypothesis that <span class="arithmatex">\(\beta = 0\)</span>, or equivalently, that the time series has a unit root. If <span class="arithmatex">\(\beta\)</span> is significantly different from <span class="arithmatex">\(0\)</span>, then the null hypothesis can be rejected and the time series is considered stationary.</p>
<p>Here are the detailed steps for how to calculate the ADF test:</p>
<ol>
<li>
<p>Collect your time series data and plot it to visually check for any trends, seasonal patterns, or other patterns that could make the data non-stationary. If you detect any such patterns, you will need to pre-process your data (e.g., detrending, deseasonalizing, etc.) to remove these effects.</p>
</li>
<li>
<p>Calculate the first differences of the time series, which is simply the difference between each observation and the previous observation. This step is performed to transform the original data into a stationary process. The first difference of <span class="arithmatex">\(y_t\)</span> is defined as <span class="arithmatex">\(\Delta y_t = y_t - y_{t-1}\)</span>.</p>
</li>
<li>
<p>Estimate the parameters <span class="arithmatex">\(\alpha\)</span>, <span class="arithmatex">\(\beta\)</span>, and <span class="arithmatex">\(\delta_i\)</span> using the least squares method. This involves regressing <span class="arithmatex">\(\Delta y_t\)</span> on its lagged values, <span class="arithmatex">\(y_{t-1}\)</span>, and the lagged differences of <span class="arithmatex">\(y, \Delta y_{t-1}, \Delta y_{t-2}, \dots, \Delta y_{t-p}\)</span>, where <span class="arithmatex">\(p\)</span> is the number of lags to include in the model. The estimated equation is:</p>
<div class="arithmatex">\[
\Delta y_t = \alpha + \beta y_{t-1} + \sum_{i=1}^p \delta_i \Delta y_{t-i} + \epsilon_t
\]</div>
</li>
<li>
<p>Calculate the test statistic, which is given by:</p>
<div class="arithmatex">\[
ADF = \frac {\beta-1}{SE(\beta)}
\]</div>
<ul>
<li>where <span class="arithmatex">\(SE(\beta)\)</span> is the standard error of the coefficient on <span class="arithmatex">\(y_{t-1}\)</span>.</li>
</ul>
<p>The test statistic measures the number of standard errors by which <span class="arithmatex">\(\beta\)</span> deviates from <span class="arithmatex">\(1\)</span>. If ADF is less than the critical values from the ADF distribution table, we can reject the null hypothesis and conclude that the time series is stationary.</p>
</li>
<li>
<p>Compare the test statistic to the critical values in the ADF distribution table to determine the level of significance. The critical values depend on the sample size, the level of significance, and the number of lags in the model.</p>
</li>
<li>
<p>Finally, interpret the results and draw conclusions about the stationarity of the time series. If the null hypothesis is rejected, then the time series is stationary and can be used for forecasting. If the null hypothesis is not rejected, then the time series is non-stationary and requires further pre-processing before it can be used for forecasting.</p>
</li>
</ol>
</details>
<details class="note">
<summary>Notes</summary>
<p>The null hypothesis of the Augmented Dickey-Fuller is that there is a unit root, with the alternative that there is no unit root. If the p-value is above a critical size, then we cannot reject that there is a unit root.</p>
<p>The p-values are obtained through regression surface approximation from MacKinnon 1994, but using the updated 2010 tables. If the p-value is close to significant, then the critical values should be used to judge whether to reject the null.</p>
<p>The <code>autolag</code> option and <code>maxlag</code> for it are described in Greene.</p>
</details>
<details class="success">
<summary>Credit</summary>
<ul>
<li>All credit goes to the <a href="https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.adfuller.html"><code>statsmodels</code></a> library.</li>
</ul>
</details>
<details class="question">
<summary>References</summary>
<ul>
<li>Baum, C.F. (2004). ZANDREWS: Stata module to calculate Zivot-Andrews unit root test in presence of structural break," Statistical Software Components S437301, Boston College Department of Economics, revised 2015.</li>
<li>Schwert, G.W. (1989). Tests for unit roots: A Monte Carlo investigation. Journal of Business &amp; Economic Statistics, 7: 147-159.</li>
<li>Zivot, E., and Andrews, D.W.K. (1992). Further evidence on the great crash, the oil-price shock, and the unit-root hypothesis. Journal of Business &amp; Economic Studies, 10: 251-270.</li>
</ul>
</details>
<details class="tip">
<summary>See Also</summary>
<ul>
<li><a href="https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.adfuller.html"><code>statsmodels.tsa.stattools.adfuller</code></a>: Augmented Dickey-Fuller unit root test.</li>
<li><a href="https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.kpss.html"><code>statsmodels.tsa.stattools.kpss</code></a>: Kwiatkowski-Phillips-Schmidt-Shin stationarity test.</li>
<li><a href="https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.range_unit_root_test.html"><code>statsmodels.tsa.stattools.range_unit_root_test</code></a>: Range Unit-Root test.</li>
<li><a href="https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.zivot_andrews.html"><code>statsmodels.tsa.stattools.zivot_andrews</code></a>: Zivot-Andrews structural break test.</li>
<li><a href="https://alkaline-ml.com/pmdarima/modules/generated/pmdarima.arima.PPTest.html"><code>pmdarima.arima.PPTest</code></a>: Phillips-Perron unit root test.</li>
<li><a href="https://arch.readthedocs.io/en/latest/unitroot/generated/arch.unitroot.DFGLS.html"><code>arch.unitroot.DFGLS</code></a>: Elliot, Rothenberg and Stock's GLS-detrended Dickey-Fuller.</li>
<li><a href="https://arch.readthedocs.io/en/latest/unitroot/generated/arch.unitroot.VarianceRatio.html"><code>arch.unitroot.VarianceRatio</code></a>: Variance Ratio test of a random walk.</li>
<li><a class="autorefs autorefs-internal" title="            adf" href="#ts_stat_tests.algorithms.stationarity.adf"><code>ts_stat_tests.algorithms.stationarity.adf</code></a>: Augmented Dickey-Fuller unit root test.</li>
<li><a class="autorefs autorefs-internal" title="            kpss" href="#ts_stat_tests.algorithms.stationarity.kpss"><code>ts_stat_tests.algorithms.stationarity.kpss</code></a>: Kwiatkowski-Phillips-Schmidt-Shin stationarity test.</li>
<li><a class="autorefs autorefs-internal" title="            rur" href="#ts_stat_tests.algorithms.stationarity.rur"><code>ts_stat_tests.algorithms.stationarity.rur</code></a>: Range Unit-Root test of stationarity.</li>
<li><a class="autorefs autorefs-internal" title="            za" href="#ts_stat_tests.algorithms.stationarity.za"><code>ts_stat_tests.algorithms.stationarity.za</code></a>: Zivot-Andrews structural break unit root test.</li>
<li><a class="autorefs autorefs-internal" title="            pp" href="#ts_stat_tests.algorithms.stationarity.pp"><code>ts_stat_tests.algorithms.stationarity.pp</code></a>: Phillips-Perron unit root test.</li>
<li><a class="autorefs autorefs-internal" title="            ers" href="#ts_stat_tests.algorithms.stationarity.ers"><code>ts_stat_tests.algorithms.stationarity.ers</code></a>: Elliot, Rothenberg and Stock's GLS-detrended Dickey-Fuller test.</li>
<li><a class="autorefs autorefs-internal" title="            vr" href="#ts_stat_tests.algorithms.stationarity.vr"><code>ts_stat_tests.algorithms.stationarity.vr</code></a>: Variance Ratio test of a random walk.</li>
</ul>
</details>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/ts_stat_tests/algorithms/stationarity.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@typechecked</span>
<span class="k">def</span><span class="w"> </span><span class="nf">adf</span><span class="p">(</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
    <span class="n">maxlag</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">regression</span><span class="p">:</span> <span class="n">VALID_ADF_REGRESSION_OPTIONS</span> <span class="o">=</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">autolag</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">VALID_ADF_AUTOLAG_OPTIONS</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;AIC&quot;</span><span class="p">,</span>
    <span class="n">store</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">regresults</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span>
    <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">ResultsStore</span><span class="p">],</span>
    <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">dict</span><span class="p">],</span>
    <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">dict</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
<span class="p">]:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    !!! note &quot;Summary&quot;</span>
<span class="sd">        The Augmented Dickey-Fuller test can be used to test for a unit root in a univariate process in the presence of serial correlation.</span>

<span class="sd">    ???+ abstract &quot;Details&quot;</span>

<span class="sd">        The Augmented Dickey-Fuller (ADF) test is a statistical test used to determine whether a time series is stationary or not. Stationarity refers to the property of a time series where the statistical properties, such as mean and variance, remain constant over time. Stationarity is important for time series forecasting as it allows for the use of many popular forecasting models, such as ARIMA.</span>

<span class="sd">        The ADF test is an extension of the Dickey-Fuller test and involves regressing the first-difference of the time series on its lagged values, and then testing whether the coefficient of the lagged first-difference term is statistically significant. If it is, then the time series is considered non-stationary.</span>

<span class="sd">        The null hypothesis of the ADF test is that the time series has a unit root, which means that it is non-stationary. The alternative hypothesis is that the time series is stationary. If the p-value of the test is less than a chosen significance level, typically 0.05, then we reject the null hypothesis and conclude that the time series is stationary.</span>

<span class="sd">        In practical terms, if a time series is found to be non-stationary by the ADF test, one can apply differencing to the time series until it becomes stationary. This involves taking the difference between consecutive observations and potentially repeating this process until the time series is stationary.</span>

<span class="sd">    Params:</span>
<span class="sd">        x (ArrayLike):</span>
<span class="sd">            The data series to test.</span>
<span class="sd">        maxlag (Optional[int]):</span>
<span class="sd">            Maximum lag which is included in test, default value of $12 \times (\frac{nobs}{100})^{\frac{1}{4}}$ is used when `None`.</span>
<span class="sd">            Default: `None`</span>
<span class="sd">        regression (VALID_ADF_REGRESSION_OPTIONS):</span>
<span class="sd">            Constant and trend order to include in regression.</span>

<span class="sd">            - `&quot;c&quot;`: constant only (default).</span>
<span class="sd">            - `&quot;ct&quot;`: constant and trend.</span>
<span class="sd">            - `&quot;ctt&quot;`: constant, and linear and quadratic trend.</span>
<span class="sd">            - `&quot;n&quot;`: no constant, no trend.</span>

<span class="sd">            Default: `&quot;c&quot;`</span>
<span class="sd">        autolag (Optional[VALID_ADF_AUTOLAG_OPTIONS]):</span>
<span class="sd">            Method to use when automatically determining the lag length among the values $0, 1, ..., maxlag$.</span>

<span class="sd">            - If `&quot;AIC&quot;` (default) or `&quot;BIC&quot;`, then the number of lags is chosen to minimize the corresponding information criterion.</span>
<span class="sd">            - `&quot;t-stat&quot;` based choice of `maxlag`. Starts with `maxlag` and drops a lag until the t-statistic on the last lag length is significant using a 5%-sized test.</span>
<span class="sd">            - If `None`, then the number of included lags is set to `maxlag`.</span>

<span class="sd">            Default: `&quot;AIC&quot;`</span>
<span class="sd">        store (bool):</span>
<span class="sd">            If `True`, then a result instance is returned additionally to the `adf` statistic.</span>
<span class="sd">            Default: `False`</span>
<span class="sd">        regresults (bool):</span>
<span class="sd">            If `True`, the full regression results are returned.</span>
<span class="sd">            Default: `False`</span>

<span class="sd">    Returns:</span>
<span class="sd">        (Union[tuple[float, float, dict, ResultsStore], tuple[float, float, int, int, dict], tuple[float, float, int, int, dict, float]]):</span>
<span class="sd">            Depending on parameters, returns a tuple containing:</span>
<span class="sd">            - `adf` (float): The test statistic.</span>
<span class="sd">            - `pvalue` (float): MacKinnon&#39;s approximate p-value.</span>
<span class="sd">            - `uselag` (int): The number of lags used.</span>
<span class="sd">            - `nobs` (int): The number of observations used.</span>
<span class="sd">            - `critical_values` (dict): Critical values at the 1%, 5%, and 10% levels.</span>
<span class="sd">            - `icbest` (float): The maximized information criterion (if `autolag` is not `None`).</span>
<span class="sd">            - `resstore` (Optional[ResultsStore]): Result instance (if `store` is `True`).</span>

<span class="sd">    ???+ example &quot;Examples&quot;</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Setup&quot;}</span>
<span class="sd">        &gt;&gt;&gt; from ts_stat_tests.algorithms.stationarity import adf</span>
<span class="sd">        &gt;&gt;&gt; from ts_stat_tests.utils.data import data_airline, data_normal</span>
<span class="sd">        &gt;&gt;&gt; normal = data_normal</span>
<span class="sd">        &gt;&gt;&gt; airline = data_airline.values</span>

<span class="sd">        ```</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Example 1: Stationary Series&quot;}</span>
<span class="sd">        &gt;&gt;&gt; stat, pvalue, lags, nobs, crit, icbest = adf(x=normal)</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;ADF statistic: {stat:.4f}&quot;)</span>
<span class="sd">        ADF statistic: -30.7838</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;p-value: {pvalue:.4f}&quot;)</span>
<span class="sd">        p-value: 0.0000</span>

<span class="sd">        ```</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Example 2: Airline Passengers Data&quot;}</span>
<span class="sd">        &gt;&gt;&gt; stat, pvalue, lags, nobs, crit, icbest = adf(x=airline)</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;p-value: {pvalue:.4f}&quot;)</span>
<span class="sd">        p-value: 0.9919</span>

<span class="sd">        ```</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Example 3: Store Result Instance&quot;}</span>
<span class="sd">        &gt;&gt;&gt; res = adf(x=airline, store=True)</span>
<span class="sd">        &gt;&gt;&gt; print(res)</span>
<span class="sd">        (0.8153..., 0.9918..., {&#39;1%&#39;: np.float64(-3.4816...), &#39;5%&#39;: np.float64(-2.8840...), &#39;10%&#39;: np.float64(-2.5787...)}, &lt;statsmodels.stats.diagnostic.ResultsStore object at ...&gt;)</span>

<span class="sd">        ```</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Example 4: No Autolag&quot;}</span>
<span class="sd">        &gt;&gt;&gt; stat, pvalue, lags, nobs, crit = adf(x=airline, autolag=None, maxlag=5)</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;p-value: {pvalue:.4f}&quot;)</span>
<span class="sd">        p-value: 0.7670</span>

<span class="sd">        ```</span>

<span class="sd">    ??? equation &quot;Calculation&quot;</span>

<span class="sd">        The mathematical equation for the Augmented Dickey-Fuller (ADF) test for stationarity in time series forecasting is:</span>

<span class="sd">        $$</span>
<span class="sd">        \Delta y_t = \alpha + \beta y_{t-1} + \sum_{i=1}^p \delta_i \Delta y_{t-i} + \epsilon_t</span>
<span class="sd">        $$</span>

<span class="sd">        where:</span>

<span class="sd">        - $y_t$ is the value of the time series at time $t$.</span>
<span class="sd">        - $\Delta y_t$ is the first difference of $y_t$, which is defined as $\Delta y_t = y_t - y_{t-1}$.</span>
<span class="sd">        - $\alpha$ is the constant term.</span>
<span class="sd">        - $\beta$ is the coefficient on $y_{t-1}$.</span>
<span class="sd">        - $\delta_i$ are the coefficients on the lagged differences of $y$.</span>
<span class="sd">        - $\epsilon_t$ is the error term.</span>

<span class="sd">        The ADF test involves testing the null hypothesis that $\beta = 0$, or equivalently, that the time series has a unit root. If $\beta$ is significantly different from $0$, then the null hypothesis can be rejected and the time series is considered stationary.</span>

<span class="sd">        Here are the detailed steps for how to calculate the ADF test:</span>

<span class="sd">        1. Collect your time series data and plot it to visually check for any trends, seasonal patterns, or other patterns that could make the data non-stationary. If you detect any such patterns, you will need to pre-process your data (e.g., detrending, deseasonalizing, etc.) to remove these effects.</span>

<span class="sd">        1. Calculate the first differences of the time series, which is simply the difference between each observation and the previous observation. This step is performed to transform the original data into a stationary process. The first difference of $y_t$ is defined as $\Delta y_t = y_t - y_{t-1}$.</span>

<span class="sd">        1. Estimate the parameters $\alpha$, $\beta$, and $\delta_i$ using the least squares method. This involves regressing $\Delta y_t$ on its lagged values, $y_{t-1}$, and the lagged differences of $y, \Delta y_{t-1}, \Delta y_{t-2}, \dots, \Delta y_{t-p}$, where $p$ is the number of lags to include in the model. The estimated equation is:</span>

<span class="sd">            $$</span>
<span class="sd">            \Delta y_t = \alpha + \beta y_{t-1} + \sum_{i=1}^p \delta_i \Delta y_{t-i} + \epsilon_t</span>
<span class="sd">            $$</span>

<span class="sd">        1. Calculate the test statistic, which is given by:</span>

<span class="sd">            $$</span>
<span class="sd">            ADF = \frac {\beta-1}{SE(\beta)}</span>
<span class="sd">            $$</span>

<span class="sd">            - where $SE(\beta)$ is the standard error of the coefficient on $y_{t-1}$.</span>

<span class="sd">            The test statistic measures the number of standard errors by which $\beta$ deviates from $1$. If ADF is less than the critical values from the ADF distribution table, we can reject the null hypothesis and conclude that the time series is stationary.</span>

<span class="sd">        1. Compare the test statistic to the critical values in the ADF distribution table to determine the level of significance. The critical values depend on the sample size, the level of significance, and the number of lags in the model.</span>

<span class="sd">        1. Finally, interpret the results and draw conclusions about the stationarity of the time series. If the null hypothesis is rejected, then the time series is stationary and can be used for forecasting. If the null hypothesis is not rejected, then the time series is non-stationary and requires further pre-processing before it can be used for forecasting.</span>

<span class="sd">    ??? note &quot;Notes&quot;</span>
<span class="sd">        The null hypothesis of the Augmented Dickey-Fuller is that there is a unit root, with the alternative that there is no unit root. If the p-value is above a critical size, then we cannot reject that there is a unit root.</span>

<span class="sd">        The p-values are obtained through regression surface approximation from MacKinnon 1994, but using the updated 2010 tables. If the p-value is close to significant, then the critical values should be used to judge whether to reject the null.</span>

<span class="sd">        The `autolag` option and `maxlag` for it are described in Greene.</span>

<span class="sd">    ??? success &quot;Credit&quot;</span>
<span class="sd">        - All credit goes to the [`statsmodels`](https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.adfuller.html) library.</span>

<span class="sd">    ??? question &quot;References&quot;</span>
<span class="sd">        - Baum, C.F. (2004). ZANDREWS: Stata module to calculate Zivot-Andrews unit root test in presence of structural break,&quot; Statistical Software Components S437301, Boston College Department of Economics, revised 2015.</span>
<span class="sd">        - Schwert, G.W. (1989). Tests for unit roots: A Monte Carlo investigation. Journal of Business &amp; Economic Statistics, 7: 147-159.</span>
<span class="sd">        - Zivot, E., and Andrews, D.W.K. (1992). Further evidence on the great crash, the oil-price shock, and the unit-root hypothesis. Journal of Business &amp; Economic Studies, 10: 251-270.</span>

<span class="sd">    ??? tip &quot;See Also&quot;</span>
<span class="sd">        - [`statsmodels.tsa.stattools.adfuller`](https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.adfuller.html): Augmented Dickey-Fuller unit root test.</span>
<span class="sd">        - [`statsmodels.tsa.stattools.kpss`](https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.kpss.html): Kwiatkowski-Phillips-Schmidt-Shin stationarity test.</span>
<span class="sd">        - [`statsmodels.tsa.stattools.range_unit_root_test`](https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.range_unit_root_test.html): Range Unit-Root test.</span>
<span class="sd">        - [`statsmodels.tsa.stattools.zivot_andrews`](https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.zivot_andrews.html): Zivot-Andrews structural break test.</span>
<span class="sd">        - [`pmdarima.arima.PPTest`](https://alkaline-ml.com/pmdarima/modules/generated/pmdarima.arima.PPTest.html): Phillips-Perron unit root test.</span>
<span class="sd">        - [`arch.unitroot.DFGLS`](https://arch.readthedocs.io/en/latest/unitroot/generated/arch.unitroot.DFGLS.html): Elliot, Rothenberg and Stock&#39;s GLS-detrended Dickey-Fuller.</span>
<span class="sd">        - [`arch.unitroot.VarianceRatio`](https://arch.readthedocs.io/en/latest/unitroot/generated/arch.unitroot.VarianceRatio.html): Variance Ratio test of a random walk.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.stationarity.adf`][ts_stat_tests.algorithms.stationarity.adf]: Augmented Dickey-Fuller unit root test.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.stationarity.kpss`][ts_stat_tests.algorithms.stationarity.kpss]: Kwiatkowski-Phillips-Schmidt-Shin stationarity test.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.stationarity.rur`][ts_stat_tests.algorithms.stationarity.rur]: Range Unit-Root test of stationarity.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.stationarity.za`][ts_stat_tests.algorithms.stationarity.za]: Zivot-Andrews structural break unit root test.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.stationarity.pp`][ts_stat_tests.algorithms.stationarity.pp]: Phillips-Perron unit root test.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.stationarity.ers`][ts_stat_tests.algorithms.stationarity.ers]: Elliot, Rothenberg and Stock&#39;s GLS-detrended Dickey-Fuller test.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.stationarity.vr`][ts_stat_tests.algorithms.stationarity.vr]: Variance Ratio test of a random walk.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">res</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">_adfuller</span><span class="p">(</span>  <span class="c1"># Using `Any` to avoid ty issues with statsmodels stubs</span>
        <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
        <span class="n">maxlag</span><span class="o">=</span><span class="n">maxlag</span><span class="p">,</span>
        <span class="n">regression</span><span class="o">=</span><span class="n">regression</span><span class="p">,</span>
        <span class="n">autolag</span><span class="o">=</span><span class="n">autolag</span><span class="p">,</span>  <span class="c1"># type: ignore[arg-type] # statsmodels stubs are often missing `None`</span>
        <span class="n">store</span><span class="o">=</span><span class="n">store</span><span class="p">,</span>
        <span class="n">regresults</span><span class="o">=</span><span class="n">regresults</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">store</span><span class="p">:</span>
        <span class="c1"># returns (stat, pval, crit, store)</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">dict</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="n">res</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">autolag</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># returns (stat, pval, lags, nobs, crit)</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="nb">float</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
            <span class="nb">float</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
            <span class="nb">int</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
            <span class="nb">int</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span>
            <span class="nb">dict</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span>
        <span class="p">)</span>

    <span class="c1"># returns (stat, pval, lags, nobs, crit, icbest)</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="nb">float</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
        <span class="nb">float</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
        <span class="nb">int</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
        <span class="nb">int</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span>
        <span class="nb">dict</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span>
        <span class="nb">float</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">5</span><span class="p">]),</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="ts_stat_tests.algorithms.stationarity.kpss" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">kpss</span>


<a href="#ts_stat_tests.algorithms.stationarity.kpss" class="headerlink" title="Permanent link">ðŸ”—</a></h4>
          <div class="doc-overloads">
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">kpss</span><span class="p">(</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
    <span class="n">regression</span><span class="p">:</span> <span class="n">VALID_KPSS_REGRESSION_OPTIONS</span> <span class="o">=</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span>
    <span class="n">nlags</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span>
        <span class="n">Union</span><span class="p">[</span><span class="n">VALID_KPSS_NLAGS_OPTIONS</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span>
    <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">store</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="kc">True</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">ResultsStore</span><span class="p">]</span>
</code></pre></div><div class="doc-signature highlight"><pre><span></span><code><span class="nf">kpss</span><span class="p">(</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
    <span class="n">regression</span><span class="p">:</span> <span class="n">VALID_KPSS_REGRESSION_OPTIONS</span> <span class="o">=</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span>
    <span class="n">nlags</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span>
        <span class="n">Union</span><span class="p">[</span><span class="n">VALID_KPSS_NLAGS_OPTIONS</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span>
    <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">store</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]</span>
</code></pre></div>          </div>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">kpss</span><span class="p">(</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
    <span class="n">regression</span><span class="p">:</span> <span class="n">VALID_KPSS_REGRESSION_OPTIONS</span> <span class="o">=</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span>
    <span class="n">nlags</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span>
        <span class="n">Union</span><span class="p">[</span><span class="n">VALID_KPSS_NLAGS_OPTIONS</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span>
    <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">store</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span>
    <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">ResultsStore</span><span class="p">],</span>
    <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">dict</span><span class="p">],</span>
<span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <div class="admonition note">
<p class="admonition-title">Summary</p>
<p>Computes the Kwiatkowski-Phillips-Schmidt-Shin (KPSS) test for the null hypothesis that <code>x</code> is level or trend stationary.</p>
</div>
<details class="abstract" open="open">
<summary>Details</summary>
<p>The Kwiatkowski-Phillips-Schmidt-Shin (KPSS) test is another statistical test used to determine whether a time series is stationary or not. The KPSS test is the opposite of the Augmented Dickey-Fuller (ADF) test, which tests for the presence of a unit root in the time series.</p>
<p>The KPSS test involves regressing the time series on a constant and a time trend. The null hypothesis of the test is that the time series is stationary. The alternative hypothesis is that the time series has a unit root, which means that it is non-stationary.</p>
<p>The test statistic is calculated by taking the sum of the squared residuals of the regression. If the test statistic is greater than a critical value at a given significance level, typically 0.05, then we reject the null hypothesis and conclude that the time series is non-stationary. If the test statistic is less than the critical value, then we fail to reject the null hypothesis and conclude that the time series is stationary.</p>
<p>In practical terms, if a time series is found to be non-stationary by the KPSS test, one can apply differencing to the time series until it becomes stationary. This involves taking the difference between consecutive observations and potentially repeating this process until the time series is stationary.</p>
<p>Overall, the ADF and KPSS tests are both important tools in time series analysis and forecasting, as they help identify whether a time series is stationary or non-stationary, which can have implications for the choice of forecasting models and methods.</p>
</details>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="numpy.typing.ArrayLike">ArrayLike</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The data series to test.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>regression</code>
            </td>
            <td>
                  <code><span title="ts_stat_tests.algorithms.stationarity.VALID_KPSS_REGRESSION_OPTIONS">VALID_KPSS_REGRESSION_OPTIONS</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The null hypothesis for the KPSS test.</p>
<ul>
<li><code>"c"</code>: The data is stationary around a constant (default).</li>
<li><code>"ct"</code>: The data is stationary around a trend.</li>
</ul>
<p>Defaults to <code>"c"</code>.</p>
              </div>
            </td>
            <td>
                  <code>&#39;c&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>nlags</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="ts_stat_tests.algorithms.stationarity.VALID_KPSS_NLAGS_OPTIONS">VALID_KPSS_NLAGS_OPTIONS</span>, <span title="int">int</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Indicates the number of lags to be used.</p>
<ul>
<li>If <code>"auto"</code> (default), <code>lags</code> is calculated using the data-dependent method of Hobijn et al. (1998). See also Andrews (1991), Newey &amp; West (1994), and Schwert (1989).</li>
<li>If set to <code>"legacy"</code>, uses <span class="arithmatex">\(int(12 \\times (\\frac{n}{100})^{\\frac{1}{4}})\)</span>, as outlined in Schwert (1989).</li>
</ul>
<p>Defaults to <code>None</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>store</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, then a result instance is returned additionally to the KPSS statistic.<br>
Defaults to <code>False</code>.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="tuple">tuple</span>[<span title="float">float</span>, <span title="float">float</span>, <span title="int">int</span>, <span title="dict">dict</span>, <span title="statsmodels.stats.diagnostic.ResultsStore">ResultsStore</span>], <span title="tuple">tuple</span>[<span title="float">float</span>, <span title="float">float</span>, <span title="int">int</span>, <span title="dict">dict</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Returns a tuple containing:
- <code>stat</code> (float): The KPSS test statistic.
- <code>pvalue</code> (float): The p-value of the test.
- <code>lags</code> (int): The truncation lag parameter.
- <code>crit</code> (dict): The critical values at 10%, 5%, 2.5%, and 1%.
- <code>resstore</code> (Optional[ResultsStore]): Result instance (if <code>store</code> is <code>True</code>).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <details class="example" open="open">
<summary>Examples</summary>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Setup</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ts_stat_tests.algorithms.stationarity</span><span class="w"> </span><span class="kn">import</span> <span class="n">kpss</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ts_stat_tests.utils.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">data_airline</span><span class="p">,</span> <span class="n">data_normal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">normal</span> <span class="o">=</span> <span class="n">data_normal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">airline</span> <span class="o">=</span> <span class="n">data_airline</span><span class="o">.</span><span class="n">values</span>
</code></pre></div></td></tr></table></div>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 1: Stationary Series</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">stat</span><span class="p">,</span> <span class="n">pvalue</span><span class="p">,</span> <span class="n">lags</span><span class="p">,</span> <span class="n">crit</span> <span class="o">=</span> <span class="n">kpss</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">normal</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;KPSS statistic: </span><span class="si">{</span><span class="n">stat</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">KPSS statistic: 0.0858</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;p-value: </span><span class="si">{</span><span class="n">pvalue</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">p-value: 0.1000</span>
</code></pre></div></td></tr></table></div>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 2: Airline Passengers Data</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">stat</span><span class="p">,</span> <span class="n">pvalue</span><span class="p">,</span> <span class="n">lags</span><span class="p">,</span> <span class="n">crit</span> <span class="o">=</span> <span class="n">kpss</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">airline</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;p-value: </span><span class="si">{</span><span class="n">pvalue</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">p-value: 0.0100</span>
</code></pre></div></td></tr></table></div>
</details>
<details class="equation">
<summary>Calculation</summary>
<p>The mathematical equation for the KPSS test for stationarity in time series forecasting is:</p>
<div class="arithmatex">\[
y_t = \mu_t + \epsilon_t
\]</div>
<p>where:</p>
<ul>
<li><span class="arithmatex">\(y_t\)</span> is the value of the time series at time <span class="arithmatex">\(t\)</span>.</li>
<li><span class="arithmatex">\(\mu_t\)</span> is the trend component of the time series.</li>
<li><span class="arithmatex">\(\epsilon_t\)</span> is the error term.</li>
</ul>
<p>The KPSS test involves testing the null hypothesis that the time series is trend stationary, which means that the trend component of the time series is stationary over time. If the null hypothesis is rejected, then the time series is non-stationary and requires further pre-processing before it can be used for forecasting.</p>
<p>Here are the detailed steps for how to calculate the KPSS test:</p>
<ol>
<li>
<p>Collect your time series data and plot it to visually check for any trends, seasonal patterns, or other patterns that could make the data non-stationary. If you detect any such patterns, you will need to pre-process your data (e.g., detrending, deseasonalizing, etc.) to remove these effects.</p>
</li>
<li>
<p>Divide your time series data into multiple overlapping windows of equal size. The length of each window depends on the length of your time series and the level of detail you want to capture.</p>
</li>
<li>
<p>Calculate the trend component <span class="arithmatex">\(\mu_t\)</span> for each window using a trend estimation method. There are several methods for estimating the trend component, such as the Hodrick-Prescott filter, the Christiano-Fitzgerald filter, or simple linear regression. The choice of method depends on the characteristics of your data and the level of accuracy you want to achieve.</p>
</li>
<li>
<p>Calculate the residual series <span class="arithmatex">\(\epsilon_t\)</span> by subtracting the trend component from the original time series:</p>
<div class="arithmatex">\[
\epsilon_t = y_t - \mu_t
\]</div>
</li>
<li>
<p>Estimate the variance of the residual series using a suitable estimator, such as the Newey-West estimator or the Bartlett kernel estimator. This step is necessary to correct for any serial correlation in the residual series.</p>
</li>
<li>
<p>Calculate the test statistic, which is given by:</p>
<div class="arithmatex">\[
KPSS = T \times \sum_{t=1}^T \frac {S_t^2} {\sigma^2}
\]</div>
<p>where:</p>
<ul>
<li><span class="arithmatex">\(T\)</span> is the number of observations in the time series.</li>
<li><span class="arithmatex">\(S_t\)</span> is the cumulative sum of the residual series up to time <span class="arithmatex">\(t\)</span>, i.e., <span class="arithmatex">\(S_t = \sum_{i=1}^t \epsilon_i\)</span>.</li>
<li><span class="arithmatex">\(\sigma^2\)</span> is the estimated variance of the residual series.</li>
</ul>
<p>The test statistic measures the strength of the trend component relative to the residual series. If KPSS is greater than the critical values from the KPSS distribution table, we can reject the null hypothesis and conclude that the time series is non-stationary.</p>
</li>
<li>
<p>Finally, interpret the results and draw conclusions about the stationarity of the time series. If the null hypothesis is rejected, then the time series is non-stationary and requires further pre-processing before it can be used for forecasting. If the null hypothesis is not rejected, then the time series is trend stationary and can be used for forecasting.</p>
</li>
</ol>
</details>
<details class="note">
<summary>Notes</summary>
<p>To estimate <span class="arithmatex">\(\sigma^2\)</span> the Newey-West estimator is used. If <code>lags</code> is <code>"legacy"</code>, the truncation lag parameter is set to <span class="arithmatex">\(int(12 \times (\frac{n}{100})^{\frac{1}{4}})\)</span>, as outlined in Schwert (1989). The p-values are interpolated from Table 1 of Kwiatkowski et al. (1992). If the computed statistic is outside the table of critical values, then a warning message is generated.</p>
<p>Missing values are not handled.</p>
</details>
<details class="success">
<summary>Credit</summary>
<ul>
<li>All credit goes to the <a href="https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.kpss.html"><code>statsmodels</code></a> library.</li>
</ul>
</details>
<details class="question">
<summary>References</summary>
<ul>
<li>Andrews, D.W.K. (1991). Heteroskedasticity and autocorrelation consistent covariance matrix estimation. Econometrica, 59: 817-858.</li>
<li>Hobijn, B., Frances, B.H., &amp; Ooms, M. (2004). Generalizations of the KPSS-test for stationarity. Statistica Neerlandica, 52: 483-502.</li>
<li>Kwiatkowski, D., Phillips, P.C.B., Schmidt, P., &amp; Shin, Y. (1992). Testing the null hypothesis of stationarity against the alternative of a unit root. Journal of Econometrics, 54: 159-178.</li>
<li>Newey, W.K., &amp; West, K.D. (1994). Automatic lag selection in covariance matrix estimation. Review of Economic Studies, 61: 631-653.</li>
<li>Schwert, G. W. (1989). Tests for unit roots: A Monte Carlo investigation. Journal of Business and Economic Statistics, 7 (2): 147-159.</li>
</ul>
</details>
<details class="tip">
<summary>See Also</summary>
<ul>
<li><a href="https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.adfuller.html"><code>statsmodels.tsa.stattools.adfuller</code></a>: Augmented Dickey-Fuller unit root test.</li>
<li><a href="https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.kpss.html"><code>statsmodels.tsa.stattools.kpss</code></a>: Kwiatkowski-Phillips-Schmidt-Shin stationarity test.</li>
<li><a href="https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.range_unit_root_test.html"><code>statsmodels.tsa.stattools.range_unit_root_test</code></a>: Range Unit-Root test.</li>
<li><a href="https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.zivot_andrews.html"><code>statsmodels.tsa.stattools.zivot_andrews</code></a>: Zivot-Andrews structural break test.</li>
<li><a href="https://alkaline-ml.com/pmdarima/modules/generated/pmdarima.arima.PPTest.html"><code>pmdarima.arima.PPTest</code></a>: Phillips-Perron unit root test.</li>
<li><a href="https://arch.readthedocs.io/en/latest/unitroot/generated/arch.unitroot.DFGLS.html"><code>arch.unitroot.DFGLS</code></a>: Elliot, Rothenberg and Stock's GLS-detrended Dickey-Fuller.</li>
<li><a href="https://arch.readthedocs.io/en/latest/unitroot/generated/arch.unitroot.VarianceRatio.html"><code>arch.unitroot.VarianceRatio</code></a>: Variance Ratio test of a random walk.</li>
<li><a class="autorefs autorefs-internal" title="            adf" href="#ts_stat_tests.algorithms.stationarity.adf"><code>ts_stat_tests.algorithms.stationarity.adf</code></a>: Augmented Dickey-Fuller unit root test.</li>
<li><a class="autorefs autorefs-internal" title="            kpss" href="#ts_stat_tests.algorithms.stationarity.kpss"><code>ts_stat_tests.algorithms.stationarity.kpss</code></a>: Kwiatkowski-Phillips-Schmidt-Shin stationarity test.</li>
<li><a class="autorefs autorefs-internal" title="            rur" href="#ts_stat_tests.algorithms.stationarity.rur"><code>ts_stat_tests.algorithms.stationarity.rur</code></a>: Range Unit-Root test of stationarity.</li>
<li><a class="autorefs autorefs-internal" title="            za" href="#ts_stat_tests.algorithms.stationarity.za"><code>ts_stat_tests.algorithms.stationarity.za</code></a>: Zivot-Andrews structural break unit root test.</li>
<li><a class="autorefs autorefs-internal" title="            pp" href="#ts_stat_tests.algorithms.stationarity.pp"><code>ts_stat_tests.algorithms.stationarity.pp</code></a>: Phillips-Perron unit root test.</li>
<li><a class="autorefs autorefs-internal" title="            ers" href="#ts_stat_tests.algorithms.stationarity.ers"><code>ts_stat_tests.algorithms.stationarity.ers</code></a>: Elliot, Rothenberg and Stock's GLS-detrended Dickey-Fuller test.</li>
<li><a class="autorefs autorefs-internal" title="            vr" href="#ts_stat_tests.algorithms.stationarity.vr"><code>ts_stat_tests.algorithms.stationarity.vr</code></a>: Variance Ratio test of a random walk.</li>
</ul>
</details>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/ts_stat_tests/algorithms/stationarity.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@typechecked</span>
<span class="k">def</span><span class="w"> </span><span class="nf">kpss</span><span class="p">(</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
    <span class="n">regression</span><span class="p">:</span> <span class="n">VALID_KPSS_REGRESSION_OPTIONS</span> <span class="o">=</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span>
    <span class="n">nlags</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">VALID_KPSS_NLAGS_OPTIONS</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">store</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span>
    <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">ResultsStore</span><span class="p">],</span>
    <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">dict</span><span class="p">],</span>
<span class="p">]:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    !!! note &quot;Summary&quot;</span>
<span class="sd">        Computes the Kwiatkowski-Phillips-Schmidt-Shin (KPSS) test for the null hypothesis that `x` is level or trend stationary.</span>

<span class="sd">    ???+ abstract &quot;Details&quot;</span>

<span class="sd">        The Kwiatkowski-Phillips-Schmidt-Shin (KPSS) test is another statistical test used to determine whether a time series is stationary or not. The KPSS test is the opposite of the Augmented Dickey-Fuller (ADF) test, which tests for the presence of a unit root in the time series.</span>

<span class="sd">        The KPSS test involves regressing the time series on a constant and a time trend. The null hypothesis of the test is that the time series is stationary. The alternative hypothesis is that the time series has a unit root, which means that it is non-stationary.</span>

<span class="sd">        The test statistic is calculated by taking the sum of the squared residuals of the regression. If the test statistic is greater than a critical value at a given significance level, typically 0.05, then we reject the null hypothesis and conclude that the time series is non-stationary. If the test statistic is less than the critical value, then we fail to reject the null hypothesis and conclude that the time series is stationary.</span>

<span class="sd">        In practical terms, if a time series is found to be non-stationary by the KPSS test, one can apply differencing to the time series until it becomes stationary. This involves taking the difference between consecutive observations and potentially repeating this process until the time series is stationary.</span>

<span class="sd">        Overall, the ADF and KPSS tests are both important tools in time series analysis and forecasting, as they help identify whether a time series is stationary or non-stationary, which can have implications for the choice of forecasting models and methods.</span>

<span class="sd">    Params:</span>
<span class="sd">        x (ArrayLike):</span>
<span class="sd">            The data series to test.</span>
<span class="sd">        regression (VALID_KPSS_REGRESSION_OPTIONS, optional):</span>
<span class="sd">            The null hypothesis for the KPSS test.</span>

<span class="sd">            - `&quot;c&quot;`: The data is stationary around a constant (default).</span>
<span class="sd">            - `&quot;ct&quot;`: The data is stationary around a trend.</span>

<span class="sd">            Defaults to `&quot;c&quot;`.</span>
<span class="sd">        nlags (Optional[Union[VALID_KPSS_NLAGS_OPTIONS, int]], optional):</span>
<span class="sd">            Indicates the number of lags to be used.</span>

<span class="sd">            - If `&quot;auto&quot;` (default), `lags` is calculated using the data-dependent method of Hobijn et al. (1998). See also Andrews (1991), Newey &amp; West (1994), and Schwert (1989).</span>
<span class="sd">            - If set to `&quot;legacy&quot;`, uses $int(12 \\times (\\frac{n}{100})^{\\frac{1}{4}})$, as outlined in Schwert (1989).</span>

<span class="sd">            Defaults to `None`.</span>
<span class="sd">        store (bool, optional):</span>
<span class="sd">            If `True`, then a result instance is returned additionally to the KPSS statistic.&lt;br&gt;</span>
<span class="sd">            Defaults to `False`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (Union[tuple[float, float, int, dict, ResultsStore], tuple[float, float, int, dict]]):</span>
<span class="sd">            Returns a tuple containing:</span>
<span class="sd">            - `stat` (float): The KPSS test statistic.</span>
<span class="sd">            - `pvalue` (float): The p-value of the test.</span>
<span class="sd">            - `lags` (int): The truncation lag parameter.</span>
<span class="sd">            - `crit` (dict): The critical values at 10%, 5%, 2.5%, and 1%.</span>
<span class="sd">            - `resstore` (Optional[ResultsStore]): Result instance (if `store` is `True`).</span>

<span class="sd">    ???+ example &quot;Examples&quot;</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Setup&quot;}</span>
<span class="sd">        &gt;&gt;&gt; from ts_stat_tests.algorithms.stationarity import kpss</span>
<span class="sd">        &gt;&gt;&gt; from ts_stat_tests.utils.data import data_airline, data_normal</span>
<span class="sd">        &gt;&gt;&gt; normal = data_normal</span>
<span class="sd">        &gt;&gt;&gt; airline = data_airline.values</span>

<span class="sd">        ```</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Example 1: Stationary Series&quot;}</span>
<span class="sd">        &gt;&gt;&gt; stat, pvalue, lags, crit = kpss(x=normal)</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;KPSS statistic: {stat:.4f}&quot;)</span>
<span class="sd">        KPSS statistic: 0.0858</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;p-value: {pvalue:.4f}&quot;)</span>
<span class="sd">        p-value: 0.1000</span>

<span class="sd">        ```</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Example 2: Airline Passengers Data&quot;}</span>
<span class="sd">        &gt;&gt;&gt; stat, pvalue, lags, crit = kpss(x=airline)</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;p-value: {pvalue:.4f}&quot;)</span>
<span class="sd">        p-value: 0.0100</span>

<span class="sd">        ```</span>

<span class="sd">    ??? equation &quot;Calculation&quot;</span>

<span class="sd">        The mathematical equation for the KPSS test for stationarity in time series forecasting is:</span>

<span class="sd">        $$</span>
<span class="sd">        y_t = \mu_t + \epsilon_t</span>
<span class="sd">        $$</span>

<span class="sd">        where:</span>

<span class="sd">        - $y_t$ is the value of the time series at time $t$.</span>
<span class="sd">        - $\mu_t$ is the trend component of the time series.</span>
<span class="sd">        - $\epsilon_t$ is the error term.</span>

<span class="sd">        The KPSS test involves testing the null hypothesis that the time series is trend stationary, which means that the trend component of the time series is stationary over time. If the null hypothesis is rejected, then the time series is non-stationary and requires further pre-processing before it can be used for forecasting.</span>

<span class="sd">        Here are the detailed steps for how to calculate the KPSS test:</span>

<span class="sd">        1. Collect your time series data and plot it to visually check for any trends, seasonal patterns, or other patterns that could make the data non-stationary. If you detect any such patterns, you will need to pre-process your data (e.g., detrending, deseasonalizing, etc.) to remove these effects.</span>

<span class="sd">        1. Divide your time series data into multiple overlapping windows of equal size. The length of each window depends on the length of your time series and the level of detail you want to capture.</span>

<span class="sd">        1. Calculate the trend component $\mu_t$ for each window using a trend estimation method. There are several methods for estimating the trend component, such as the Hodrick-Prescott filter, the Christiano-Fitzgerald filter, or simple linear regression. The choice of method depends on the characteristics of your data and the level of accuracy you want to achieve.</span>

<span class="sd">        1. Calculate the residual series $\epsilon_t$ by subtracting the trend component from the original time series:</span>

<span class="sd">            $$</span>
<span class="sd">            \epsilon_t = y_t - \mu_t</span>
<span class="sd">            $$</span>

<span class="sd">        1. Estimate the variance of the residual series using a suitable estimator, such as the Newey-West estimator or the Bartlett kernel estimator. This step is necessary to correct for any serial correlation in the residual series.</span>

<span class="sd">        1. Calculate the test statistic, which is given by:</span>

<span class="sd">            $$</span>
<span class="sd">            KPSS = T \times \sum_{t=1}^T \frac {S_t^2} {\sigma^2}</span>
<span class="sd">            $$</span>

<span class="sd">            where:</span>

<span class="sd">            - $T$ is the number of observations in the time series.</span>
<span class="sd">            - $S_t$ is the cumulative sum of the residual series up to time $t$, i.e., $S_t = \sum_{i=1}^t \epsilon_i$.</span>
<span class="sd">            - $\sigma^2$ is the estimated variance of the residual series.</span>

<span class="sd">            The test statistic measures the strength of the trend component relative to the residual series. If KPSS is greater than the critical values from the KPSS distribution table, we can reject the null hypothesis and conclude that the time series is non-stationary.</span>

<span class="sd">        1. Finally, interpret the results and draw conclusions about the stationarity of the time series. If the null hypothesis is rejected, then the time series is non-stationary and requires further pre-processing before it can be used for forecasting. If the null hypothesis is not rejected, then the time series is trend stationary and can be used for forecasting.</span>

<span class="sd">    ??? note &quot;Notes&quot;</span>
<span class="sd">        To estimate $\sigma^2$ the Newey-West estimator is used. If `lags` is `&quot;legacy&quot;`, the truncation lag parameter is set to $int(12 \times (\frac{n}{100})^{\frac{1}{4}})$, as outlined in Schwert (1989). The p-values are interpolated from Table 1 of Kwiatkowski et al. (1992). If the computed statistic is outside the table of critical values, then a warning message is generated.</span>

<span class="sd">        Missing values are not handled.</span>

<span class="sd">    ??? success &quot;Credit&quot;</span>
<span class="sd">        - All credit goes to the [`statsmodels`](https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.kpss.html) library.</span>

<span class="sd">    ??? question &quot;References&quot;</span>
<span class="sd">        - Andrews, D.W.K. (1991). Heteroskedasticity and autocorrelation consistent covariance matrix estimation. Econometrica, 59: 817-858.</span>
<span class="sd">        - Hobijn, B., Frances, B.H., &amp; Ooms, M. (2004). Generalizations of the KPSS-test for stationarity. Statistica Neerlandica, 52: 483-502.</span>
<span class="sd">        - Kwiatkowski, D., Phillips, P.C.B., Schmidt, P., &amp; Shin, Y. (1992). Testing the null hypothesis of stationarity against the alternative of a unit root. Journal of Econometrics, 54: 159-178.</span>
<span class="sd">        - Newey, W.K., &amp; West, K.D. (1994). Automatic lag selection in covariance matrix estimation. Review of Economic Studies, 61: 631-653.</span>
<span class="sd">        - Schwert, G. W. (1989). Tests for unit roots: A Monte Carlo investigation. Journal of Business and Economic Statistics, 7 (2): 147-159.</span>

<span class="sd">    ??? tip &quot;See Also&quot;</span>
<span class="sd">        - [`statsmodels.tsa.stattools.adfuller`](https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.adfuller.html): Augmented Dickey-Fuller unit root test.</span>
<span class="sd">        - [`statsmodels.tsa.stattools.kpss`](https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.kpss.html): Kwiatkowski-Phillips-Schmidt-Shin stationarity test.</span>
<span class="sd">        - [`statsmodels.tsa.stattools.range_unit_root_test`](https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.range_unit_root_test.html): Range Unit-Root test.</span>
<span class="sd">        - [`statsmodels.tsa.stattools.zivot_andrews`](https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.zivot_andrews.html): Zivot-Andrews structural break test.</span>
<span class="sd">        - [`pmdarima.arima.PPTest`](https://alkaline-ml.com/pmdarima/modules/generated/pmdarima.arima.PPTest.html): Phillips-Perron unit root test.</span>
<span class="sd">        - [`arch.unitroot.DFGLS`](https://arch.readthedocs.io/en/latest/unitroot/generated/arch.unitroot.DFGLS.html): Elliot, Rothenberg and Stock&#39;s GLS-detrended Dickey-Fuller.</span>
<span class="sd">        - [`arch.unitroot.VarianceRatio`](https://arch.readthedocs.io/en/latest/unitroot/generated/arch.unitroot.VarianceRatio.html): Variance Ratio test of a random walk.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.stationarity.adf`][ts_stat_tests.algorithms.stationarity.adf]: Augmented Dickey-Fuller unit root test.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.stationarity.kpss`][ts_stat_tests.algorithms.stationarity.kpss]: Kwiatkowski-Phillips-Schmidt-Shin stationarity test.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.stationarity.rur`][ts_stat_tests.algorithms.stationarity.rur]: Range Unit-Root test of stationarity.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.stationarity.za`][ts_stat_tests.algorithms.stationarity.za]: Zivot-Andrews structural break unit root test.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.stationarity.pp`][ts_stat_tests.algorithms.stationarity.pp]: Phillips-Perron unit root test.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.stationarity.ers`][ts_stat_tests.algorithms.stationarity.ers]: Elliot, Rothenberg and Stock&#39;s GLS-detrended Dickey-Fuller test.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.stationarity.vr`][ts_stat_tests.algorithms.stationarity.vr]: Variance Ratio test of a random walk.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_nlags</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">VALID_KPSS_NLAGS_OPTIONS</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">nlags</span> <span class="k">if</span> <span class="n">nlags</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;auto&quot;</span>
    <span class="k">return</span> <span class="n">_kpss</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">regression</span><span class="o">=</span><span class="n">regression</span><span class="p">,</span> <span class="n">nlags</span><span class="o">=</span><span class="n">_nlags</span><span class="p">,</span> <span class="n">store</span><span class="o">=</span><span class="n">store</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="ts_stat_tests.algorithms.stationarity.rur" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">rur</span>


<a href="#ts_stat_tests.algorithms.stationarity.rur" class="headerlink" title="Permanent link">ðŸ”—</a></h4>
          <div class="doc-overloads">
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">rur</span><span class="p">(</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">store</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="kc">True</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">ResultsStore</span><span class="p">]</span>
</code></pre></div><div class="doc-signature highlight"><pre><span></span><code><span class="nf">rur</span><span class="p">(</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">store</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]</span>
</code></pre></div>          </div>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">rur</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">store</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span>
    <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">ResultsStore</span><span class="p">],</span>
    <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">dict</span><span class="p">],</span>
<span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <div class="admonition note">
<p class="admonition-title">Summary</p>
<p>Computes the Range Unit-Root (RUR) test for the null hypothesis that x is stationary.</p>
</div>
<details class="abstract" open="open">
<summary>Details</summary>
<p>The Range Unit-Root (RUR) test is a statistical test used to determine whether a time series is stationary or not. It is based on the range of the time series and does not require any knowledge of the underlying stochastic process.</p>
<p>The RUR test involves dividing the time series into non-overlapping windows of a fixed size and calculating the range of each window. Then, the range of the entire time series is calculated. If the time series is stationary, the range of the entire time series should be proportional to the square root of the window size. If the time series is non-stationary, the range of the entire time series will grow with the window size.</p>
<p>The null hypothesis of the RUR test is that the time series is non-stationary (unit root). The alternative hypothesis is that the time series is stationary. If the test statistic is less than a critical value at a given significance level, typically 0.05, then we reject the null hypothesis and conclude that the time series is stationary. If the test statistic is greater than the critical value, then we fail to reject the null hypothesis and conclude that the time series is non-stationary.</p>
<p>In practical terms, if a time series is found to be non-stationary by the RUR test, one can apply differencing to the time series until it becomes stationary. This involves taking the difference between consecutive observations and potentially repeating this process until the time series is stationary.</p>
<p>The RUR test is a simple and computationally efficient test for stationarity, but it may not be as powerful as other unit root tests in detecting non-stationarity in some cases. It is important to use multiple tests to determine the stationarity of a time series, as no single test is perfect in all situations.</p>
</details>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="numpy.typing.ArrayLike">ArrayLike</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The data series to test.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>store</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, then a result instance is returned additionally to the RUR statistic.<br>
Defaults to <code>False</code>.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="tuple">tuple</span>[<span title="float">float</span>, <span title="float">float</span>, <span title="dict">dict</span>, <span title="statsmodels.stats.diagnostic.ResultsStore">ResultsStore</span>], <span title="tuple">tuple</span>[<span title="float">float</span>, <span title="float">float</span>, <span title="dict">dict</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Returns a tuple containing:
- <code>stat</code> (float): The RUR test statistic.
- <code>pvalue</code> (float): The p-value of the test.
- <code>crit</code> (dict): The critical values at 10%, 5%, 2.5%, and 1%.
- <code>resstore</code> (Optional[ResultsStore]): Result instance (if <code>store</code> is <code>True</code>).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <details class="example" open="open">
<summary>Examples</summary>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Setup</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ts_stat_tests.utils.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">data_airline</span><span class="p">,</span> <span class="n">data_normal</span><span class="p">,</span> <span class="n">data_trend</span><span class="p">,</span> <span class="n">data_sine</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ts_stat_tests.algorithms.stationarity</span><span class="w"> </span><span class="kn">import</span> <span class="n">rur</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">normal</span> <span class="o">=</span> <span class="n">data_normal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trend</span> <span class="o">=</span> <span class="n">data_trend</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">seasonal</span> <span class="o">=</span> <span class="n">data_sine</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">airline</span> <span class="o">=</span> <span class="n">data_airline</span><span class="o">.</span><span class="n">values</span>
</code></pre></div></td></tr></table></div>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 1: Stationary Series</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">stat</span><span class="p">,</span> <span class="n">pvalue</span><span class="p">,</span> <span class="n">crit</span> <span class="o">=</span> <span class="n">rur</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">normal</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RUR statistic: </span><span class="si">{</span><span class="n">stat</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">RUR statistic: 0.3479</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;p-value: </span><span class="si">{</span><span class="n">pvalue</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">p-value: 0.0100</span>
</code></pre></div></td></tr></table></div>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 2: Trend-Stationary Series</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">stat</span><span class="p">,</span> <span class="n">pvalue</span><span class="p">,</span> <span class="n">crit</span> <span class="o">=</span> <span class="n">rur</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">trend</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RUR statistic: </span><span class="si">{</span><span class="n">stat</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">RUR statistic: 31.5912</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;p-value: </span><span class="si">{</span><span class="n">pvalue</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">p-value: 0.9500</span>
</code></pre></div></td></tr></table></div>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 3: Seasonal Series</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">stat</span><span class="p">,</span> <span class="n">pvalue</span><span class="p">,</span> <span class="n">crit</span> <span class="o">=</span> <span class="n">rur</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">seasonal</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RUR statistic: </span><span class="si">{</span><span class="n">stat</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">RUR statistic: 0.9129</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;p-value: </span><span class="si">{</span><span class="n">pvalue</span><span class="si">:</span><span class="s2">.04f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">p-value: 0.0100</span>
</code></pre></div></td></tr></table></div>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 4: Real-World Time Series</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">stat</span><span class="p">,</span> <span class="n">pvalue</span><span class="p">,</span> <span class="n">crit</span> <span class="o">=</span> <span class="n">rur</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">airline</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RUR statistic: </span><span class="si">{</span><span class="n">stat</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">RUR statistic: 2.3333</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;p-value: </span><span class="si">{</span><span class="n">pvalue</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">p-value: 0.9000</span>
</code></pre></div></td></tr></table></div>
</details>
<details class="equation">
<summary>Calculation</summary>
<p>The mathematical equation for the RUR test is:</p>
<div class="arithmatex">\[
y_t = \rho y_{t-1} + \epsilon_t
\]</div>
<p>where:</p>
<ul>
<li><span class="arithmatex">\(y_t\)</span> is the value of the time series at time <span class="arithmatex">\(t\)</span>.</li>
<li><span class="arithmatex">\(\rho\)</span> is the parameter of the unit root process.</li>
<li><span class="arithmatex">\(y_{t-1}\)</span> is the value of the time series at time <span class="arithmatex">\(t-1\)</span>.</li>
<li><span class="arithmatex">\(\epsilon_t\)</span> is a stationary error term with mean zero and constant variance.</li>
</ul>
<p>The null hypothesis of the RUR test is that the time series is stationary, and the alternative hypothesis is that the time series is non-stationary with a unit root.</p>
<p>Here are the detailed steps for how to calculate the RUR test:</p>
<ol>
<li>
<p>Collect your time series data and plot it to visually check for any trends, seasonal patterns, or other patterns that could make the data non-stationary. If you detect any such patterns, you will need to pre-process your data (e.g., detrending, deseasonalizing, etc.) to remove these effects.</p>
</li>
<li>
<p>Estimate the parameter <span class="arithmatex">\(\rho\)</span> using the ordinary least squares method. This involves regressing <span class="arithmatex">\(y_t\)</span> on <span class="arithmatex">\(y_{t-1}\)</span>. The estimated equation is:</p>
<div class="arithmatex">\[
y_t = \alpha + \rho y_{t-1} + \epsilon_t
\]</div>
<p>where:</p>
<ul>
<li><span class="arithmatex">\(\alpha\)</span> is the intercept.</li>
<li><span class="arithmatex">\(\epsilon_t\)</span> is the error term.</li>
</ul>
</li>
<li>
<p>Calculate the range of the time series, which is the difference between the maximum and minimum values of the time series:</p>
<div class="arithmatex">\[
R = \max(y_t) - \min(y_t)
\]</div>
</li>
<li>
<p>Calculate the expected range of the time series under the null hypothesis of stationarity, which is given by:</p>
<div class="arithmatex">\[
E(R) = \frac {T - 1} {2 \sqrt{T}}
\]</div>
<p>where:</p>
<ul>
<li><span class="arithmatex">\(T\)</span> is the sample size.</li>
</ul>
</li>
<li>
<p>Calculate the test statistic, which is given by:</p>
<div class="arithmatex">\[
RUR = \frac {R - E(R)} {E(R)}
\]</div>
</li>
<li>
<p>Compare the test statistic to the critical values in the RUR distribution table to determine the level of significance. The critical values depend on the sample size and the level of significance.</p>
</li>
<li>
<p>Finally, interpret the results and draw conclusions about the stationarity of the time series. If the null hypothesis is rejected, then the time series is non-stationary with a unit root. If the null hypothesis is not rejected, then the time series is stationary.</p>
</li>
</ol>
<p>In practice, the RUR test is often conducted using software packages such as R, Python, or MATLAB, which automate the estimation of parameters and calculation of the test statistic.</p>
</details>
<details class="note">
<summary>Notes</summary>
<p>The p-values are interpolated from Table 1 of Aparicio et al. (2006). If the computed statistic is outside the table of critical values, then a warning message is generated.</p>
<p>Missing values are not handled.</p>
</details>
<div class="admonition success">
<p class="admonition-title">Credit</p>
<ul>
<li>All credit goes to the <a href="https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.range_unit_root_test.html"><code>statsmodels</code></a> library.</li>
</ul>
</div>
<details class="question">
<summary>References</summary>
<ul>
<li>Aparicio, F., Escribano A., Sipols, A.E. (2006). Range Unit-Root (RUR) tests: robust against nonlinearities, error distributions, structural breaks and outliers. Journal of Time Series Analysis, 27 (4): 545-576.</li>
</ul>
</details>
<details class="tip">
<summary>See Also</summary>
<ul>
<li><a href="https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.adfuller.html"><code>statsmodels.tsa.stattools.adfuller</code></a>: Augmented Dickey-Fuller unit root test.</li>
<li><a href="https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.kpss.html"><code>statsmodels.tsa.stattools.kpss</code></a>: Kwiatkowski-Phillips-Schmidt-Shin stationarity test.</li>
<li><a href="https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.range_unit_root_test.html"><code>statsmodels.tsa.stattools.range_unit_root_test</code></a>: Range Unit-Root test.</li>
<li><a href="https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.zivot_andrews.html"><code>statsmodels.tsa.stattools.zivot_andrews</code></a>: Zivot-Andrews structural break test.</li>
<li><a href="https://alkaline-ml.com/pmdarima/modules/generated/pmdarima.arima.PPTest.html"><code>pmdarima.arima.PPTest</code></a>: Phillips-Perron unit root test.</li>
<li><a href="https://arch.readthedocs.io/en/latest/unitroot/generated/arch.unitroot.DFGLS.html"><code>arch.unitroot.DFGLS</code></a>: Elliot, Rothenberg and Stock's GLS-detrended Dickey-Fuller.</li>
<li><a href="https://arch.readthedocs.io/en/latest/unitroot/generated/arch.unitroot.VarianceRatio.html"><code>arch.unitroot.VarianceRatio</code></a>: Variance Ratio test of a random walk.</li>
<li><a class="autorefs autorefs-internal" title="            adf" href="#ts_stat_tests.algorithms.stationarity.adf"><code>ts_stat_tests.algorithms.stationarity.adf</code></a>: Augmented Dickey-Fuller unit root test.</li>
<li><a class="autorefs autorefs-internal" title="            kpss" href="#ts_stat_tests.algorithms.stationarity.kpss"><code>ts_stat_tests.algorithms.stationarity.kpss</code></a>: Kwiatkowski-Phillips-Schmidt-Shin stationarity test.</li>
<li><a class="autorefs autorefs-internal" title="            rur" href="#ts_stat_tests.algorithms.stationarity.rur"><code>ts_stat_tests.algorithms.stationarity.rur</code></a>: Range Unit-Root test of stationarity.</li>
<li><a class="autorefs autorefs-internal" title="            za" href="#ts_stat_tests.algorithms.stationarity.za"><code>ts_stat_tests.algorithms.stationarity.za</code></a>: Zivot-Andrews structural break unit root test.</li>
<li><a class="autorefs autorefs-internal" title="            pp" href="#ts_stat_tests.algorithms.stationarity.pp"><code>ts_stat_tests.algorithms.stationarity.pp</code></a>: Phillips-Perron unit root test.</li>
<li><a class="autorefs autorefs-internal" title="            ers" href="#ts_stat_tests.algorithms.stationarity.ers"><code>ts_stat_tests.algorithms.stationarity.ers</code></a>: Elliot, Rothenberg and Stock's GLS-detrended Dickey-Fuller test.</li>
<li><a class="autorefs autorefs-internal" title="            vr" href="#ts_stat_tests.algorithms.stationarity.vr"><code>ts_stat_tests.algorithms.stationarity.vr</code></a>: Variance Ratio test of a random walk.</li>
</ul>
</details>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/ts_stat_tests/algorithms/stationarity.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@typechecked</span>
<span class="k">def</span><span class="w"> </span><span class="nf">rur</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">store</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span>
    <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">ResultsStore</span><span class="p">],</span>
    <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">dict</span><span class="p">],</span>
<span class="p">]:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    !!! note &quot;Summary&quot;</span>
<span class="sd">        Computes the Range Unit-Root (RUR) test for the null hypothesis that x is stationary.</span>

<span class="sd">    ???+ abstract &quot;Details&quot;</span>

<span class="sd">        The Range Unit-Root (RUR) test is a statistical test used to determine whether a time series is stationary or not. It is based on the range of the time series and does not require any knowledge of the underlying stochastic process.</span>

<span class="sd">        The RUR test involves dividing the time series into non-overlapping windows of a fixed size and calculating the range of each window. Then, the range of the entire time series is calculated. If the time series is stationary, the range of the entire time series should be proportional to the square root of the window size. If the time series is non-stationary, the range of the entire time series will grow with the window size.</span>

<span class="sd">        The null hypothesis of the RUR test is that the time series is non-stationary (unit root). The alternative hypothesis is that the time series is stationary. If the test statistic is less than a critical value at a given significance level, typically 0.05, then we reject the null hypothesis and conclude that the time series is stationary. If the test statistic is greater than the critical value, then we fail to reject the null hypothesis and conclude that the time series is non-stationary.</span>

<span class="sd">        In practical terms, if a time series is found to be non-stationary by the RUR test, one can apply differencing to the time series until it becomes stationary. This involves taking the difference between consecutive observations and potentially repeating this process until the time series is stationary.</span>

<span class="sd">        The RUR test is a simple and computationally efficient test for stationarity, but it may not be as powerful as other unit root tests in detecting non-stationarity in some cases. It is important to use multiple tests to determine the stationarity of a time series, as no single test is perfect in all situations.</span>

<span class="sd">    Params:</span>
<span class="sd">        x (ArrayLike):</span>
<span class="sd">            The data series to test.</span>
<span class="sd">        store (bool, optional):</span>
<span class="sd">            If `True`, then a result instance is returned additionally to the RUR statistic.&lt;br&gt;</span>
<span class="sd">            Defaults to `False`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (Union[tuple[float, float, dict, ResultsStore], tuple[float, float, dict]]):</span>
<span class="sd">            Returns a tuple containing:</span>
<span class="sd">            - `stat` (float): The RUR test statistic.</span>
<span class="sd">            - `pvalue` (float): The p-value of the test.</span>
<span class="sd">            - `crit` (dict): The critical values at 10%, 5%, 2.5%, and 1%.</span>
<span class="sd">            - `resstore` (Optional[ResultsStore]): Result instance (if `store` is `True`).</span>

<span class="sd">    ???+ example &quot;Examples&quot;</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Setup&quot;}</span>
<span class="sd">        &gt;&gt;&gt; from ts_stat_tests.utils.data import data_airline, data_normal, data_trend, data_sine</span>
<span class="sd">        &gt;&gt;&gt; from ts_stat_tests.algorithms.stationarity import rur</span>
<span class="sd">        &gt;&gt;&gt; normal = data_normal</span>
<span class="sd">        &gt;&gt;&gt; trend = data_trend</span>
<span class="sd">        &gt;&gt;&gt; seasonal = data_sine</span>
<span class="sd">        &gt;&gt;&gt; airline = data_airline.values</span>

<span class="sd">        ```</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Example 1: Stationary Series&quot;}</span>
<span class="sd">        &gt;&gt;&gt; stat, pvalue, crit = rur(x=normal)</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;RUR statistic: {stat:.4f}&quot;)</span>
<span class="sd">        RUR statistic: 0.3479</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;p-value: {pvalue:.4f}&quot;)</span>
<span class="sd">        p-value: 0.0100</span>

<span class="sd">        ```</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Example 2: Trend-Stationary Series&quot;}</span>
<span class="sd">        &gt;&gt;&gt; stat, pvalue, crit = rur(x=trend)</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;RUR statistic: {stat:.4f}&quot;)</span>
<span class="sd">        RUR statistic: 31.5912</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;p-value: {pvalue:.4f}&quot;)</span>
<span class="sd">        p-value: 0.9500</span>

<span class="sd">        ```</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Example 3: Seasonal Series&quot;}</span>
<span class="sd">        &gt;&gt;&gt; stat, pvalue, crit = rur(x=seasonal)</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;RUR statistic: {stat:.4f}&quot;)</span>
<span class="sd">        RUR statistic: 0.9129</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;p-value: {pvalue:.04f}&quot;)</span>
<span class="sd">        p-value: 0.0100</span>

<span class="sd">        ```</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Example 4: Real-World Time Series&quot;}</span>
<span class="sd">        &gt;&gt;&gt; stat, pvalue, crit = rur(x=airline)</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;RUR statistic: {stat:.4f}&quot;)</span>
<span class="sd">        RUR statistic: 2.3333</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;p-value: {pvalue:.4f}&quot;)</span>
<span class="sd">        p-value: 0.9000</span>

<span class="sd">        ```</span>

<span class="sd">    ??? equation &quot;Calculation&quot;</span>

<span class="sd">        The mathematical equation for the RUR test is:</span>

<span class="sd">        $$</span>
<span class="sd">        y_t = \rho y_{t-1} + \epsilon_t</span>
<span class="sd">        $$</span>

<span class="sd">        where:</span>

<span class="sd">        - $y_t$ is the value of the time series at time $t$.</span>
<span class="sd">        - $\rho$ is the parameter of the unit root process.</span>
<span class="sd">        - $y_{t-1}$ is the value of the time series at time $t-1$.</span>
<span class="sd">        - $\epsilon_t$ is a stationary error term with mean zero and constant variance.</span>

<span class="sd">        The null hypothesis of the RUR test is that the time series is stationary, and the alternative hypothesis is that the time series is non-stationary with a unit root.</span>

<span class="sd">        Here are the detailed steps for how to calculate the RUR test:</span>

<span class="sd">        1. Collect your time series data and plot it to visually check for any trends, seasonal patterns, or other patterns that could make the data non-stationary. If you detect any such patterns, you will need to pre-process your data (e.g., detrending, deseasonalizing, etc.) to remove these effects.</span>

<span class="sd">        1. Estimate the parameter $\rho$ using the ordinary least squares method. This involves regressing $y_t$ on $y_{t-1}$. The estimated equation is:</span>

<span class="sd">            $$</span>
<span class="sd">            y_t = \alpha + \rho y_{t-1} + \epsilon_t</span>
<span class="sd">            $$</span>

<span class="sd">            where:</span>

<span class="sd">            - $\alpha$ is the intercept.</span>
<span class="sd">            - $\epsilon_t$ is the error term.</span>

<span class="sd">        1. Calculate the range of the time series, which is the difference between the maximum and minimum values of the time series:</span>

<span class="sd">            $$</span>
<span class="sd">            R = \max(y_t) - \min(y_t)</span>
<span class="sd">            $$</span>

<span class="sd">        1. Calculate the expected range of the time series under the null hypothesis of stationarity, which is given by:</span>

<span class="sd">            $$</span>
<span class="sd">            E(R) = \frac {T - 1} {2 \sqrt{T}}</span>
<span class="sd">            $$</span>

<span class="sd">            where:</span>

<span class="sd">            - $T$ is the sample size.</span>

<span class="sd">        1. Calculate the test statistic, which is given by:</span>

<span class="sd">            $$</span>
<span class="sd">            RUR = \frac {R - E(R)} {E(R)}</span>
<span class="sd">            $$</span>

<span class="sd">        1. Compare the test statistic to the critical values in the RUR distribution table to determine the level of significance. The critical values depend on the sample size and the level of significance.</span>

<span class="sd">        1. Finally, interpret the results and draw conclusions about the stationarity of the time series. If the null hypothesis is rejected, then the time series is non-stationary with a unit root. If the null hypothesis is not rejected, then the time series is stationary.</span>

<span class="sd">        In practice, the RUR test is often conducted using software packages such as R, Python, or MATLAB, which automate the estimation of parameters and calculation of the test statistic.</span>

<span class="sd">    ??? note &quot;Notes&quot;</span>
<span class="sd">        The p-values are interpolated from Table 1 of Aparicio et al. (2006). If the computed statistic is outside the table of critical values, then a warning message is generated.</span>

<span class="sd">        Missing values are not handled.</span>

<span class="sd">    !!! success &quot;Credit&quot;</span>
<span class="sd">        - All credit goes to the [`statsmodels`](https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.range_unit_root_test.html) library.</span>

<span class="sd">    ??? question &quot;References&quot;</span>
<span class="sd">        - Aparicio, F., Escribano A., Sipols, A.E. (2006). Range Unit-Root (RUR) tests: robust against nonlinearities, error distributions, structural breaks and outliers. Journal of Time Series Analysis, 27 (4): 545-576.</span>

<span class="sd">    ??? tip &quot;See Also&quot;</span>
<span class="sd">        - [`statsmodels.tsa.stattools.adfuller`](https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.adfuller.html): Augmented Dickey-Fuller unit root test.</span>
<span class="sd">        - [`statsmodels.tsa.stattools.kpss`](https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.kpss.html): Kwiatkowski-Phillips-Schmidt-Shin stationarity test.</span>
<span class="sd">        - [`statsmodels.tsa.stattools.range_unit_root_test`](https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.range_unit_root_test.html): Range Unit-Root test.</span>
<span class="sd">        - [`statsmodels.tsa.stattools.zivot_andrews`](https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.zivot_andrews.html): Zivot-Andrews structural break test.</span>
<span class="sd">        - [`pmdarima.arima.PPTest`](https://alkaline-ml.com/pmdarima/modules/generated/pmdarima.arima.PPTest.html): Phillips-Perron unit root test.</span>
<span class="sd">        - [`arch.unitroot.DFGLS`](https://arch.readthedocs.io/en/latest/unitroot/generated/arch.unitroot.DFGLS.html): Elliot, Rothenberg and Stock&#39;s GLS-detrended Dickey-Fuller.</span>
<span class="sd">        - [`arch.unitroot.VarianceRatio`](https://arch.readthedocs.io/en/latest/unitroot/generated/arch.unitroot.VarianceRatio.html): Variance Ratio test of a random walk.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.stationarity.adf`][ts_stat_tests.algorithms.stationarity.adf]: Augmented Dickey-Fuller unit root test.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.stationarity.kpss`][ts_stat_tests.algorithms.stationarity.kpss]: Kwiatkowski-Phillips-Schmidt-Shin stationarity test.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.stationarity.rur`][ts_stat_tests.algorithms.stationarity.rur]: Range Unit-Root test of stationarity.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.stationarity.za`][ts_stat_tests.algorithms.stationarity.za]: Zivot-Andrews structural break unit root test.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.stationarity.pp`][ts_stat_tests.algorithms.stationarity.pp]: Phillips-Perron unit root test.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.stationarity.ers`][ts_stat_tests.algorithms.stationarity.ers]: Elliot, Rothenberg and Stock&#39;s GLS-detrended Dickey-Fuller test.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.stationarity.vr`][ts_stat_tests.algorithms.stationarity.vr]: Variance Ratio test of a random walk.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_rur</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">store</span><span class="o">=</span><span class="n">store</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="ts_stat_tests.algorithms.stationarity.za" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">za</span>


<a href="#ts_stat_tests.algorithms.stationarity.za" class="headerlink" title="Permanent link">ðŸ”—</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">za</span><span class="p">(</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
    <span class="n">trim</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.15</span><span class="p">,</span>
    <span class="n">maxlag</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">regression</span><span class="p">:</span> <span class="n">VALID_ZA_REGRESSION_OPTIONS</span> <span class="o">=</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span>
    <span class="n">autolag</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">VALID_ZA_AUTOLAG_OPTIONS</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;AIC&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">dict</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <div class="admonition note">
<p class="admonition-title">Summary</p>
<p>The Zivot-Andrews (ZA) test tests for a unit root in a univariate process in the presence of serial correlation and a single structural break.</p>
</div>
<details class="abstract" open="open">
<summary>Details</summary>
<p>The Zivot-Andrews (ZA) test is a statistical test used to determine whether a time series is stationary or not in the presence of structural breaks. Structural breaks refer to significant changes in the underlying stochastic process of the time series, which can cause non-stationarity.</p>
<p>The ZA test involves running a regression of the time series on a constant and a linear time trend, and testing whether the residuals of the regression are stationary or not. The null hypothesis of the test is that the time series is stationary with a single break point, while the alternative hypothesis is that the time series is non-stationary with a single break point.</p>
<p>The test statistic is calculated by first estimating the break point using a likelihood ratio test. Then, the test statistic is calculated based on the estimated break point and the residuals of the regression. If the test statistic is greater than a critical value at a given significance level, typically 0.05, then we reject the null hypothesis and conclude that the time series is non-stationary with a structural break. If the test statistic is less than the critical value, then we fail to reject the null hypothesis and conclude that the time series is stationary with a structural break.</p>
<p>In practical terms, if a time series is found to be non-stationary with a structural break by the ZA test, one can apply methods to account for the structural break, such as including dummy variables in the regression or using time series models that allow for structural breaks.</p>
<p>Overall, the ZA test is a useful tool in time series analysis and forecasting when there is a suspicion of structural breaks in the data. However, it is important to note that the test may not detect multiple break points or breaks that are not well-separated in time.</p>
</details>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="numpy.typing.ArrayLike">ArrayLike</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The data series to test.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>trim</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The percentage of series at begin/end to exclude.
Default: <code>0.15</code></p>
              </div>
            </td>
            <td>
                  <code>0.15</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>maxlag</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The maximum lag which is included in test.
Default: <code>None</code></p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>regression</code>
            </td>
            <td>
                  <code><span title="ts_stat_tests.algorithms.stationarity.VALID_ZA_REGRESSION_OPTIONS">VALID_ZA_REGRESSION_OPTIONS</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Constant and trend order to include in regression.</p>
<ul>
<li><code>"c"</code>: constant only (default).</li>
<li><code>"t"</code>: trend only.</li>
<li><code>"ct"</code>: constant and trend.</li>
</ul>
<p>Default: <code>"c"</code></p>
              </div>
            </td>
            <td>
                  <code>&#39;c&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>autolag</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="ts_stat_tests.algorithms.stationarity.VALID_ZA_AUTOLAG_OPTIONS">VALID_ZA_AUTOLAG_OPTIONS</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The method to select the lag length.</p>
<ul>
<li>If <code>None</code>, then <code>maxlag</code> lags are used.</li>
<li>If <code>"AIC"</code> (default) or <code>"BIC"</code>, then the number of lags is chosen.</li>
</ul>
<p>Default: <code>"AIC"</code></p>
              </div>
            </td>
            <td>
                  <code>&#39;AIC&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<span title="float">float</span>, <span title="float">float</span>, <span title="dict">dict</span>, <span title="int">int</span>, <span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Returns a tuple containing:
- <code>zastat</code> (float): The test statistic.
- <code>pvalue</code> (float): The p-value.
- <code>cvdict</code> (dict): Critical values at the <span class="arithmatex">\(1\%\)</span>, <span class="arithmatex">\(5\%\)</span>, and <span class="arithmatex">\(10\%\)</span> levels.
- <code>baselag</code> (int): Lags used for period regressions.
- <code>pbidx</code> (int): Break period index.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <details class="example" open="open">
<summary>Examples</summary>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Setup</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ts_stat_tests.utils.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">data_airline</span><span class="p">,</span> <span class="n">data_normal</span><span class="p">,</span> <span class="n">data_noise</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ts_stat_tests.algorithms.stationarity</span><span class="w"> </span><span class="kn">import</span> <span class="n">za</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">normal</span> <span class="o">=</span> <span class="n">data_normal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">noise</span> <span class="o">=</span> <span class="n">data_noise</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">airline</span> <span class="o">=</span> <span class="n">data_airline</span><span class="o">.</span><span class="n">values</span>
</code></pre></div></td></tr></table></div>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 1: Stationary Series</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">stat</span><span class="p">,</span> <span class="n">pvalue</span><span class="p">,</span> <span class="n">crit</span><span class="p">,</span> <span class="n">lags</span><span class="p">,</span> <span class="n">break_idx</span> <span class="o">=</span> <span class="n">za</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">normal</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ZA statistic: </span><span class="si">{</span><span class="n">stat</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">ZA statistic: -30.8800</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;p-value: </span><span class="si">{</span><span class="n">pvalue</span><span class="si">:</span><span class="s2">.4e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">p-value: 1.0000e-05</span>
</code></pre></div></td></tr></table></div>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 2: Noisy Series</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">stat</span><span class="p">,</span> <span class="n">pvalue</span><span class="p">,</span> <span class="n">crit</span><span class="p">,</span> <span class="n">lags</span><span class="p">,</span> <span class="n">break_idx</span> <span class="o">=</span> <span class="n">za</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">noise</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ZA statistic: </span><span class="si">{</span><span class="n">stat</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">ZA statistic: -32.4316</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;p-value: </span><span class="si">{</span><span class="n">pvalue</span><span class="si">:</span><span class="s2">.4e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">p-value: 1.0000e-05</span>
</code></pre></div></td></tr></table></div>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 3: Real-World Time Series</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">stat</span><span class="p">,</span> <span class="n">pvalue</span><span class="p">,</span> <span class="n">crit</span><span class="p">,</span> <span class="n">lags</span><span class="p">,</span> <span class="n">break_idx</span> <span class="o">=</span> <span class="n">za</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">airline</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ZA statistic: </span><span class="si">{</span><span class="n">stat</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">ZA statistic: -3.6508</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;p-value: </span><span class="si">{</span><span class="n">pvalue</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">p-value: 0.5808</span>
</code></pre></div></td></tr></table></div>
</details>
<details class="equation">
<summary>Calculation</summary>
<p>The mathematical equation for the Zivot-Andrews test is:</p>
<div class="arithmatex">\[
y_t = \alpha + \beta t + \gamma y_{t-1} + \delta_1 D_t + \delta_2 t D_t + \epsilon_t
\]</div>
<p>where:</p>
<ul>
<li><span class="arithmatex">\(y_t\)</span> is the value of the time series at time <span class="arithmatex">\(t\)</span>.</li>
<li><span class="arithmatex">\(\alpha\)</span> is the intercept.</li>
<li><span class="arithmatex">\(\beta\)</span> is the slope coefficient of the time trend.</li>
<li><span class="arithmatex">\(\gamma\)</span> is the coefficient of the lagged dependent variable.</li>
<li><span class="arithmatex">\(D_t\)</span> is a dummy variable that takes a value of 1 after the suspected structural break point, and 0 otherwise.</li>
<li><span class="arithmatex">\(\delta_1\)</span> and <span class="arithmatex">\(\delta_2\)</span> are the coefficients of the dummy variable and the interaction term of the dummy variable and time trend, respectively.</li>
<li><span class="arithmatex">\(\epsilon_t\)</span> is a stationary error term with mean zero and constant variance.</li>
</ul>
<p>The null hypothesis of the Zivot-Andrews test is that the time series is non-stationary, and the alternative hypothesis is that the time series is stationary with a single structural break.</p>
<p>Here are the detailed steps for how to calculate the Zivot-Andrews test:</p>
<ol>
<li>
<p>Collect your time series data and plot it to visually check for any trends, seasonal patterns, or other patterns that could make the data non-stationary. If you detect any such patterns, you will need to pre-process your data (e.g., detrending, deseasonalizing, etc.) to remove these effects.</p>
</li>
<li>
<p>Estimate the parameters of the model using the least squares method. This involves regressing <span class="arithmatex">\(y_t\)</span> on <span class="arithmatex">\(t\)</span>, <span class="arithmatex">\(y_{t-1}\)</span>, <span class="arithmatex">\(D_t\)</span>, and <span class="arithmatex">\(t D_t\)</span>. The estimated equation is:</p>
<div class="arithmatex">\[
y_t = \alpha + \beta t + \gamma y_{t-1} + \delta_1 D_t + \delta_2 t D_t + \epsilon_t
\]</div>
</li>
<li>
<p>Perform a unit root test on the residuals to check for stationarity. The most commonly used unit root tests for this purpose are the Augmented Dickey-Fuller (ADF) test and the Phillips-Perron (PP) test.</p>
</li>
<li>
<p>Calculate the test statistic, which is based on the largest root of the following equation:</p>
<div class="arithmatex">\[
\Delta y_t = \alpha + \beta t + \gamma y_{t-1} + \delta_1 D_t + \delta_2 t D_t + \epsilon_t
\]</div>
<p>where:</p>
<ul>
<li><span class="arithmatex">\(\Delta\)</span> is the first difference operator.</li>
</ul>
</li>
<li>
<p>Determine the critical values of the test statistic from the Zivot-Andrews distribution table. The critical values depend on the sample size, the level of significance, and the number of lagged dependent variables in the model.</p>
</li>
<li>
<p>Finally, interpret the results and draw conclusions about the stationarity of the time series. If the null hypothesis is rejected, then the time series is stationary with a structural break. If the null hypothesis is not rejected, then the time series is non-stationary and may require further processing to make it stationary.</p>
</li>
</ol>
<p>In practice, the Zivot-Andrews test is often conducted using software packages such as R, Python, or MATLAB, which automate the estimation of parameters and calculation of the test statistic.</p>
</details>
<details class="note">
<summary>Notes</summary>
<p>H0 = unit root with a single structural break</p>
<p>Algorithm follows Baum (2004/2015) approximation to original Zivot-Andrews method. Rather than performing an autolag regression at each candidate break period (as per the original paper), a single autolag regression is run up-front on the base model (constant + trend with no dummies) to determine the best lag length. This lag length is then used for all subsequent break-period regressions. This results in significant run time reduction but also slightly more pessimistic test statistics than the original Zivot-Andrews method, although no attempt has been made to characterize the size/power trade-off.</p>
</details>
<details class="success">
<summary>Credit</summary>
<ul>
<li>All credit goes to the <a href="https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.zivot_andrews.html"><code>statsmodels</code></a> library.</li>
</ul>
</details>
<details class="question">
<summary>References</summary>
<ul>
<li>Baum, C.F. (2004). ZANDREWS: Stata module to calculate Zivot-Andrews unit root test in presence of structural break," Statistical Software Components S437301, Boston College Department of Economics, revised 2015.</li>
<li>Schwert, G.W. (1989). Tests for unit roots: A Monte Carlo investigation. Journal of Business &amp; Economic Statistics, 7: 147-159.</li>
<li>Zivot, E., and Andrews, D.W.K. (1992). Further evidence on the great crash, the oil-price shock, and the unit-root hypothesis. Journal of Business &amp; Economic Studies, 10: 251-270.</li>
</ul>
</details>
<details class="tip">
<summary>See Also</summary>
<ul>
<li><a href="https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.adfuller.html"><code>statsmodels.tsa.stattools.adfuller</code></a>: Augmented Dickey-Fuller unit root test.</li>
<li><a href="https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.kpss.html"><code>statsmodels.tsa.stattools.kpss</code></a>: Kwiatkowski-Phillips-Schmidt-Shin stationarity test.</li>
<li><a href="https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.range_unit_root_test.html"><code>statsmodels.tsa.stattools.range_unit_root_test</code></a>: Range Unit-Root test.</li>
<li><a href="https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.zivot_andrews.html"><code>statsmodels.tsa.stattools.zivot_andrews</code></a>: Zivot-Andrews structural break test.</li>
<li><a href="https://alkaline-ml.com/pmdarima/modules/generated/pmdarima.arima.PPTest.html"><code>pmdarima.arima.PPTest</code></a>: Phillips-Perron unit root test.</li>
<li><a href="https://arch.readthedocs.io/en/latest/unitroot/generated/arch.unitroot.DFGLS.html"><code>arch.unitroot.DFGLS</code></a>: Elliot, Rothenberg and Stock's GLS-detrended Dickey-Fuller.</li>
<li><a href="https://arch.readthedocs.io/en/latest/unitroot/generated/arch.unitroot.VarianceRatio.html"><code>arch.unitroot.VarianceRatio</code></a>: Variance Ratio test of a random walk.</li>
<li><a class="autorefs autorefs-internal" title="            adf" href="#ts_stat_tests.algorithms.stationarity.adf"><code>ts_stat_tests.algorithms.stationarity.adf</code></a>: Augmented Dickey-Fuller unit root test.</li>
<li><a class="autorefs autorefs-internal" title="            kpss" href="#ts_stat_tests.algorithms.stationarity.kpss"><code>ts_stat_tests.algorithms.stationarity.kpss</code></a>: Kwiatkowski-Phillips-Schmidt-Shin stationarity test.</li>
<li><a class="autorefs autorefs-internal" title="            rur" href="#ts_stat_tests.algorithms.stationarity.rur"><code>ts_stat_tests.algorithms.stationarity.rur</code></a>: Range Unit-Root test of stationarity.</li>
<li><a class="autorefs autorefs-internal" title="            za" href="#ts_stat_tests.algorithms.stationarity.za"><code>ts_stat_tests.algorithms.stationarity.za</code></a>: Zivot-Andrews structural break unit root test.</li>
<li><a class="autorefs autorefs-internal" title="            pp" href="#ts_stat_tests.algorithms.stationarity.pp"><code>ts_stat_tests.algorithms.stationarity.pp</code></a>: Phillips-Perron unit root test.</li>
<li><a class="autorefs autorefs-internal" title="            ers" href="#ts_stat_tests.algorithms.stationarity.ers"><code>ts_stat_tests.algorithms.stationarity.ers</code></a>: Elliot, Rothenberg and Stock's GLS-detrended Dickey-Fuller test.</li>
<li><a class="autorefs autorefs-internal" title="            vr" href="#ts_stat_tests.algorithms.stationarity.vr"><code>ts_stat_tests.algorithms.stationarity.vr</code></a>: Variance Ratio test of a random walk.</li>
</ul>
</details>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/ts_stat_tests/algorithms/stationarity.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@typechecked</span>
<span class="k">def</span><span class="w"> </span><span class="nf">za</span><span class="p">(</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
    <span class="n">trim</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.15</span><span class="p">,</span>
    <span class="n">maxlag</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">regression</span><span class="p">:</span> <span class="n">VALID_ZA_REGRESSION_OPTIONS</span> <span class="o">=</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span>
    <span class="n">autolag</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">VALID_ZA_AUTOLAG_OPTIONS</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;AIC&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">dict</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    !!! note &quot;Summary&quot;</span>
<span class="sd">        The Zivot-Andrews (ZA) test tests for a unit root in a univariate process in the presence of serial correlation and a single structural break.</span>

<span class="sd">    ???+ abstract &quot;Details&quot;</span>
<span class="sd">        The Zivot-Andrews (ZA) test is a statistical test used to determine whether a time series is stationary or not in the presence of structural breaks. Structural breaks refer to significant changes in the underlying stochastic process of the time series, which can cause non-stationarity.</span>

<span class="sd">        The ZA test involves running a regression of the time series on a constant and a linear time trend, and testing whether the residuals of the regression are stationary or not. The null hypothesis of the test is that the time series is stationary with a single break point, while the alternative hypothesis is that the time series is non-stationary with a single break point.</span>

<span class="sd">        The test statistic is calculated by first estimating the break point using a likelihood ratio test. Then, the test statistic is calculated based on the estimated break point and the residuals of the regression. If the test statistic is greater than a critical value at a given significance level, typically 0.05, then we reject the null hypothesis and conclude that the time series is non-stationary with a structural break. If the test statistic is less than the critical value, then we fail to reject the null hypothesis and conclude that the time series is stationary with a structural break.</span>

<span class="sd">        In practical terms, if a time series is found to be non-stationary with a structural break by the ZA test, one can apply methods to account for the structural break, such as including dummy variables in the regression or using time series models that allow for structural breaks.</span>

<span class="sd">        Overall, the ZA test is a useful tool in time series analysis and forecasting when there is a suspicion of structural breaks in the data. However, it is important to note that the test may not detect multiple break points or breaks that are not well-separated in time.</span>

<span class="sd">    Params:</span>
<span class="sd">        x (ArrayLike):</span>
<span class="sd">            The data series to test.</span>
<span class="sd">        trim (float):</span>
<span class="sd">            The percentage of series at begin/end to exclude.</span>
<span class="sd">            Default: `0.15`</span>
<span class="sd">        maxlag (Optional[int]):</span>
<span class="sd">            The maximum lag which is included in test.</span>
<span class="sd">            Default: `None`</span>
<span class="sd">        regression (VALID_ZA_REGRESSION_OPTIONS):</span>
<span class="sd">            Constant and trend order to include in regression.</span>

<span class="sd">            - `&quot;c&quot;`: constant only (default).</span>
<span class="sd">            - `&quot;t&quot;`: trend only.</span>
<span class="sd">            - `&quot;ct&quot;`: constant and trend.</span>

<span class="sd">            Default: `&quot;c&quot;`</span>
<span class="sd">        autolag (Optional[VALID_ZA_AUTOLAG_OPTIONS]):</span>
<span class="sd">            The method to select the lag length.</span>

<span class="sd">            - If `None`, then `maxlag` lags are used.</span>
<span class="sd">            - If `&quot;AIC&quot;` (default) or `&quot;BIC&quot;`, then the number of lags is chosen.</span>

<span class="sd">            Default: `&quot;AIC&quot;`</span>

<span class="sd">    Returns:</span>
<span class="sd">        (tuple[float, float, dict, int, int]):</span>
<span class="sd">            Returns a tuple containing:</span>
<span class="sd">            - `zastat` (float): The test statistic.</span>
<span class="sd">            - `pvalue` (float): The p-value.</span>
<span class="sd">            - `cvdict` (dict): Critical values at the $1\%$, $5\%$, and $10\%$ levels.</span>
<span class="sd">            - `baselag` (int): Lags used for period regressions.</span>
<span class="sd">            - `pbidx` (int): Break period index.</span>

<span class="sd">    ???+ example &quot;Examples&quot;</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Setup&quot;}</span>
<span class="sd">        &gt;&gt;&gt; from ts_stat_tests.utils.data import data_airline, data_normal, data_noise</span>
<span class="sd">        &gt;&gt;&gt; from ts_stat_tests.algorithms.stationarity import za</span>
<span class="sd">        &gt;&gt;&gt; normal = data_normal</span>
<span class="sd">        &gt;&gt;&gt; noise = data_noise</span>
<span class="sd">        &gt;&gt;&gt; airline = data_airline.values</span>

<span class="sd">        ```</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Example 1: Stationary Series&quot;}</span>
<span class="sd">        &gt;&gt;&gt; stat, pvalue, crit, lags, break_idx = za(x=normal)</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;ZA statistic: {stat:.4f}&quot;)</span>
<span class="sd">        ZA statistic: -30.8800</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;p-value: {pvalue:.4e}&quot;)</span>
<span class="sd">        p-value: 1.0000e-05</span>

<span class="sd">        ```</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Example 2: Noisy Series&quot;}</span>
<span class="sd">        &gt;&gt;&gt; stat, pvalue, crit, lags, break_idx = za(x=noise)</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;ZA statistic: {stat:.4f}&quot;)</span>
<span class="sd">        ZA statistic: -32.4316</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;p-value: {pvalue:.4e}&quot;)</span>
<span class="sd">        p-value: 1.0000e-05</span>

<span class="sd">        ```</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Example 3: Real-World Time Series&quot;}</span>
<span class="sd">        &gt;&gt;&gt; stat, pvalue, crit, lags, break_idx = za(x=airline)</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;ZA statistic: {stat:.4f}&quot;)</span>
<span class="sd">        ZA statistic: -3.6508</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;p-value: {pvalue:.4f}&quot;)</span>
<span class="sd">        p-value: 0.5808</span>

<span class="sd">        ```</span>

<span class="sd">    ??? equation &quot;Calculation&quot;</span>

<span class="sd">        The mathematical equation for the Zivot-Andrews test is:</span>

<span class="sd">        $$</span>
<span class="sd">        y_t = \alpha + \beta t + \gamma y_{t-1} + \delta_1 D_t + \delta_2 t D_t + \epsilon_t</span>
<span class="sd">        $$</span>

<span class="sd">        where:</span>

<span class="sd">        - $y_t$ is the value of the time series at time $t$.</span>
<span class="sd">        - $\alpha$ is the intercept.</span>
<span class="sd">        - $\beta$ is the slope coefficient of the time trend.</span>
<span class="sd">        - $\gamma$ is the coefficient of the lagged dependent variable.</span>
<span class="sd">        - $D_t$ is a dummy variable that takes a value of 1 after the suspected structural break point, and 0 otherwise.</span>
<span class="sd">        - $\delta_1$ and $\delta_2$ are the coefficients of the dummy variable and the interaction term of the dummy variable and time trend, respectively.</span>
<span class="sd">        - $\epsilon_t$ is a stationary error term with mean zero and constant variance.</span>

<span class="sd">        The null hypothesis of the Zivot-Andrews test is that the time series is non-stationary, and the alternative hypothesis is that the time series is stationary with a single structural break.</span>

<span class="sd">        Here are the detailed steps for how to calculate the Zivot-Andrews test:</span>

<span class="sd">        1. Collect your time series data and plot it to visually check for any trends, seasonal patterns, or other patterns that could make the data non-stationary. If you detect any such patterns, you will need to pre-process your data (e.g., detrending, deseasonalizing, etc.) to remove these effects.</span>

<span class="sd">        1. Estimate the parameters of the model using the least squares method. This involves regressing $y_t$ on $t$, $y_{t-1}$, $D_t$, and $t D_t$. The estimated equation is:</span>

<span class="sd">            $$</span>
<span class="sd">            y_t = \alpha + \beta t + \gamma y_{t-1} + \delta_1 D_t + \delta_2 t D_t + \epsilon_t</span>
<span class="sd">            $$</span>

<span class="sd">        1. Perform a unit root test on the residuals to check for stationarity. The most commonly used unit root tests for this purpose are the Augmented Dickey-Fuller (ADF) test and the Phillips-Perron (PP) test.</span>

<span class="sd">        1. Calculate the test statistic, which is based on the largest root of the following equation:</span>

<span class="sd">            $$</span>
<span class="sd">            \Delta y_t = \alpha + \beta t + \gamma y_{t-1} + \delta_1 D_t + \delta_2 t D_t + \epsilon_t</span>
<span class="sd">            $$</span>

<span class="sd">            where:</span>

<span class="sd">            - $\Delta$ is the first difference operator.</span>

<span class="sd">        1. Determine the critical values of the test statistic from the Zivot-Andrews distribution table. The critical values depend on the sample size, the level of significance, and the number of lagged dependent variables in the model.</span>

<span class="sd">        1. Finally, interpret the results and draw conclusions about the stationarity of the time series. If the null hypothesis is rejected, then the time series is stationary with a structural break. If the null hypothesis is not rejected, then the time series is non-stationary and may require further processing to make it stationary.</span>

<span class="sd">        In practice, the Zivot-Andrews test is often conducted using software packages such as R, Python, or MATLAB, which automate the estimation of parameters and calculation of the test statistic.</span>

<span class="sd">    ??? note &quot;Notes&quot;</span>
<span class="sd">        H0 = unit root with a single structural break</span>

<span class="sd">        Algorithm follows Baum (2004/2015) approximation to original Zivot-Andrews method. Rather than performing an autolag regression at each candidate break period (as per the original paper), a single autolag regression is run up-front on the base model (constant + trend with no dummies) to determine the best lag length. This lag length is then used for all subsequent break-period regressions. This results in significant run time reduction but also slightly more pessimistic test statistics than the original Zivot-Andrews method, although no attempt has been made to characterize the size/power trade-off.</span>

<span class="sd">    ??? success &quot;Credit&quot;</span>
<span class="sd">        - All credit goes to the [`statsmodels`](https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.zivot_andrews.html) library.</span>

<span class="sd">    ??? question &quot;References&quot;</span>
<span class="sd">        - Baum, C.F. (2004). ZANDREWS: Stata module to calculate Zivot-Andrews unit root test in presence of structural break,&quot; Statistical Software Components S437301, Boston College Department of Economics, revised 2015.</span>
<span class="sd">        - Schwert, G.W. (1989). Tests for unit roots: A Monte Carlo investigation. Journal of Business &amp; Economic Statistics, 7: 147-159.</span>
<span class="sd">        - Zivot, E., and Andrews, D.W.K. (1992). Further evidence on the great crash, the oil-price shock, and the unit-root hypothesis. Journal of Business &amp; Economic Studies, 10: 251-270.</span>

<span class="sd">    ??? tip &quot;See Also&quot;</span>
<span class="sd">        - [`statsmodels.tsa.stattools.adfuller`](https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.adfuller.html): Augmented Dickey-Fuller unit root test.</span>
<span class="sd">        - [`statsmodels.tsa.stattools.kpss`](https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.kpss.html): Kwiatkowski-Phillips-Schmidt-Shin stationarity test.</span>
<span class="sd">        - [`statsmodels.tsa.stattools.range_unit_root_test`](https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.range_unit_root_test.html): Range Unit-Root test.</span>
<span class="sd">        - [`statsmodels.tsa.stattools.zivot_andrews`](https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.zivot_andrews.html): Zivot-Andrews structural break test.</span>
<span class="sd">        - [`pmdarima.arima.PPTest`](https://alkaline-ml.com/pmdarima/modules/generated/pmdarima.arima.PPTest.html): Phillips-Perron unit root test.</span>
<span class="sd">        - [`arch.unitroot.DFGLS`](https://arch.readthedocs.io/en/latest/unitroot/generated/arch.unitroot.DFGLS.html): Elliot, Rothenberg and Stock&#39;s GLS-detrended Dickey-Fuller.</span>
<span class="sd">        - [`arch.unitroot.VarianceRatio`](https://arch.readthedocs.io/en/latest/unitroot/generated/arch.unitroot.VarianceRatio.html): Variance Ratio test of a random walk.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.stationarity.adf`][ts_stat_tests.algorithms.stationarity.adf]: Augmented Dickey-Fuller unit root test.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.stationarity.kpss`][ts_stat_tests.algorithms.stationarity.kpss]: Kwiatkowski-Phillips-Schmidt-Shin stationarity test.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.stationarity.rur`][ts_stat_tests.algorithms.stationarity.rur]: Range Unit-Root test of stationarity.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.stationarity.za`][ts_stat_tests.algorithms.stationarity.za]: Zivot-Andrews structural break unit root test.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.stationarity.pp`][ts_stat_tests.algorithms.stationarity.pp]: Phillips-Perron unit root test.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.stationarity.ers`][ts_stat_tests.algorithms.stationarity.ers]: Elliot, Rothenberg and Stock&#39;s GLS-detrended Dickey-Fuller test.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.stationarity.vr`][ts_stat_tests.algorithms.stationarity.vr]: Variance Ratio test of a random walk.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">res</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">_za</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
        <span class="n">trim</span><span class="o">=</span><span class="n">trim</span><span class="p">,</span>
        <span class="n">maxlag</span><span class="o">=</span><span class="n">maxlag</span><span class="p">,</span>
        <span class="n">regression</span><span class="o">=</span><span class="n">regression</span><span class="p">,</span>
        <span class="n">autolag</span><span class="o">=</span><span class="n">autolag</span><span class="p">,</span>  <span class="c1"># type: ignore[arg-type] # statsmodels stubs are often missing None</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="nb">float</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
        <span class="nb">float</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
        <span class="nb">dict</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
        <span class="nb">int</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span>
        <span class="nb">int</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="ts_stat_tests.algorithms.stationarity.pp" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">pp</span>


<a href="#ts_stat_tests.algorithms.stationarity.pp" class="headerlink" title="Permanent link">ðŸ”—</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">pp</span><span class="p">(</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
    <span class="n">lags</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">trend</span><span class="p">:</span> <span class="n">VALID_PP_TREND_OPTIONS</span> <span class="o">=</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span>
    <span class="n">test_type</span><span class="p">:</span> <span class="n">VALID_PP_TEST_TYPE_OPTIONS</span> <span class="o">=</span> <span class="s2">&quot;tau&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <div class="admonition note">
<p class="admonition-title">Summary</p>
<p>Conduct a Phillips-Perron (PP) test for stationarity.</p>
<p>In statistics, the Phillips-Perron test (named after Peter C. B. Phillips and Pierre Perron) is a unit root test. It is used in time series analysis to test the null hypothesis that a time series is integrated of order <span class="arithmatex">\(1\)</span>. It builds on the Dickey-Fuller test of the null hypothesis <span class="arithmatex">\(p=0\)</span>.</p>
</div>
<details class="abstract" open="open">
<summary>Details</summary>
<p>The Phillips-Perron (PP) test is a statistical test used to determine whether a time series is stationary or not. It is similar to the Augmented Dickey-Fuller (ADF) test, but it has some advantages, especially in the presence of autocorrelation and heteroscedasticity.</p>
<p>The PP test involves regressing the time series on a constant and a linear time trend, and testing whether the residuals of the regression are stationary or not. The null hypothesis of the test is that the time series is non-stationary, while the alternative hypothesis is that the time series is stationary.</p>
<p>The test statistic is calculated by taking the sum of the squared residuals of the regression, which is adjusted for autocorrelation and heteroscedasticity. The PP test also accounts for the bias in the standard errors of the test statistic, which can lead to incorrect inference in small samples.</p>
<p>If the test statistic is less than a critical value at a given significance level, typically 0.05, then we reject the null hypothesis and conclude that the time series is stationary. If the test statistic is greater than the critical value, then we fail to reject the null hypothesis and conclude that the time series is non-stationary.</p>
<p>In practical terms, if a time series is found to be non-stationary by the PP test, one can apply differencing to the time series until it becomes stationary. This involves taking the difference between consecutive observations and potentially repeating this process until the time series is stationary.</p>
<p>Overall, the PP test is a powerful and robust test for stationarity, and it is widely used in time series analysis and forecasting. However, it is important to use multiple tests and diagnostic tools to determine the stationarity of a time series, as no single test is perfect in all situations.</p>
</details>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="numpy.typing.ArrayLike">ArrayLike</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The data series to test.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>lags</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of lags to use in the Newey-West estimator of the variance. If omitted or <code>None</code>, the lag length is selected automatically.<br>
Defaults to <code>None</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>trend</code>
            </td>
            <td>
                  <code><span title="ts_stat_tests.algorithms.stationarity.VALID_PP_TREND_OPTIONS">VALID_PP_TREND_OPTIONS</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The trend component to include in the test.</p>
<ul>
<li><code>"n"</code>: No constant, no trend.</li>
<li><code>"c"</code>: Include a constant (default).</li>
<li><code>"ct"</code>: Include a constant and linear time trend.</li>
</ul>
<p>Defaults to <code>"c"</code>.</p>
              </div>
            </td>
            <td>
                  <code>&#39;c&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>test_type</code>
            </td>
            <td>
                  <code><span title="ts_stat_tests.algorithms.stationarity.VALID_PP_TEST_TYPE_OPTIONS">VALID_PP_TEST_TYPE_OPTIONS</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The type of test statistic to compute:</p>
<ul>
<li><code>"tau"</code>: The t-statistic based on the augmented regression (default).</li>
<li><code>"rho"</code>: The normalized autocorrelation coefficient (also known as the <span class="arithmatex">\(Z(\\alpha)\)</span> test).</li>
</ul>
<p>Defaults to <code>"tau"</code>.</p>
              </div>
            </td>
            <td>
                  <code>&#39;tau&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<span title="float">float</span>, <span title="float">float</span>, <span title="int">int</span>, <span title="dict">dict</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Returns a tuple containing:
- <code>stat</code> (float): The test statistic.
- <code>pvalue</code> (float): The p-value for the test statistic.
- <code>lags</code> (int): The number of lags used in the test.
- <code>crit</code> (dict): The critical values at 1%, 5%, and 10%.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <details class="example" open="open">
<summary>Examples</summary>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Setup</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ts_stat_tests.algorithms.stationarity</span><span class="w"> </span><span class="kn">import</span> <span class="n">pp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ts_stat_tests.utils.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">data_airline</span><span class="p">,</span> <span class="n">data_normal</span><span class="p">,</span> <span class="n">data_trend</span><span class="p">,</span> <span class="n">data_sine</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">normal</span> <span class="o">=</span> <span class="n">data_normal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trend</span> <span class="o">=</span> <span class="n">data_trend</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">seasonal</span> <span class="o">=</span> <span class="n">data_sine</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">airline</span> <span class="o">=</span> <span class="n">data_airline</span><span class="o">.</span><span class="n">values</span>
</code></pre></div></td></tr></table></div>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 1: Stationary Series</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">stat</span><span class="p">,</span> <span class="n">pvalue</span><span class="p">,</span> <span class="n">lags</span><span class="p">,</span> <span class="n">crit</span> <span class="o">=</span> <span class="n">pp</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">normal</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;PP statistic: </span><span class="si">{</span><span class="n">stat</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">PP statistic: -30.7758</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;p-value: </span><span class="si">{</span><span class="n">pvalue</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">p-value: 0.0000</span>
</code></pre></div></td></tr></table></div>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 2: Trend-Stationary Series</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">stat</span><span class="p">,</span> <span class="n">pvalue</span><span class="p">,</span> <span class="n">lags</span><span class="p">,</span> <span class="n">crit</span> <span class="o">=</span> <span class="n">pp</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">trend</span><span class="p">,</span> <span class="n">trend</span><span class="o">=</span><span class="s2">&quot;ct&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;p-value: </span><span class="si">{</span><span class="n">pvalue</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">p-value: 0.0000</span>
</code></pre></div></td></tr></table></div>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 3: Seasonal Series</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">stat</span><span class="p">,</span> <span class="n">pvalue</span><span class="p">,</span> <span class="n">lags</span><span class="p">,</span> <span class="n">crit</span> <span class="o">=</span> <span class="n">pp</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">seasonal</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;PP statistic: </span><span class="si">{</span><span class="n">stat</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">PP statistic: -8.0571</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;p-value: </span><span class="si">{</span><span class="n">pvalue</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">p-value: 0.0000</span>
</code></pre></div></td></tr></table></div>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 4: Real-World Time Series</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">stat</span><span class="p">,</span> <span class="n">pvalue</span><span class="p">,</span> <span class="n">lags</span><span class="p">,</span> <span class="n">crit</span> <span class="o">=</span> <span class="n">pp</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">airline</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;PP statistic: </span><span class="si">{</span><span class="n">stat</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">PP statistic: -1.3511</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;p-value: </span><span class="si">{</span><span class="n">pvalue</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">p-value: 0.6055</span>
</code></pre></div></td></tr></table></div>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 5: PP test with excessive lags (coverage check)</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ts_stat_tests.algorithms.stationarity</span><span class="w"> </span><span class="kn">import</span> <span class="n">pp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ts_stat_tests.utils.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">data_normal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># data_normal has 1000 observations. Force lags = 1000 to trigger adjustment.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">pp</span><span class="p">(</span><span class="n">data_normal</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;stat: </span><span class="si">{</span><span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, lags: </span><span class="si">{</span><span class="n">res</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">stat: -43.6895, lags: 998</span>
</code></pre></div></td></tr></table></div>
</details>
<details class="equation">
<summary>Calculation</summary>
<p>The Phillips-Perron (PP) test is a commonly used test for stationarity in time series forecasting. The mathematical equation for the PP test is:</p>
<div class="arithmatex">\[
y_t = \delta + \pi t + \rho y_{t-1} + \epsilon_t
\]</div>
<p>where:</p>
<ul>
<li><span class="arithmatex">\(y_t\)</span> is the value of the time series at time <span class="arithmatex">\(t\)</span>.</li>
<li><span class="arithmatex">\(\delta\)</span> is a constant term.</li>
<li><span class="arithmatex">\(\pi\)</span> is a coefficient that captures the trend in the data.</li>
<li><span class="arithmatex">\(\rho\)</span> is a coefficient that captures the autocorrelation in the data.</li>
<li><span class="arithmatex">\(y_{t-1}\)</span> is the lagged value of the time series at time <span class="arithmatex">\(t-1\)</span>.</li>
<li><span class="arithmatex">\(\epsilon_t\)</span> is a stationary error term with mean zero and constant variance.</li>
</ul>
<p>The PP test is based on the idea that if the time series is stationary, then the coefficient <span class="arithmatex">\(\rho\)</span> should be equal to zero. Therefore, the null hypothesis of the PP test is that the time series is stationary, and the alternative hypothesis is that the time series is non-stationary with a non-zero value of <span class="arithmatex">\(\rho\)</span>.</p>
<p>Here are the detailed steps for how to calculate the PP test:</p>
<ol>
<li>
<p>Collect your time series data and plot it to visually check for any trends, seasonal patterns, or other patterns that could make the data non-stationary. If you detect any such patterns, you will need to pre-process your data (e.g., detrending, deseasonalizing, etc.) to remove these effects.</p>
</li>
<li>
<p>Estimate the regression model by regressing <span class="arithmatex">\(y_t\)</span> on a constant, a linear trend, and the lagged value of <span class="arithmatex">\(y_{t-1}\)</span>. The regression equation is:</p>
<div class="arithmatex">\[
y_t = \delta + \pi t + \rho y_{t-1} + \epsilon_t
\]</div>
</li>
<li>
<p>Calculate the test statistic, which is based on the following equation:</p>
<div class="arithmatex">\[
z = \left( T^{-\frac{1}{2}} \right) \times \left( \sum_{t=1}^T \left( y_t - \delta - \pi t - \rho y_{t-1} \right) - \left( \frac{1}{T} \right) \times \sum_{t=1}^T \sum_{s=1}^T K \left( \frac{s-t}{h} \right) (y_s - \delta - \pi s - \rho y_{s-1}) \right)
\]</div>
<p>where:</p>
<ul>
<li><span class="arithmatex">\(T\)</span> is the sample size.</li>
<li><span class="arithmatex">\(K(\dots)\)</span> is the kernel function, which determines the weight of each observation in the smoothed series. The choice of the kernel function depends on the degree of serial correlation in the data. Typically, a Gaussian kernel or a Bartlett kernel is used.</li>
<li><span class="arithmatex">\(h\)</span> is the bandwidth parameter, which controls the degree of smoothing of the series. The optimal value of <span class="arithmatex">\(h\)</span> depends on the sample size and the noise level of the data.</li>
</ul>
</li>
<li>
<p>Determine the critical values of the test statistic from the PP distribution table. The critical values depend on the sample size and the level of significance.</p>
</li>
<li>
<p>Finally, interpret the results and draw conclusions about the stationarity of the time series. If the null hypothesis is rejected, then the time series is non-stationary with a non-zero value of <span class="arithmatex">\(\rho\)</span>. If the null hypothesis is not rejected, then the time series is stationary.</p>
</li>
</ol>
<p>In practice, the PP test is often conducted using software packages such as R, Python, or MATLAB, which automate the estimation of the regression model and calculation of the test statistic.</p>
</details>
<details class="note">
<summary>Notes</summary>
<p>This test is generally used indirectly via the <a href="https://alkaline-ml.com/pmdarima/modules/generated/pmdarima.arima.ndiffs.html"><code>pmdarima.arima.ndiffs()</code></a> function, which computes the differencing term, <code>d</code>.</p>
<p>The R code allows for two types of tests: <code>'Z(alpha)'</code> and <code>'Z(t_alpha)'</code>. Since sklearn does not allow extraction of std errors from the linear model fit, <code>t_alpha</code> is much more difficult to achieve, so we do not allow that variant.</p>
</details>
<div class="admonition success">
<p class="admonition-title">Credit</p>
<ul>
<li>All credit goes to the <a href="https://arch.readthedocs.io/en/latest/unitroot/generated/arch.unitroot.PhillipsPerron.html"><code>arch</code></a> library.</li>
</ul>
</div>
<details class="question">
<summary>References</summary>
<ul>
<li>Phillips, P. C. B.; Perron, P. (1988). Testing for a Unit Root in Time Series Regression. Biometrika. 75 (2): 335-346.</li>
</ul>
</details>
<details class="tip">
<summary>See Also</summary>
<ul>
<li><a href="https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.adfuller.html"><code>statsmodels.tsa.stattools.adfuller</code></a>: Augmented Dickey-Fuller unit root test.</li>
<li><a href="https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.kpss.html"><code>statsmodels.tsa.stattools.kpss</code></a>: Kwiatkowski-Phillips-Schmidt-Shin stationarity test.</li>
<li><a href="https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.range_unit_root_test.html"><code>statsmodels.tsa.stattools.range_unit_root_test</code></a>: Range Unit-Root test.</li>
<li><a href="https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.zivot_andrews.html"><code>statsmodels.tsa.stattools.zivot_andrews</code></a>: Zivot-Andrews structural break test.</li>
<li><a href="https://alkaline-ml.com/pmdarima/modules/generated/pmdarima.arima.PPTest.html"><code>pmdarima.arima.PPTest</code></a>: Phillips-Perron unit root test.</li>
<li><a href="https://arch.readthedocs.io/en/latest/unitroot/generated/arch.unitroot.DFGLS.html"><code>arch.unitroot.DFGLS</code></a>: Elliot, Rothenberg and Stock's GLS-detrended Dickey-Fuller.</li>
<li><a href="https://arch.readthedocs.io/en/latest/unitroot/generated/arch.unitroot.VarianceRatio.html"><code>arch.unitroot.VarianceRatio</code></a>: Variance Ratio test of a random walk.</li>
<li><a class="autorefs autorefs-internal" title="            adf" href="#ts_stat_tests.algorithms.stationarity.adf"><code>ts_stat_tests.algorithms.stationarity.adf</code></a>: Augmented Dickey-Fuller unit root test.</li>
<li><a class="autorefs autorefs-internal" title="            kpss" href="#ts_stat_tests.algorithms.stationarity.kpss"><code>ts_stat_tests.algorithms.stationarity.kpss</code></a>: Kwiatkowski-Phillips-Schmidt-Shin stationarity test.</li>
<li><a class="autorefs autorefs-internal" title="            rur" href="#ts_stat_tests.algorithms.stationarity.rur"><code>ts_stat_tests.algorithms.stationarity.rur</code></a>: Range Unit-Root test of stationarity.</li>
<li><a class="autorefs autorefs-internal" title="            za" href="#ts_stat_tests.algorithms.stationarity.za"><code>ts_stat_tests.algorithms.stationarity.za</code></a>: Zivot-Andrews structural break unit root test.</li>
<li><a class="autorefs autorefs-internal" title="            pp" href="#ts_stat_tests.algorithms.stationarity.pp"><code>ts_stat_tests.algorithms.stationarity.pp</code></a>: Phillips-Perron unit root test.</li>
<li><a class="autorefs autorefs-internal" title="            ers" href="#ts_stat_tests.algorithms.stationarity.ers"><code>ts_stat_tests.algorithms.stationarity.ers</code></a>: Elliot, Rothenberg and Stock's GLS-detrended Dickey-Fuller test.</li>
<li><a class="autorefs autorefs-internal" title="            vr" href="#ts_stat_tests.algorithms.stationarity.vr"><code>ts_stat_tests.algorithms.stationarity.vr</code></a>: Variance Ratio test of a random walk.</li>
</ul>
</details>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/ts_stat_tests/algorithms/stationarity.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@typechecked</span>
<span class="k">def</span><span class="w"> </span><span class="nf">pp</span><span class="p">(</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
    <span class="n">lags</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">trend</span><span class="p">:</span> <span class="n">VALID_PP_TREND_OPTIONS</span> <span class="o">=</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span>
    <span class="n">test_type</span><span class="p">:</span> <span class="n">VALID_PP_TEST_TYPE_OPTIONS</span> <span class="o">=</span> <span class="s2">&quot;tau&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    !!! note &quot;Summary&quot;</span>
<span class="sd">        Conduct a Phillips-Perron (PP) test for stationarity.</span>

<span class="sd">        In statistics, the Phillips-Perron test (named after Peter C. B. Phillips and Pierre Perron) is a unit root test. It is used in time series analysis to test the null hypothesis that a time series is integrated of order $1$. It builds on the Dickey-Fuller test of the null hypothesis $p=0$.</span>

<span class="sd">    ???+ abstract &quot;Details&quot;</span>

<span class="sd">        The Phillips-Perron (PP) test is a statistical test used to determine whether a time series is stationary or not. It is similar to the Augmented Dickey-Fuller (ADF) test, but it has some advantages, especially in the presence of autocorrelation and heteroscedasticity.</span>

<span class="sd">        The PP test involves regressing the time series on a constant and a linear time trend, and testing whether the residuals of the regression are stationary or not. The null hypothesis of the test is that the time series is non-stationary, while the alternative hypothesis is that the time series is stationary.</span>

<span class="sd">        The test statistic is calculated by taking the sum of the squared residuals of the regression, which is adjusted for autocorrelation and heteroscedasticity. The PP test also accounts for the bias in the standard errors of the test statistic, which can lead to incorrect inference in small samples.</span>

<span class="sd">        If the test statistic is less than a critical value at a given significance level, typically 0.05, then we reject the null hypothesis and conclude that the time series is stationary. If the test statistic is greater than the critical value, then we fail to reject the null hypothesis and conclude that the time series is non-stationary.</span>

<span class="sd">        In practical terms, if a time series is found to be non-stationary by the PP test, one can apply differencing to the time series until it becomes stationary. This involves taking the difference between consecutive observations and potentially repeating this process until the time series is stationary.</span>

<span class="sd">        Overall, the PP test is a powerful and robust test for stationarity, and it is widely used in time series analysis and forecasting. However, it is important to use multiple tests and diagnostic tools to determine the stationarity of a time series, as no single test is perfect in all situations.</span>

<span class="sd">    Params:</span>
<span class="sd">        x (ArrayLike):</span>
<span class="sd">            The data series to test.</span>
<span class="sd">        lags (Optional[int], optional):</span>
<span class="sd">            The number of lags to use in the Newey-West estimator of the variance. If omitted or `None`, the lag length is selected automatically.&lt;br&gt;</span>
<span class="sd">            Defaults to `None`.</span>
<span class="sd">        trend (VALID_PP_TREND_OPTIONS, optional):</span>
<span class="sd">            The trend component to include in the test.</span>

<span class="sd">            - `&quot;n&quot;`: No constant, no trend.</span>
<span class="sd">            - `&quot;c&quot;`: Include a constant (default).</span>
<span class="sd">            - `&quot;ct&quot;`: Include a constant and linear time trend.</span>

<span class="sd">            Defaults to `&quot;c&quot;`.</span>
<span class="sd">        test_type (VALID_PP_TEST_TYPE_OPTIONS, optional):</span>
<span class="sd">            The type of test statistic to compute:</span>

<span class="sd">            - `&quot;tau&quot;`: The t-statistic based on the augmented regression (default).</span>
<span class="sd">            - `&quot;rho&quot;`: The normalized autocorrelation coefficient (also known as the $Z(\\alpha)$ test).</span>

<span class="sd">            Defaults to `&quot;tau&quot;`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (tuple[float, float, int, dict]):</span>
<span class="sd">            Returns a tuple containing:</span>
<span class="sd">            - `stat` (float): The test statistic.</span>
<span class="sd">            - `pvalue` (float): The p-value for the test statistic.</span>
<span class="sd">            - `lags` (int): The number of lags used in the test.</span>
<span class="sd">            - `crit` (dict): The critical values at 1%, 5%, and 10%.</span>

<span class="sd">    ???+ example &quot;Examples&quot;</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Setup&quot;}</span>
<span class="sd">        &gt;&gt;&gt; from ts_stat_tests.algorithms.stationarity import pp</span>
<span class="sd">        &gt;&gt;&gt; from ts_stat_tests.utils.data import data_airline, data_normal, data_trend, data_sine</span>
<span class="sd">        &gt;&gt;&gt; normal = data_normal</span>
<span class="sd">        &gt;&gt;&gt; trend = data_trend</span>
<span class="sd">        &gt;&gt;&gt; seasonal = data_sine</span>
<span class="sd">        &gt;&gt;&gt; airline = data_airline.values</span>

<span class="sd">        ```</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Example 1: Stationary Series&quot;}</span>
<span class="sd">        &gt;&gt;&gt; stat, pvalue, lags, crit = pp(x=normal)</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;PP statistic: {stat:.4f}&quot;)</span>
<span class="sd">        PP statistic: -30.7758</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;p-value: {pvalue:.4f}&quot;)</span>
<span class="sd">        p-value: 0.0000</span>

<span class="sd">        ```</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Example 2: Trend-Stationary Series&quot;}</span>
<span class="sd">        &gt;&gt;&gt; stat, pvalue, lags, crit = pp(x=trend, trend=&quot;ct&quot;)</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;p-value: {pvalue:.4f}&quot;)</span>
<span class="sd">        p-value: 0.0000</span>

<span class="sd">        ```</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Example 3: Seasonal Series&quot;}</span>
<span class="sd">        &gt;&gt;&gt; stat, pvalue, lags, crit = pp(x=seasonal)</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;PP statistic: {stat:.4f}&quot;)</span>
<span class="sd">        PP statistic: -8.0571</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;p-value: {pvalue:.4f}&quot;)</span>
<span class="sd">        p-value: 0.0000</span>

<span class="sd">        ```</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Example 4: Real-World Time Series&quot;}</span>
<span class="sd">        &gt;&gt;&gt; stat, pvalue, lags, crit = pp(x=airline)</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;PP statistic: {stat:.4f}&quot;)</span>
<span class="sd">        PP statistic: -1.3511</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;p-value: {pvalue:.4f}&quot;)</span>
<span class="sd">        p-value: 0.6055</span>

<span class="sd">        ```</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Example 5: PP test with excessive lags (coverage check)&quot;}</span>
<span class="sd">        &gt;&gt;&gt; from ts_stat_tests.algorithms.stationarity import pp</span>
<span class="sd">        &gt;&gt;&gt; from ts_stat_tests.utils.data import data_normal</span>
<span class="sd">        &gt;&gt;&gt; # data_normal has 1000 observations. Force lags = 1000 to trigger adjustment.</span>
<span class="sd">        &gt;&gt;&gt; res = pp(data_normal, lags=1000)</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;stat: {res[0]:.4f}, lags: {res[2]}&quot;)</span>
<span class="sd">        stat: -43.6895, lags: 998</span>

<span class="sd">        ```</span>

<span class="sd">    ??? equation &quot;Calculation&quot;</span>

<span class="sd">        The Phillips-Perron (PP) test is a commonly used test for stationarity in time series forecasting. The mathematical equation for the PP test is:</span>

<span class="sd">        $$</span>
<span class="sd">        y_t = \delta + \pi t + \rho y_{t-1} + \epsilon_t</span>
<span class="sd">        $$</span>

<span class="sd">        where:</span>

<span class="sd">        - $y_t$ is the value of the time series at time $t$.</span>
<span class="sd">        - $\delta$ is a constant term.</span>
<span class="sd">        - $\pi$ is a coefficient that captures the trend in the data.</span>
<span class="sd">        - $\rho$ is a coefficient that captures the autocorrelation in the data.</span>
<span class="sd">        - $y_{t-1}$ is the lagged value of the time series at time $t-1$.</span>
<span class="sd">        - $\epsilon_t$ is a stationary error term with mean zero and constant variance.</span>

<span class="sd">        The PP test is based on the idea that if the time series is stationary, then the coefficient $\rho$ should be equal to zero. Therefore, the null hypothesis of the PP test is that the time series is stationary, and the alternative hypothesis is that the time series is non-stationary with a non-zero value of $\rho$.</span>

<span class="sd">        Here are the detailed steps for how to calculate the PP test:</span>

<span class="sd">        1. Collect your time series data and plot it to visually check for any trends, seasonal patterns, or other patterns that could make the data non-stationary. If you detect any such patterns, you will need to pre-process your data (e.g., detrending, deseasonalizing, etc.) to remove these effects.</span>

<span class="sd">        1. Estimate the regression model by regressing $y_t$ on a constant, a linear trend, and the lagged value of $y_{t-1}$. The regression equation is:</span>

<span class="sd">            $$</span>
<span class="sd">            y_t = \delta + \pi t + \rho y_{t-1} + \epsilon_t</span>
<span class="sd">            $$</span>

<span class="sd">        1. Calculate the test statistic, which is based on the following equation:</span>

<span class="sd">            $$</span>
<span class="sd">            z = \left( T^{-\frac{1}{2}} \right) \times \left( \sum_{t=1}^T \left( y_t - \delta - \pi t - \rho y_{t-1} \right) - \left( \frac{1}{T} \right) \times \sum_{t=1}^T \sum_{s=1}^T K \left( \frac{s-t}{h} \right) (y_s - \delta - \pi s - \rho y_{s-1}) \right)</span>
<span class="sd">            $$</span>

<span class="sd">            where:</span>

<span class="sd">            - $T$ is the sample size.</span>
<span class="sd">            - $K(\dots)$ is the kernel function, which determines the weight of each observation in the smoothed series. The choice of the kernel function depends on the degree of serial correlation in the data. Typically, a Gaussian kernel or a Bartlett kernel is used.</span>
<span class="sd">            - $h$ is the bandwidth parameter, which controls the degree of smoothing of the series. The optimal value of $h$ depends on the sample size and the noise level of the data.</span>

<span class="sd">        1. Determine the critical values of the test statistic from the PP distribution table. The critical values depend on the sample size and the level of significance.</span>

<span class="sd">        1. Finally, interpret the results and draw conclusions about the stationarity of the time series. If the null hypothesis is rejected, then the time series is non-stationary with a non-zero value of $\rho$. If the null hypothesis is not rejected, then the time series is stationary.</span>

<span class="sd">        In practice, the PP test is often conducted using software packages such as R, Python, or MATLAB, which automate the estimation of the regression model and calculation of the test statistic.</span>

<span class="sd">    ??? note &quot;Notes&quot;</span>
<span class="sd">        This test is generally used indirectly via the [`pmdarima.arima.ndiffs()`](https://alkaline-ml.com/pmdarima/modules/generated/pmdarima.arima.ndiffs.html) function, which computes the differencing term, `d`.</span>

<span class="sd">        The R code allows for two types of tests: `&#39;Z(alpha)&#39;` and `&#39;Z(t_alpha)&#39;`. Since sklearn does not allow extraction of std errors from the linear model fit, `t_alpha` is much more difficult to achieve, so we do not allow that variant.</span>

<span class="sd">    !!! success &quot;Credit&quot;</span>
<span class="sd">        - All credit goes to the [`arch`](https://arch.readthedocs.io/en/latest/unitroot/generated/arch.unitroot.PhillipsPerron.html) library.</span>

<span class="sd">    ??? question &quot;References&quot;</span>
<span class="sd">        - Phillips, P. C. B.; Perron, P. (1988). Testing for a Unit Root in Time Series Regression. Biometrika. 75 (2): 335-346.</span>

<span class="sd">    ??? tip &quot;See Also&quot;</span>
<span class="sd">        - [`statsmodels.tsa.stattools.adfuller`](https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.adfuller.html): Augmented Dickey-Fuller unit root test.</span>
<span class="sd">        - [`statsmodels.tsa.stattools.kpss`](https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.kpss.html): Kwiatkowski-Phillips-Schmidt-Shin stationarity test.</span>
<span class="sd">        - [`statsmodels.tsa.stattools.range_unit_root_test`](https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.range_unit_root_test.html): Range Unit-Root test.</span>
<span class="sd">        - [`statsmodels.tsa.stattools.zivot_andrews`](https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.zivot_andrews.html): Zivot-Andrews structural break test.</span>
<span class="sd">        - [`pmdarima.arima.PPTest`](https://alkaline-ml.com/pmdarima/modules/generated/pmdarima.arima.PPTest.html): Phillips-Perron unit root test.</span>
<span class="sd">        - [`arch.unitroot.DFGLS`](https://arch.readthedocs.io/en/latest/unitroot/generated/arch.unitroot.DFGLS.html): Elliot, Rothenberg and Stock&#39;s GLS-detrended Dickey-Fuller.</span>
<span class="sd">        - [`arch.unitroot.VarianceRatio`](https://arch.readthedocs.io/en/latest/unitroot/generated/arch.unitroot.VarianceRatio.html): Variance Ratio test of a random walk.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.stationarity.adf`][ts_stat_tests.algorithms.stationarity.adf]: Augmented Dickey-Fuller unit root test.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.stationarity.kpss`][ts_stat_tests.algorithms.stationarity.kpss]: Kwiatkowski-Phillips-Schmidt-Shin stationarity test.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.stationarity.rur`][ts_stat_tests.algorithms.stationarity.rur]: Range Unit-Root test of stationarity.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.stationarity.za`][ts_stat_tests.algorithms.stationarity.za]: Zivot-Andrews structural break unit root test.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.stationarity.pp`][ts_stat_tests.algorithms.stationarity.pp]: Phillips-Perron unit root test.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.stationarity.ers`][ts_stat_tests.algorithms.stationarity.ers]: Elliot, Rothenberg and Stock&#39;s GLS-detrended Dickey-Fuller test.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.stationarity.vr`][ts_stat_tests.algorithms.stationarity.vr]: Variance Ratio test of a random walk.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">nobs</span> <span class="o">=</span> <span class="n">_x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">_lags</span> <span class="o">=</span> <span class="n">lags</span>
    <span class="k">if</span> <span class="n">_lags</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">_lags</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="mf">12.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">nobs</span> <span class="o">/</span> <span class="mf">100.0</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="mf">4.0</span><span class="p">)))</span>

    <span class="c1"># arch PP test requires lags &lt; nobs-1</span>
    <span class="k">if</span> <span class="n">_lags</span> <span class="o">&gt;=</span> <span class="n">nobs</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">_lags</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">nobs</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>

    <span class="n">res</span> <span class="o">=</span> <span class="n">_pp</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">_x</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="n">_lags</span><span class="p">,</span> <span class="n">trend</span><span class="o">=</span><span class="n">trend</span><span class="p">,</span> <span class="n">test_type</span><span class="o">=</span><span class="n">test_type</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">stat</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">pvalue</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">lags</span><span class="p">),</span> <span class="nb">dict</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">critical_values</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="ts_stat_tests.algorithms.stationarity.ers" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">ers</span>


<a href="#ts_stat_tests.algorithms.stationarity.ers" class="headerlink" title="Permanent link">ðŸ”—</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">ers</span><span class="p">(</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
    <span class="n">lags</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">trend</span><span class="p">:</span> <span class="n">VALID_ERS_TREND_OPTIONS</span> <span class="o">=</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span>
    <span class="n">max_lags</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">method</span><span class="p">:</span> <span class="n">VALID_ERS_METHOD_OPTIONS</span> <span class="o">=</span> <span class="s2">&quot;aic&quot;</span><span class="p">,</span>
    <span class="n">low_memory</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <div class="admonition note">
<p class="admonition-title">Summary</p>
<p>Elliott, Rothenberg and Stock's GLS detrended Dickey-Fuller.</p>
</div>
<details class="abstract" open="open">
<summary>Details</summary>
<p>The Elliott-Rothenberg-Stock (ERS) test is a statistical test used to determine whether a time series is stationary or not. It is a robust test that is able to handle a wide range of non-stationary processes, including ones with structural breaks, heteroscedasticity, and autocorrelation.</p>
<p>The ERS test involves fitting a local-to-zero regression of the time series on a constant and a linear time trend, using a kernel function to weight the observations. The test statistic is then calculated based on the sum of the squared residuals of the local-to-zero regression, which is adjusted for the bandwidth of the kernel function and for the correlation of the residuals.</p>
<p>If the test statistic is less than a critical value at a given significance level, typically 0.05, then we reject the null hypothesis and conclude that the time series is stationary. If the test statistic is greater than the critical value, then we fail to reject the null hypothesis and conclude that the time series is non-stationary.</p>
<p>In practical terms, if a time series is found to be non-stationary by the ERS test, one can apply differencing to the time series until it becomes stationary. This involves taking the difference between consecutive observations and potentially repeating this process until the time series is stationary.</p>
<p>Overall, the ERS test is a powerful and flexible test for stationarity, and it is widely used in time series analysis and forecasting. However, it is important to use multiple tests and diagnostic tools to determine the stationarity of a time series, as no single test is perfect in all situations.</p>
</details>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>y</code>
            </td>
            <td>
                  <code><span title="numpy.typing.ArrayLike">ArrayLike</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The data to test for a unit root.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>lags</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of lags to use in the ADF regression. If omitted or <code>None</code>, method is used to automatically select the lag length with no more than <code>max_lags</code> are included.<br>
Defaults to <code>None</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>trend</code>
            </td>
            <td>
                  <code><span title="ts_stat_tests.algorithms.stationarity.VALID_ERS_TREND_OPTIONS">VALID_ERS_TREND_OPTIONS</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The trend component to include in the test</p>
<ul>
<li><code>"c"</code>: Include a constant (Default)</li>
<li><code>"ct"</code>: Include a constant and linear time trend</li>
</ul>
<p>Defaults to <code>"c"</code>.</p>
              </div>
            </td>
            <td>
                  <code>&#39;c&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_lags</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The maximum number of lags to use when selecting lag length. When using automatic lag length selection, the lag is selected using OLS detrending rather than GLS detrending.<br>
Defaults to <code>None</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>method</code>
            </td>
            <td>
                  <code><span title="ts_stat_tests.algorithms.stationarity.VALID_ERS_METHOD_OPTIONS">VALID_ERS_METHOD_OPTIONS</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The method to use when selecting the lag length</p>
<ul>
<li><code>"AIC"</code>: Select the minimum of the Akaike IC</li>
<li><code>"BIC"</code>: Select the minimum of the Schwarz/Bayesian IC</li>
<li><code>"t-stat"</code>: Select the minimum of the Schwarz/Bayesian IC</li>
</ul>
<p>Defaults to <code>"aic"</code>.</p>
              </div>
            </td>
            <td>
                  <code>&#39;aic&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>low_memory</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="bool">bool</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Flag indicating whether to use the low-memory algorithm for lag-length selection.
Defaults to <code>None</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<span title="float">float</span>, <span title="float">float</span>, <span title="int">int</span>, <span title="dict">dict</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Returns a tuple containing:
- <code>stat</code> (float): The test statistic for a unit root.
- <code>pvalue</code> (float): The p-value for the test statistic.
- <code>lags</code> (int): The number of lags used in the test.
- <code>crit</code> (dict): The critical values for the test statistic at the 1%, 5%, and 10% levels.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <details class="example" open="open">
<summary>Examples</summary>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Setup</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ts_stat_tests.algorithms.stationarity</span><span class="w"> </span><span class="kn">import</span> <span class="n">ers</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ts_stat_tests.utils.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">data_airline</span><span class="p">,</span> <span class="n">data_normal</span><span class="p">,</span> <span class="n">data_noise</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">normal</span> <span class="o">=</span> <span class="n">data_normal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">noise</span> <span class="o">=</span> <span class="n">data_noise</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">airline</span> <span class="o">=</span> <span class="n">data_airline</span><span class="o">.</span><span class="n">values</span>
</code></pre></div></td></tr></table></div>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 1: Stationary Series</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">stat</span><span class="p">,</span> <span class="n">pvalue</span><span class="p">,</span> <span class="n">lags</span><span class="p">,</span> <span class="n">crit</span> <span class="o">=</span> <span class="n">ers</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">normal</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ERS statistic: </span><span class="si">{</span><span class="n">stat</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">ERS statistic: -30.1517</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;p-value: </span><span class="si">{</span><span class="n">pvalue</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">p-value: 0.0000</span>
</code></pre></div></td></tr></table></div>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 2: Noisy Series</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">stat</span><span class="p">,</span> <span class="n">pvalue</span><span class="p">,</span> <span class="n">lags</span><span class="p">,</span> <span class="n">crit</span> <span class="o">=</span> <span class="n">ers</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">noise</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ERS statistic: </span><span class="si">{</span><span class="n">stat</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">ERS statistic: -12.6897</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;p-value: </span><span class="si">{</span><span class="n">pvalue</span><span class="si">:</span><span class="s2">.4e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">p-value: 1.0956e-21</span>
</code></pre></div></td></tr></table></div>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 3: Real-World Time Series</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">stat</span><span class="p">,</span> <span class="n">pvalue</span><span class="p">,</span> <span class="n">lags</span><span class="p">,</span> <span class="n">crit</span> <span class="o">=</span> <span class="n">ers</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">airline</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ERS statistic: </span><span class="si">{</span><span class="n">stat</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">ERS statistic: 0.9918</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;p-value: </span><span class="si">{</span><span class="n">pvalue</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">p-value: 0.9232</span>
</code></pre></div></td></tr></table></div>
</details>
<details class="equation">
<summary>Calculation</summary>
<p>The mathematical equation for the ERS test is:</p>
<div class="arithmatex">\[
y_t = \mu_t + \epsilon_t
\]</div>
<p>where:</p>
<ul>
<li><span class="arithmatex">\(y_t\)</span> is the value of the time series at time <span class="arithmatex">\(t\)</span>.</li>
<li><span class="arithmatex">\(\mu_t\)</span> is a time-varying mean function.</li>
<li><span class="arithmatex">\(\epsilon_t\)</span> is a stationary error term with mean zero and constant variance.</li>
</ul>
<p>The ERS test is based on the idea that if the time series is stationary, then the mean function should be a constant over time. Therefore, the null hypothesis of the ERS test is that the time series is non-stationary (unit root), and the alternative hypothesis is that the time series is stationary.</p>
<p>Here are the detailed steps for how to calculate the ERS test:</p>
<ol>
<li>
<p>Collect your time series data and plot it to visually check for any trends, seasonal patterns, or other patterns that could make the data non-stationary. If you detect any such patterns, you will need to pre-process your data (e.g., detrending, deseasonalizing, etc.) to remove these effects.</p>
</li>
<li>
<p>Estimate the time-varying mean function using a local polynomial regression method. The choice of the polynomial degree depends on the complexity of the mean function and the sample size. Typically, a quadratic or cubic polynomial is used. The estimated mean function is denoted as <span class="arithmatex">\(\mu_t\)</span>.</p>
</li>
<li>
<p>Calculate the test statistic, which is based on the following equation:</p>
<div class="arithmatex">\[
z = \left( \frac {T-1} {( \frac {1} {12\pi^2 \times \Delta^2} )} \right) ^{\frac{1}{2}} \times \left( \sum_{t=1}^T \frac {(y_t - \mu_t)^2} {T-1} \right)
\]</div>
<p>where:</p>
<ul>
<li><span class="arithmatex">\(T\)</span> is the sample size</li>
<li><span class="arithmatex">\(\Delta\)</span> is the bandwidth parameter, which controls the degree of smoothing of the mean function. The optimal value of <span class="arithmatex">\(\Delta\)</span> depends on the sample size and the noise level of the data.</li>
<li><span class="arithmatex">\(\pi\)</span> is the constant pi.</li>
</ul>
</li>
<li>
<p>Determine the critical values of the test statistic from the ERS distribution table. The critical values depend on the sample size and the level of significance.</p>
</li>
<li>
<p>Finally, interpret the results and draw conclusions about the stationarity of the time series. If the null hypothesis is rejected, then the time series is non-stationary with a time-varying mean function. If the null hypothesis is not rejected, then the time series is stationary.</p>
</li>
</ol>
<p>In practice, the ERS test is often conducted using software packages such as R, Python, or MATLAB, which automate the estimation of the time-varying mean function and calculation of the test statistic.</p>
</details>
<details class="note">
<summary>Notes</summary>
<p>The null hypothesis of the Dickey-Fuller GLS is that there is a unit root, with the alternative that there is no unit root. If the p-value is above a critical size, then the null cannot be rejected and the series appears to be a unit root.</p>
<p>DFGLS differs from the ADF test in that an initial GLS detrending step is used before a trend-less ADF regression is run.</p>
<p>Critical values and p-values when trend is <code>"c"</code> are identical to the ADF. When trend is set to <code>"ct"</code>, they are from Elliott, Rothenberg, and Stock (1996).</p>
</details>
<div class="admonition success">
<p class="admonition-title">Credit</p>
<ul>
<li>All credit goes to the <a href="https://arch.readthedocs.io/en/latest/unitroot/generated/arch.unitroot.DFGLS.html"><code>arch</code></a> library.</li>
</ul>
</div>
<details class="question">
<summary>References</summary>
<ul>
<li>Elliott, G. R., T. J. Rothenberg, and J. H. Stock. 1996. Efficient bootstrap for an autoregressive unit root. Econometrica 64: 813-836.</li>
<li>Perron, P., &amp; Qu, Z. (2007). A simple modification to improve the finite sample properties of Ng and Perronâ€™s unit root tests. Economics letters, 94(1), 12-19.</li>
</ul>
</details>
<details class="tip">
<summary>See Also</summary>
<ul>
<li><a href="https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.adfuller.html"><code>statsmodels.tsa.stattools.adfuller</code></a>: Augmented Dickey-Fuller unit root test.</li>
<li><a href="https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.kpss.html"><code>statsmodels.tsa.stattools.kpss</code></a>: Kwiatkowski-Phillips-Schmidt-Shin stationarity test.</li>
<li><a href="https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.range_unit_root_test.html"><code>statsmodels.tsa.stattools.range_unit_root_test</code></a>: Range Unit-Root test.</li>
<li><a href="https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.zivot_andrews.html"><code>statsmodels.tsa.stattools.zivot_andrews</code></a>: Zivot-Andrews structural break test.</li>
<li><a href="https://alkaline-ml.com/pmdarima/modules/generated/pmdarima.arima.PPTest.html"><code>pmdarima.arima.PPTest</code></a>: Phillips-Perron unit root test.</li>
<li><a href="https://arch.readthedocs.io/en/latest/unitroot/generated/arch.unitroot.DFGLS.html"><code>arch.unitroot.DFGLS</code></a>: Elliot, Rothenberg and Stock's GLS-detrended Dickey-Fuller.</li>
<li><a href="https://arch.readthedocs.io/en/latest/unitroot/generated/arch.unitroot.VarianceRatio.html"><code>arch.unitroot.VarianceRatio</code></a>: Variance Ratio test of a random walk.</li>
<li><a class="autorefs autorefs-internal" title="            adf" href="#ts_stat_tests.algorithms.stationarity.adf"><code>ts_stat_tests.algorithms.stationarity.adf</code></a>: Augmented Dickey-Fuller unit root test.</li>
<li><a class="autorefs autorefs-internal" title="            kpss" href="#ts_stat_tests.algorithms.stationarity.kpss"><code>ts_stat_tests.algorithms.stationarity.kpss</code></a>: Kwiatkowski-Phillips-Schmidt-Shin stationarity test.</li>
<li><a class="autorefs autorefs-internal" title="            rur" href="#ts_stat_tests.algorithms.stationarity.rur"><code>ts_stat_tests.algorithms.stationarity.rur</code></a>: Range Unit-Root test of stationarity.</li>
<li><a class="autorefs autorefs-internal" title="            za" href="#ts_stat_tests.algorithms.stationarity.za"><code>ts_stat_tests.algorithms.stationarity.za</code></a>: Zivot-Andrews structural break unit root test.</li>
<li><a class="autorefs autorefs-internal" title="            pp" href="#ts_stat_tests.algorithms.stationarity.pp"><code>ts_stat_tests.algorithms.stationarity.pp</code></a>: Phillips-Perron unit root test.</li>
<li><a class="autorefs autorefs-internal" title="            ers" href="#ts_stat_tests.algorithms.stationarity.ers"><code>ts_stat_tests.algorithms.stationarity.ers</code></a>: Elliot, Rothenberg and Stock's GLS-detrended Dickey-Fuller test.</li>
<li><a class="autorefs autorefs-internal" title="            vr" href="#ts_stat_tests.algorithms.stationarity.vr"><code>ts_stat_tests.algorithms.stationarity.vr</code></a>: Variance Ratio test of a random walk.</li>
</ul>
</details>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/ts_stat_tests/algorithms/stationarity.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@typechecked</span>
<span class="k">def</span><span class="w"> </span><span class="nf">ers</span><span class="p">(</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
    <span class="n">lags</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">trend</span><span class="p">:</span> <span class="n">VALID_ERS_TREND_OPTIONS</span> <span class="o">=</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span>
    <span class="n">max_lags</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">method</span><span class="p">:</span> <span class="n">VALID_ERS_METHOD_OPTIONS</span> <span class="o">=</span> <span class="s2">&quot;aic&quot;</span><span class="p">,</span>
    <span class="n">low_memory</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    !!! note &quot;Summary&quot;</span>
<span class="sd">        Elliott, Rothenberg and Stock&#39;s GLS detrended Dickey-Fuller.</span>

<span class="sd">    ???+ abstract &quot;Details&quot;</span>

<span class="sd">        The Elliott-Rothenberg-Stock (ERS) test is a statistical test used to determine whether a time series is stationary or not. It is a robust test that is able to handle a wide range of non-stationary processes, including ones with structural breaks, heteroscedasticity, and autocorrelation.</span>

<span class="sd">        The ERS test involves fitting a local-to-zero regression of the time series on a constant and a linear time trend, using a kernel function to weight the observations. The test statistic is then calculated based on the sum of the squared residuals of the local-to-zero regression, which is adjusted for the bandwidth of the kernel function and for the correlation of the residuals.</span>

<span class="sd">        If the test statistic is less than a critical value at a given significance level, typically 0.05, then we reject the null hypothesis and conclude that the time series is stationary. If the test statistic is greater than the critical value, then we fail to reject the null hypothesis and conclude that the time series is non-stationary.</span>

<span class="sd">        In practical terms, if a time series is found to be non-stationary by the ERS test, one can apply differencing to the time series until it becomes stationary. This involves taking the difference between consecutive observations and potentially repeating this process until the time series is stationary.</span>

<span class="sd">        Overall, the ERS test is a powerful and flexible test for stationarity, and it is widely used in time series analysis and forecasting. However, it is important to use multiple tests and diagnostic tools to determine the stationarity of a time series, as no single test is perfect in all situations.</span>

<span class="sd">    Params:</span>
<span class="sd">        y (ArrayLike):</span>
<span class="sd">            The data to test for a unit root.</span>
<span class="sd">        lags (Optional[int], optional):</span>
<span class="sd">            The number of lags to use in the ADF regression. If omitted or `None`, method is used to automatically select the lag length with no more than `max_lags` are included.&lt;br&gt;</span>
<span class="sd">            Defaults to `None`.</span>
<span class="sd">        trend (VALID_ERS_TREND_OPTIONS, optional):</span>
<span class="sd">            The trend component to include in the test</span>

<span class="sd">            - `&quot;c&quot;`: Include a constant (Default)</span>
<span class="sd">            - `&quot;ct&quot;`: Include a constant and linear time trend</span>

<span class="sd">            Defaults to `&quot;c&quot;`.</span>
<span class="sd">        max_lags (Optional[int], optional):</span>
<span class="sd">            The maximum number of lags to use when selecting lag length. When using automatic lag length selection, the lag is selected using OLS detrending rather than GLS detrending.&lt;br&gt;</span>
<span class="sd">            Defaults to `None`.</span>
<span class="sd">        method (VALID_ERS_METHOD_OPTIONS, optional):</span>
<span class="sd">            The method to use when selecting the lag length</span>

<span class="sd">            - `&quot;AIC&quot;`: Select the minimum of the Akaike IC</span>
<span class="sd">            - `&quot;BIC&quot;`: Select the minimum of the Schwarz/Bayesian IC</span>
<span class="sd">            - `&quot;t-stat&quot;`: Select the minimum of the Schwarz/Bayesian IC</span>

<span class="sd">            Defaults to `&quot;aic&quot;`.</span>
<span class="sd">        low_memory (Optional[bool], optional):</span>
<span class="sd">            Flag indicating whether to use the low-memory algorithm for lag-length selection.</span>
<span class="sd">            Defaults to `None`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (tuple[float, float, int, dict]):</span>
<span class="sd">            Returns a tuple containing:</span>
<span class="sd">            - `stat` (float): The test statistic for a unit root.</span>
<span class="sd">            - `pvalue` (float): The p-value for the test statistic.</span>
<span class="sd">            - `lags` (int): The number of lags used in the test.</span>
<span class="sd">            - `crit` (dict): The critical values for the test statistic at the 1%, 5%, and 10% levels.</span>

<span class="sd">    ???+ example &quot;Examples&quot;</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Setup&quot;}</span>
<span class="sd">        &gt;&gt;&gt; from ts_stat_tests.algorithms.stationarity import ers</span>
<span class="sd">        &gt;&gt;&gt; from ts_stat_tests.utils.data import data_airline, data_normal, data_noise</span>
<span class="sd">        &gt;&gt;&gt; normal = data_normal</span>
<span class="sd">        &gt;&gt;&gt; noise = data_noise</span>
<span class="sd">        &gt;&gt;&gt; airline = data_airline.values</span>

<span class="sd">        ```</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Example 1: Stationary Series&quot;}</span>
<span class="sd">        &gt;&gt;&gt; stat, pvalue, lags, crit = ers(y=normal)</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;ERS statistic: {stat:.4f}&quot;)</span>
<span class="sd">        ERS statistic: -30.1517</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;p-value: {pvalue:.4f}&quot;)</span>
<span class="sd">        p-value: 0.0000</span>

<span class="sd">        ```</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Example 2: Noisy Series&quot;}</span>
<span class="sd">        &gt;&gt;&gt; stat, pvalue, lags, crit = ers(y=noise)</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;ERS statistic: {stat:.4f}&quot;)</span>
<span class="sd">        ERS statistic: -12.6897</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;p-value: {pvalue:.4e}&quot;)</span>
<span class="sd">        p-value: 1.0956e-21</span>

<span class="sd">        ```</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Example 3: Real-World Time Series&quot;}</span>
<span class="sd">        &gt;&gt;&gt; stat, pvalue, lags, crit = ers(y=airline)</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;ERS statistic: {stat:.4f}&quot;)</span>
<span class="sd">        ERS statistic: 0.9918</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;p-value: {pvalue:.4f}&quot;)</span>
<span class="sd">        p-value: 0.9232</span>

<span class="sd">        ```</span>

<span class="sd">    ??? equation &quot;Calculation&quot;</span>

<span class="sd">        The mathematical equation for the ERS test is:</span>

<span class="sd">        $$</span>
<span class="sd">        y_t = \mu_t + \epsilon_t</span>
<span class="sd">        $$</span>

<span class="sd">        where:</span>

<span class="sd">        - $y_t$ is the value of the time series at time $t$.</span>
<span class="sd">        - $\mu_t$ is a time-varying mean function.</span>
<span class="sd">        - $\epsilon_t$ is a stationary error term with mean zero and constant variance.</span>

<span class="sd">        The ERS test is based on the idea that if the time series is stationary, then the mean function should be a constant over time. Therefore, the null hypothesis of the ERS test is that the time series is non-stationary (unit root), and the alternative hypothesis is that the time series is stationary.</span>

<span class="sd">        Here are the detailed steps for how to calculate the ERS test:</span>

<span class="sd">        1. Collect your time series data and plot it to visually check for any trends, seasonal patterns, or other patterns that could make the data non-stationary. If you detect any such patterns, you will need to pre-process your data (e.g., detrending, deseasonalizing, etc.) to remove these effects.</span>

<span class="sd">        1. Estimate the time-varying mean function using a local polynomial regression method. The choice of the polynomial degree depends on the complexity of the mean function and the sample size. Typically, a quadratic or cubic polynomial is used. The estimated mean function is denoted as $\mu_t$.</span>

<span class="sd">        1. Calculate the test statistic, which is based on the following equation:</span>

<span class="sd">            $$</span>
<span class="sd">            z = \left( \frac {T-1} {( \frac {1} {12\pi^2 \times \Delta^2} )} \right) ^{\frac{1}{2}} \times \left( \sum_{t=1}^T \frac {(y_t - \mu_t)^2} {T-1} \right)</span>
<span class="sd">            $$</span>

<span class="sd">            where:</span>

<span class="sd">            - $T$ is the sample size</span>
<span class="sd">            - $\Delta$ is the bandwidth parameter, which controls the degree of smoothing of the mean function. The optimal value of $\Delta$ depends on the sample size and the noise level of the data.</span>
<span class="sd">            - $\pi$ is the constant pi.</span>

<span class="sd">        1. Determine the critical values of the test statistic from the ERS distribution table. The critical values depend on the sample size and the level of significance.</span>

<span class="sd">        1. Finally, interpret the results and draw conclusions about the stationarity of the time series. If the null hypothesis is rejected, then the time series is non-stationary with a time-varying mean function. If the null hypothesis is not rejected, then the time series is stationary.</span>

<span class="sd">        In practice, the ERS test is often conducted using software packages such as R, Python, or MATLAB, which automate the estimation of the time-varying mean function and calculation of the test statistic.</span>

<span class="sd">    ??? note &quot;Notes&quot;</span>
<span class="sd">        The null hypothesis of the Dickey-Fuller GLS is that there is a unit root, with the alternative that there is no unit root. If the p-value is above a critical size, then the null cannot be rejected and the series appears to be a unit root.</span>

<span class="sd">        DFGLS differs from the ADF test in that an initial GLS detrending step is used before a trend-less ADF regression is run.</span>

<span class="sd">        Critical values and p-values when trend is `&quot;c&quot;` are identical to the ADF. When trend is set to `&quot;ct&quot;`, they are from Elliott, Rothenberg, and Stock (1996).</span>

<span class="sd">    !!! success &quot;Credit&quot;</span>
<span class="sd">        - All credit goes to the [`arch`](https://arch.readthedocs.io/en/latest/unitroot/generated/arch.unitroot.DFGLS.html) library.</span>

<span class="sd">    ??? question &quot;References&quot;</span>
<span class="sd">        - Elliott, G. R., T. J. Rothenberg, and J. H. Stock. 1996. Efficient bootstrap for an autoregressive unit root. Econometrica 64: 813-836.</span>
<span class="sd">        - Perron, P., &amp; Qu, Z. (2007). A simple modification to improve the finite sample properties of Ng and Perronâ€™s unit root tests. Economics letters, 94(1), 12-19.</span>

<span class="sd">    ??? tip &quot;See Also&quot;</span>
<span class="sd">        - [`statsmodels.tsa.stattools.adfuller`](https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.adfuller.html): Augmented Dickey-Fuller unit root test.</span>
<span class="sd">        - [`statsmodels.tsa.stattools.kpss`](https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.kpss.html): Kwiatkowski-Phillips-Schmidt-Shin stationarity test.</span>
<span class="sd">        - [`statsmodels.tsa.stattools.range_unit_root_test`](https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.range_unit_root_test.html): Range Unit-Root test.</span>
<span class="sd">        - [`statsmodels.tsa.stattools.zivot_andrews`](https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.zivot_andrews.html): Zivot-Andrews structural break test.</span>
<span class="sd">        - [`pmdarima.arima.PPTest`](https://alkaline-ml.com/pmdarima/modules/generated/pmdarima.arima.PPTest.html): Phillips-Perron unit root test.</span>
<span class="sd">        - [`arch.unitroot.DFGLS`](https://arch.readthedocs.io/en/latest/unitroot/generated/arch.unitroot.DFGLS.html): Elliot, Rothenberg and Stock&#39;s GLS-detrended Dickey-Fuller.</span>
<span class="sd">        - [`arch.unitroot.VarianceRatio`](https://arch.readthedocs.io/en/latest/unitroot/generated/arch.unitroot.VarianceRatio.html): Variance Ratio test of a random walk.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.stationarity.adf`][ts_stat_tests.algorithms.stationarity.adf]: Augmented Dickey-Fuller unit root test.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.stationarity.kpss`][ts_stat_tests.algorithms.stationarity.kpss]: Kwiatkowski-Phillips-Schmidt-Shin stationarity test.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.stationarity.rur`][ts_stat_tests.algorithms.stationarity.rur]: Range Unit-Root test of stationarity.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.stationarity.za`][ts_stat_tests.algorithms.stationarity.za]: Zivot-Andrews structural break unit root test.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.stationarity.pp`][ts_stat_tests.algorithms.stationarity.pp]: Phillips-Perron unit root test.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.stationarity.ers`][ts_stat_tests.algorithms.stationarity.ers]: Elliot, Rothenberg and Stock&#39;s GLS-detrended Dickey-Fuller test.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.stationarity.vr`][ts_stat_tests.algorithms.stationarity.vr]: Variance Ratio test of a random walk.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">_ers</span><span class="p">(</span>
        <span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">y</span><span class="p">),</span>
        <span class="n">lags</span><span class="o">=</span><span class="n">lags</span><span class="p">,</span>
        <span class="n">trend</span><span class="o">=</span><span class="n">trend</span><span class="p">,</span>
        <span class="n">max_lags</span><span class="o">=</span><span class="n">max_lags</span><span class="p">,</span>
        <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
        <span class="n">low_memory</span><span class="o">=</span><span class="n">low_memory</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">stat</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">pvalue</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">lags</span><span class="p">),</span> <span class="nb">dict</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">critical_values</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="ts_stat_tests.algorithms.stationarity.vr" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">vr</span>


<a href="#ts_stat_tests.algorithms.stationarity.vr" class="headerlink" title="Permanent link">ðŸ”—</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">vr</span><span class="p">(</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
    <span class="n">lags</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">trend</span><span class="p">:</span> <span class="n">VALID_VR_TREND_OPTIONS</span> <span class="o">=</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span>
    <span class="n">debiased</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">robust</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">overlap</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <div class="admonition note">
<p class="admonition-title">Summary</p>
<p>Variance Ratio test of a random walk.</p>
</div>
<details class="abstract" open="open">
<summary>Details</summary>
<p>The Variance Ratio (VR) test is a statistical test used to determine whether a time series is stationary or not based on the presence of long-term dependence in the series. It is a non-parametric test that can be used to test for the presence of a unit root or a trend in the series.</p>
<p>The VR test involves calculating the ratio of the variance of the differences of the logarithms of the time series over different time intervals. The variance of the differences of the logarithms is a measure of the volatility of the series, and the ratio of the variances over different intervals is a measure of the long-term dependence in the series.</p>
<p>If the series is stationary, then the variance ratio will be close to one for all intervals. If the series is non-stationary, then the variance ratio will tend to increase as the length of the interval increases, reflecting the presence of long-term dependence in the series.</p>
<p>The VR test involves comparing the observed variance ratio to the distribution of variance ratios expected under the null hypothesis of a random walk (non-stationary). If the test statistic is less than a critical value at a given significance level, typically 0.05, then we reject the null hypothesis and conclude that the time series is stationary. If the test statistic is greater than the critical value, then we fail to reject the null hypothesis and conclude that the time series is non-stationary.</p>
<p>In practical terms, if a time series is found to be non-stationary by the VR test, one can apply differencing to the time series until it becomes stationary. This involves taking the difference between consecutive observations and potentially repeating this process until the time series is stationary.</p>
<p>Overall, the VR test is a useful and relatively simple test for stationarity that can be applied to a wide range of time series. However, it is important to use multiple tests and diagnostic tools to confirm the stationarity of a time series, as no single test is perfect in all situations.</p>
</details>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>y</code>
            </td>
            <td>
                  <code><span title="numpy.typing.ArrayLike">ArrayLike</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The data to test for a random walk.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>lags</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of periods to used in the multi-period variance, which is the numerator of the test statistic. Must be at least 2.<br>
Defaults to <code>2</code>.</p>
              </div>
            </td>
            <td>
                  <code>2</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>trend</code>
            </td>
            <td>
                  <code><span title="ts_stat_tests.algorithms.stationarity.VALID_VR_TREND_OPTIONS">VALID_VR_TREND_OPTIONS</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>"c"</code> allows for a non-zero drift in the random walk, while <code>"n"</code> requires that the increments to <code>y</code> are mean <code>0</code>.<br>
Defaults to <code>"c"</code>.</p>
              </div>
            </td>
            <td>
                  <code>&#39;c&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>debiased</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Indicates whether to use a debiased version of the test. Only applicable if <code>overlap</code> is <code>True</code>.<br>
Defaults to <code>True</code>.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>robust</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Indicates whether to use heteroskedasticity robust inference.<br>
Defaults to <code>True</code>.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>overlap</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Indicates whether to use all overlapping blocks. If <code>False</code>, the number of observations in <span class="arithmatex">\(y-1\)</span> must be an exact multiple of <code>lags</code>. If this condition is not satisfied, some values at the end of <code>y</code> will be discarded.<br>
Defaults to <code>True</code>.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<span title="float">float</span>, <span title="float">float</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Returns a tuple containing:
- <code>stat</code> (float): The test statistic for a unit root.
- <code>pvalue</code> (float): The p-value for the test statistic.
- <code>vr</code> (float): The ratio of the long block lags-period variance.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <details class="example" open="open">
<summary>Examples</summary>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Setup</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ts_stat_tests.algorithms.stationarity</span><span class="w"> </span><span class="kn">import</span> <span class="n">vr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ts_stat_tests.utils.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">data_airline</span><span class="p">,</span> <span class="n">data_normal</span><span class="p">,</span> <span class="n">data_noise</span><span class="p">,</span> <span class="n">data_sine</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">normal</span> <span class="o">=</span> <span class="n">data_normal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">noise</span> <span class="o">=</span> <span class="n">data_noise</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">seasonal</span> <span class="o">=</span> <span class="n">data_sine</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">airline</span> <span class="o">=</span> <span class="n">data_airline</span><span class="o">.</span><span class="n">values</span>
</code></pre></div></td></tr></table></div>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 1: Stationary Series</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">stat</span><span class="p">,</span> <span class="n">pvalue</span><span class="p">,</span> <span class="n">variance_ratio</span> <span class="o">=</span> <span class="n">vr</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">normal</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;VR statistic: </span><span class="si">{</span><span class="n">stat</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">VR statistic: -12.8518</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;p-value: </span><span class="si">{</span><span class="n">pvalue</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">p-value: 0.0000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Variance ratio: </span><span class="si">{</span><span class="n">variance_ratio</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">Variance ratio: 0.5202</span>
</code></pre></div></td></tr></table></div>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 2: Noisy Series</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">stat</span><span class="p">,</span> <span class="n">pvalue</span><span class="p">,</span> <span class="n">variance_ratio</span> <span class="o">=</span> <span class="n">vr</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">noise</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;VR statistic: </span><span class="si">{</span><span class="n">stat</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">VR statistic: -11.5007</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;p-value: </span><span class="si">{</span><span class="n">pvalue</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">p-value: 0.0000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Variance ratio: </span><span class="si">{</span><span class="n">variance_ratio</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">Variance ratio: 0.5094</span>
</code></pre></div></td></tr></table></div>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 3: Seasonal Series</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">stat</span><span class="p">,</span> <span class="n">pvalue</span><span class="p">,</span> <span class="n">variance_ratio</span> <span class="o">=</span> <span class="n">vr</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">seasonal</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;VR statistic: </span><span class="si">{</span><span class="n">stat</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">VR statistic: 44.7019</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;p-value: </span><span class="si">{</span><span class="n">pvalue</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">p-value: 0.0000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Variance ratio: </span><span class="si">{</span><span class="n">variance_ratio</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">Variance ratio: 1.9980</span>
</code></pre></div></td></tr></table></div>
<div class="py python highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Example 4: Real-World Time Series</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">stat</span><span class="p">,</span> <span class="n">pvalue</span><span class="p">,</span> <span class="n">variance_ratio</span> <span class="o">=</span> <span class="n">vr</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">airline</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;VR statistic: </span><span class="si">{</span><span class="n">stat</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">VR statistic: 3.1511</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;p-value: </span><span class="si">{</span><span class="n">pvalue</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">p-value: 0.0016</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Variance ratio: </span><span class="si">{</span><span class="n">variance_ratio</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">Variance ratio: 1.3163</span>
</code></pre></div></td></tr></table></div>
</details>
<details class="equation">
<summary>Calculation</summary>
<p>The Variance Ratio (VR) test is a statistical test for stationarity in time series forecasting that is based on the idea that if the time series is stationary, then the variance of the returns should be constant over time. The mathematical equation for the VR test is:</p>
<div class="arithmatex">\[
VR(k) = \frac {\sigma^2(k)} {k\sigma^2(1)}
\]</div>
<p>where:</p>
<ul>
<li><span class="arithmatex">\(VR(k)\)</span> is the variance ratio for the time series over <span class="arithmatex">\(k\)</span> periods.</li>
<li><span class="arithmatex">\(\sigma^2(k)\)</span> is the variance of the returns over <span class="arithmatex">\(k\)</span> periods.</li>
<li><span class="arithmatex">\(\sigma^2(1)\)</span> is the variance of the returns over <span class="arithmatex">\(1\)</span> period.</li>
</ul>
<p>The VR test involves comparing the variance ratio to a critical value, which is derived from the null distribution of the variance ratio under the assumption of a random walk with drift.</p>
<p>Here are the detailed steps for how to calculate the VR test:</p>
<ol>
<li>
<p>Collect your time series data and compute the log returns, which are defined as:</p>
<div class="arithmatex">\[
r_t = \log(y_t) - \log(y_{t-1})
\]</div>
<p>where:</p>
<ul>
<li><span class="arithmatex">\(y_t\)</span> is the value of the time series at time <span class="arithmatex">\(t\)</span>.</li>
</ul>
</li>
<li>
<p>Compute the variance of the returns over <span class="arithmatex">\(k\)</span> periods, which is defined as:</p>
<div class="arithmatex">\[
\sigma^2(k) = \left( \frac {1} {n-k} \right) \times \sum_{t=k+1}^n (r_t - \mu_k)^2
\]</div>
<p>where:</p>
<ul>
<li><span class="arithmatex">\(n\)</span> is the sample size.</li>
<li>
<p><span class="arithmatex">\(\mu_k\)</span> is the mean of the returns over <span class="arithmatex">\(k\)</span> periods, which is defined as:</p>
<p><span class="arithmatex">\(\mu_k = \left( \frac{1} {n-k} \right) \times \sum_{t=k+1}^n r_t\)</span></p>
</li>
</ul>
</li>
<li>
<p>Compute the variance of the returns over <span class="arithmatex">\(1\)</span> period, which is defined as:</p>
<div class="arithmatex">\[
\sigma^2(1) = \left( \frac{1} {n-1} \right) \times \sum_{t=2}^n (r_t - \mu_1)^2
\]</div>
<p>where:</p>
<ul>
<li>
<p><span class="arithmatex">\(\mu_1\)</span> is the mean of the returns over <span class="arithmatex">\(1\)</span> period, which is defined as:</p>
<p><span class="arithmatex">\(\mu_1 = \left( \frac{1} {n-1} \right) \times \sum_{t=2}^n r_t\)</span></p>
</li>
</ul>
</li>
<li>
<p>Compute the variance ratio for each value of <span class="arithmatex">\(k\)</span>, which is defined as:</p>
<div class="arithmatex">\[
VR(k) = \frac {\sigma^2(k)} {k\sigma^2(1)}
\]</div>
</li>
<li>
<p>Determine the critical values of the variance ratio from the null distribution table of the VR test, which depend on the sample size, the level of significance, and the lag length <span class="arithmatex">\(k\)</span>.</p>
</li>
<li>
<p>Finally, compare the variance ratio to the critical value. If the variance ratio is greater than the critical value, then the null hypothesis of a random walk with drift is rejected, and the time series is considered stationary. If the variance ratio is less than or equal to the critical value, then the null hypothesis cannot be rejected, and the time series is considered non-stationary.</p>
</li>
</ol>
<p>In practice, the VR test is often conducted using software packages such as R, Python, or MATLAB, which automate the calculation of the variance ratio and the determination of the critical value.</p>
</details>
<details class="note">
<summary>Notes</summary>
<p>The null hypothesis of a VR is that the process is a random walk, possibly plus drift. Rejection of the null with a positive test statistic indicates the presence of positive serial correlation in the time series.</p>
</details>
<div class="admonition success">
<p class="admonition-title">Credit</p>
<ul>
<li>All credit goes to the <a href="https://arch.readthedocs.io/en/latest/unitroot/generated/arch.unitroot.VarianceRatio.html"><code>arch</code></a> library.</li>
</ul>
</div>
<details class="question">
<summary>References</summary>
<ul>
<li>Campbell, John Y., Lo, Andrew W. and MacKinlay, A. Craig. (1997) The Econometrics of Financial Markets. Princeton, NJ: Princeton University Press.</li>
</ul>
</details>
<details class="tip">
<summary>See Also</summary>
<ul>
<li><a href="https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.adfuller.html"><code>statsmodels.tsa.stattools.adfuller</code></a>: Augmented Dickey-Fuller unit root test.</li>
<li><a href="https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.kpss.html"><code>statsmodels.tsa.stattools.kpss</code></a>: Kwiatkowski-Phillips-Schmidt-Shin stationarity test.</li>
<li><a href="https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.range_unit_root_test.html"><code>statsmodels.tsa.stattools.range_unit_root_test</code></a>: Range Unit-Root test.</li>
<li><a href="https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.zivot_andrews.html"><code>statsmodels.tsa.stattools.zivot_andrews</code></a>: Zivot-Andrews structural break test.</li>
<li><a href="https://alkaline-ml.com/pmdarima/modules/generated/pmdarima.arima.PPTest.html"><code>pmdarima.arima.PPTest</code></a>: Phillips-Perron unit root test.</li>
<li><a href="https://arch.readthedocs.io/en/latest/unitroot/generated/arch.unitroot.DFGLS.html"><code>arch.unitroot.DFGLS</code></a>: Elliot, Rothenberg and Stock's GLS-detrended Dickey-Fuller.</li>
<li><a href="https://arch.readthedocs.io/en/latest/unitroot/generated/arch.unitroot.VarianceRatio.html"><code>arch.unitroot.VarianceRatio</code></a>: Variance Ratio test of a random walk.</li>
<li><a class="autorefs autorefs-internal" title="            adf" href="#ts_stat_tests.algorithms.stationarity.adf"><code>ts_stat_tests.algorithms.stationarity.adf</code></a>: Augmented Dickey-Fuller unit root test.</li>
<li><a class="autorefs autorefs-internal" title="            kpss" href="#ts_stat_tests.algorithms.stationarity.kpss"><code>ts_stat_tests.algorithms.stationarity.kpss</code></a>: Kwiatkowski-Phillips-Schmidt-Shin stationarity test.</li>
<li><a class="autorefs autorefs-internal" title="            rur" href="#ts_stat_tests.algorithms.stationarity.rur"><code>ts_stat_tests.algorithms.stationarity.rur</code></a>: Range Unit-Root test of stationarity.</li>
<li><a class="autorefs autorefs-internal" title="            za" href="#ts_stat_tests.algorithms.stationarity.za"><code>ts_stat_tests.algorithms.stationarity.za</code></a>: Zivot-Andrews structural break unit root test.</li>
<li><a class="autorefs autorefs-internal" title="            pp" href="#ts_stat_tests.algorithms.stationarity.pp"><code>ts_stat_tests.algorithms.stationarity.pp</code></a>: Phillips-Perron unit root test.</li>
<li><a class="autorefs autorefs-internal" title="            ers" href="#ts_stat_tests.algorithms.stationarity.ers"><code>ts_stat_tests.algorithms.stationarity.ers</code></a>: Elliot, Rothenberg and Stock's GLS-detrended Dickey-Fuller test.</li>
<li><a class="autorefs autorefs-internal" title="            vr" href="#ts_stat_tests.algorithms.stationarity.vr"><code>ts_stat_tests.algorithms.stationarity.vr</code></a>: Variance Ratio test of a random walk.</li>
</ul>
</details>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/ts_stat_tests/algorithms/stationarity.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span>
<span class="normal">1467</span>
<span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@typechecked</span>
<span class="k">def</span><span class="w"> </span><span class="nf">vr</span><span class="p">(</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
    <span class="n">lags</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">trend</span><span class="p">:</span> <span class="n">VALID_VR_TREND_OPTIONS</span> <span class="o">=</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span>
    <span class="n">debiased</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">robust</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">overlap</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    !!! note &quot;Summary&quot;</span>
<span class="sd">        Variance Ratio test of a random walk.</span>

<span class="sd">    ???+ abstract &quot;Details&quot;</span>

<span class="sd">        The Variance Ratio (VR) test is a statistical test used to determine whether a time series is stationary or not based on the presence of long-term dependence in the series. It is a non-parametric test that can be used to test for the presence of a unit root or a trend in the series.</span>

<span class="sd">        The VR test involves calculating the ratio of the variance of the differences of the logarithms of the time series over different time intervals. The variance of the differences of the logarithms is a measure of the volatility of the series, and the ratio of the variances over different intervals is a measure of the long-term dependence in the series.</span>

<span class="sd">        If the series is stationary, then the variance ratio will be close to one for all intervals. If the series is non-stationary, then the variance ratio will tend to increase as the length of the interval increases, reflecting the presence of long-term dependence in the series.</span>

<span class="sd">        The VR test involves comparing the observed variance ratio to the distribution of variance ratios expected under the null hypothesis of a random walk (non-stationary). If the test statistic is less than a critical value at a given significance level, typically 0.05, then we reject the null hypothesis and conclude that the time series is stationary. If the test statistic is greater than the critical value, then we fail to reject the null hypothesis and conclude that the time series is non-stationary.</span>

<span class="sd">        In practical terms, if a time series is found to be non-stationary by the VR test, one can apply differencing to the time series until it becomes stationary. This involves taking the difference between consecutive observations and potentially repeating this process until the time series is stationary.</span>

<span class="sd">        Overall, the VR test is a useful and relatively simple test for stationarity that can be applied to a wide range of time series. However, it is important to use multiple tests and diagnostic tools to confirm the stationarity of a time series, as no single test is perfect in all situations.</span>

<span class="sd">    Params:</span>
<span class="sd">        y (ArrayLike):</span>
<span class="sd">            The data to test for a random walk.</span>
<span class="sd">        lags (int):</span>
<span class="sd">            The number of periods to used in the multi-period variance, which is the numerator of the test statistic. Must be at least 2.&lt;br&gt;</span>
<span class="sd">            Defaults to `2`.</span>
<span class="sd">        trend (VALID_VR_TREND_OPTIONS, optional):</span>
<span class="sd">            `&quot;c&quot;` allows for a non-zero drift in the random walk, while `&quot;n&quot;` requires that the increments to `y` are mean `0`.&lt;br&gt;</span>
<span class="sd">            Defaults to `&quot;c&quot;`.</span>
<span class="sd">        debiased (bool, optional):</span>
<span class="sd">            Indicates whether to use a debiased version of the test. Only applicable if `overlap` is `True`.&lt;br&gt;</span>
<span class="sd">            Defaults to `True`.</span>
<span class="sd">        robust (bool, optional):</span>
<span class="sd">            Indicates whether to use heteroskedasticity robust inference.&lt;br&gt;</span>
<span class="sd">            Defaults to `True`.</span>
<span class="sd">        overlap (bool, optional):</span>
<span class="sd">            Indicates whether to use all overlapping blocks. If `False`, the number of observations in $y-1$ must be an exact multiple of `lags`. If this condition is not satisfied, some values at the end of `y` will be discarded.&lt;br&gt;</span>
<span class="sd">            Defaults to `True`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (tuple[float, float, float]):</span>
<span class="sd">            Returns a tuple containing:</span>
<span class="sd">            - `stat` (float): The test statistic for a unit root.</span>
<span class="sd">            - `pvalue` (float): The p-value for the test statistic.</span>
<span class="sd">            - `vr` (float): The ratio of the long block lags-period variance.</span>

<span class="sd">    ???+ example &quot;Examples&quot;</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Setup&quot;}</span>
<span class="sd">        &gt;&gt;&gt; from ts_stat_tests.algorithms.stationarity import vr</span>
<span class="sd">        &gt;&gt;&gt; from ts_stat_tests.utils.data import data_airline, data_normal, data_noise, data_sine</span>
<span class="sd">        &gt;&gt;&gt; normal = data_normal</span>
<span class="sd">        &gt;&gt;&gt; noise = data_noise</span>
<span class="sd">        &gt;&gt;&gt; seasonal = data_sine</span>
<span class="sd">        &gt;&gt;&gt; airline = data_airline.values</span>

<span class="sd">        ```</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Example 1: Stationary Series&quot;}</span>
<span class="sd">        &gt;&gt;&gt; stat, pvalue, variance_ratio = vr(y=normal)</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;VR statistic: {stat:.4f}&quot;)</span>
<span class="sd">        VR statistic: -12.8518</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;p-value: {pvalue:.4f}&quot;)</span>
<span class="sd">        p-value: 0.0000</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;Variance ratio: {variance_ratio:.4f}&quot;)</span>
<span class="sd">        Variance ratio: 0.5202</span>

<span class="sd">        ```</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Example 2: Noisy Series&quot;}</span>
<span class="sd">        &gt;&gt;&gt; stat, pvalue, variance_ratio = vr(y=noise)</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;VR statistic: {stat:.4f}&quot;)</span>
<span class="sd">        VR statistic: -11.5007</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;p-value: {pvalue:.4f}&quot;)</span>
<span class="sd">        p-value: 0.0000</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;Variance ratio: {variance_ratio:.4f}&quot;)</span>
<span class="sd">        Variance ratio: 0.5094</span>

<span class="sd">        ```</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Example 3: Seasonal Series&quot;}</span>
<span class="sd">        &gt;&gt;&gt; stat, pvalue, variance_ratio = vr(y=seasonal)</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;VR statistic: {stat:.4f}&quot;)</span>
<span class="sd">        VR statistic: 44.7019</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;p-value: {pvalue:.4f}&quot;)</span>
<span class="sd">        p-value: 0.0000</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;Variance ratio: {variance_ratio:.4f}&quot;)</span>
<span class="sd">        Variance ratio: 1.9980</span>

<span class="sd">        ```</span>

<span class="sd">        ```pycon {.py .python linenums=&quot;1&quot; title=&quot;Example 4: Real-World Time Series&quot;}</span>
<span class="sd">        &gt;&gt;&gt; stat, pvalue, variance_ratio = vr(y=airline)</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;VR statistic: {stat:.4f}&quot;)</span>
<span class="sd">        VR statistic: 3.1511</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;p-value: {pvalue:.4f}&quot;)</span>
<span class="sd">        p-value: 0.0016</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;Variance ratio: {variance_ratio:.4f}&quot;)</span>
<span class="sd">        Variance ratio: 1.3163</span>

<span class="sd">        ```</span>

<span class="sd">    ??? equation &quot;Calculation&quot;</span>

<span class="sd">        The Variance Ratio (VR) test is a statistical test for stationarity in time series forecasting that is based on the idea that if the time series is stationary, then the variance of the returns should be constant over time. The mathematical equation for the VR test is:</span>

<span class="sd">        $$</span>
<span class="sd">        VR(k) = \frac {\sigma^2(k)} {k\sigma^2(1)}</span>
<span class="sd">        $$</span>

<span class="sd">        where:</span>

<span class="sd">        - $VR(k)$ is the variance ratio for the time series over $k$ periods.</span>
<span class="sd">        - $\sigma^2(k)$ is the variance of the returns over $k$ periods.</span>
<span class="sd">        - $\sigma^2(1)$ is the variance of the returns over $1$ period.</span>

<span class="sd">        The VR test involves comparing the variance ratio to a critical value, which is derived from the null distribution of the variance ratio under the assumption of a random walk with drift.</span>

<span class="sd">        Here are the detailed steps for how to calculate the VR test:</span>

<span class="sd">        1. Collect your time series data and compute the log returns, which are defined as:</span>

<span class="sd">            $$</span>
<span class="sd">            r_t = \log(y_t) - \log(y_{t-1})</span>
<span class="sd">            $$</span>

<span class="sd">            where:</span>

<span class="sd">            - $y_t$ is the value of the time series at time $t$.</span>

<span class="sd">        1. Compute the variance of the returns over $k$ periods, which is defined as:</span>

<span class="sd">            $$</span>
<span class="sd">            \sigma^2(k) = \left( \frac {1} {n-k} \right) \times \sum_{t=k+1}^n (r_t - \mu_k)^2</span>
<span class="sd">            $$</span>

<span class="sd">            where:</span>

<span class="sd">            - $n$ is the sample size.</span>
<span class="sd">            - $\mu_k$ is the mean of the returns over $k$ periods, which is defined as:</span>

<span class="sd">                $\mu_k = \left( \frac{1} {n-k} \right) \times \sum_{t=k+1}^n r_t$</span>

<span class="sd">        1. Compute the variance of the returns over $1$ period, which is defined as:</span>

<span class="sd">            $$</span>
<span class="sd">            \sigma^2(1) = \left( \frac{1} {n-1} \right) \times \sum_{t=2}^n (r_t - \mu_1)^2</span>
<span class="sd">            $$</span>

<span class="sd">            where:</span>

<span class="sd">            - $\mu_1$ is the mean of the returns over $1$ period, which is defined as:</span>

<span class="sd">                $\mu_1 = \left( \frac{1} {n-1} \right) \times \sum_{t=2}^n r_t$</span>

<span class="sd">        1. Compute the variance ratio for each value of $k$, which is defined as:</span>

<span class="sd">            $$</span>
<span class="sd">            VR(k) = \frac {\sigma^2(k)} {k\sigma^2(1)}</span>
<span class="sd">            $$</span>

<span class="sd">        1. Determine the critical values of the variance ratio from the null distribution table of the VR test, which depend on the sample size, the level of significance, and the lag length $k$.</span>

<span class="sd">        1. Finally, compare the variance ratio to the critical value. If the variance ratio is greater than the critical value, then the null hypothesis of a random walk with drift is rejected, and the time series is considered stationary. If the variance ratio is less than or equal to the critical value, then the null hypothesis cannot be rejected, and the time series is considered non-stationary.</span>

<span class="sd">        In practice, the VR test is often conducted using software packages such as R, Python, or MATLAB, which automate the calculation of the variance ratio and the determination of the critical value.</span>

<span class="sd">    ??? note &quot;Notes&quot;</span>
<span class="sd">        The null hypothesis of a VR is that the process is a random walk, possibly plus drift. Rejection of the null with a positive test statistic indicates the presence of positive serial correlation in the time series.</span>

<span class="sd">    !!! success &quot;Credit&quot;</span>
<span class="sd">        - All credit goes to the [`arch`](https://arch.readthedocs.io/en/latest/unitroot/generated/arch.unitroot.VarianceRatio.html) library.</span>

<span class="sd">    ??? question &quot;References&quot;</span>
<span class="sd">        - Campbell, John Y., Lo, Andrew W. and MacKinlay, A. Craig. (1997) The Econometrics of Financial Markets. Princeton, NJ: Princeton University Press.</span>

<span class="sd">    ??? tip &quot;See Also&quot;</span>
<span class="sd">        - [`statsmodels.tsa.stattools.adfuller`](https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.adfuller.html): Augmented Dickey-Fuller unit root test.</span>
<span class="sd">        - [`statsmodels.tsa.stattools.kpss`](https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.kpss.html): Kwiatkowski-Phillips-Schmidt-Shin stationarity test.</span>
<span class="sd">        - [`statsmodels.tsa.stattools.range_unit_root_test`](https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.range_unit_root_test.html): Range Unit-Root test.</span>
<span class="sd">        - [`statsmodels.tsa.stattools.zivot_andrews`](https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.zivot_andrews.html): Zivot-Andrews structural break test.</span>
<span class="sd">        - [`pmdarima.arima.PPTest`](https://alkaline-ml.com/pmdarima/modules/generated/pmdarima.arima.PPTest.html): Phillips-Perron unit root test.</span>
<span class="sd">        - [`arch.unitroot.DFGLS`](https://arch.readthedocs.io/en/latest/unitroot/generated/arch.unitroot.DFGLS.html): Elliot, Rothenberg and Stock&#39;s GLS-detrended Dickey-Fuller.</span>
<span class="sd">        - [`arch.unitroot.VarianceRatio`](https://arch.readthedocs.io/en/latest/unitroot/generated/arch.unitroot.VarianceRatio.html): Variance Ratio test of a random walk.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.stationarity.adf`][ts_stat_tests.algorithms.stationarity.adf]: Augmented Dickey-Fuller unit root test.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.stationarity.kpss`][ts_stat_tests.algorithms.stationarity.kpss]: Kwiatkowski-Phillips-Schmidt-Shin stationarity test.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.stationarity.rur`][ts_stat_tests.algorithms.stationarity.rur]: Range Unit-Root test of stationarity.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.stationarity.za`][ts_stat_tests.algorithms.stationarity.za]: Zivot-Andrews structural break unit root test.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.stationarity.pp`][ts_stat_tests.algorithms.stationarity.pp]: Phillips-Perron unit root test.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.stationarity.ers`][ts_stat_tests.algorithms.stationarity.ers]: Elliot, Rothenberg and Stock&#39;s GLS-detrended Dickey-Fuller test.</span>
<span class="sd">        - [`ts_stat_tests.algorithms.stationarity.vr`][ts_stat_tests.algorithms.stationarity.vr]: Variance Ratio test of a random walk.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">_vr</span><span class="p">(</span>
        <span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">y</span><span class="p">),</span>
        <span class="n">lags</span><span class="o">=</span><span class="n">lags</span><span class="p">,</span>
        <span class="n">trend</span><span class="o">=</span><span class="n">trend</span><span class="p">,</span>
        <span class="n">debiased</span><span class="o">=</span><span class="n">debiased</span><span class="p">,</span>
        <span class="n">robust</span><span class="o">=</span><span class="n">robust</span><span class="p">,</span>
        <span class="n">overlap</span><span class="o">=</span><span class="n">overlap</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">stat</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">pvalue</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">vr</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "navigation.indexes", "navigation.top", "navigation.instant", "search.highlight", "search.suggest", "toc.follow", "content.action.edit", "content.action.view", "content.code.select", "content.code.copy", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "latest", "provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="../../assets/js/mathjax.js"></script>
      
    
  </body>
</html>